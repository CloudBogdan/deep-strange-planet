{"version":3,"sources":["ts/managers/assets.ts","ts/config.ts","ts/engine/utils/noise.ts","ts/engine/utils/math.ts","ts/engine/Asset.ts","ts/engine/Physics.ts","ts/engine/components/Point.ts","ts/engine/components/Sprite.ts","ts/engine/components/Container.ts","ts/engine/events/Gamepad.ts","ts/engine/Renderer.ts","ts/engine/Generator.ts","ts/messages.ts","ts/engine/components/Sound.ts","ts/engine/Game.ts","ts/engine/utils/Timer.ts","ts/engine/components/Text.ts","ts/engine/components/Group.ts","ts/engine/index.ts","ts/engine/components/Particles.ts","ts/objects/entities/Entity.ts","ts/engine/components/UI.ts","ts/objects/item/ItemParent.ts","ts/objects/item/Item.ts","ts/objects/item/RobotItem.ts","ts/objects/entities/Robot.ts","ts/objects/entities/Player.ts","ts/managers/level.ts","ts/names.ts","ts/objects/gear/Gear.ts","ts/objects/gear/Documentation.ts","ts/objects/gear/OxygenGenerator.ts","ts/objects/food/Food.ts","ts/objects/food/HealingFetus.ts","ts/objects/item/Battery.ts","ts/objects/item/Box.ts","ts/objects/item/Card.ts","ts/objects/item/Drill.ts","ts/objects/raws/Raw.ts","ts/objects/raws/RawAntin.ts","ts/objects/raws/RawCidium.ts","ts/objects/raws/RawGradeCidium.ts","ts/objects/raws/DangerRaw.ts","ts/objects/raws/RawManty.ts","ts/objects/raws/RawNerius.ts","ts/objects/raws/RawOsmy.ts","ts/objects/raws/RawRady.ts","ts/objects/ready/Ready.ts","ts/objects/ready/ReadyCidium.ts","ts/objects.ts","ts/objects/gear/recipes.ts","ts/objects/gear/Recycler.ts","ts/objects/gear/Storage.ts","ts/managers/dome.ts","ts/objects/Block.ts","ts/objects/ores/Ore.ts","ts/objects/ores/Antin.ts","ts/objects/ores/FallingORe.ts","ts/objects/environment/Stalactite.ts","ts/objects/ores/StalactiteOre.ts","ts/objects/ores/Basalt.ts","ts/objects/ores/BurntBasalt.ts","ts/objects/ores/Cidium.ts","ts/objects/ores/CrackedStone.ts","ts/objects/ores/InfectedOre.ts","ts/objects/ores/DeepStone.ts","ts/objects/ores/Destrony.ts","ts/objects/ores/FetusStone.ts","ts/objects/ores/DangerOre.ts","ts/objects/ores/Manty.ts","ts/objects/ores/MushroomStone.ts","ts/objects/ores/Nerius.ts","ts/objects/ores/Osmy.ts","ts/objects/ores/Rady.ts","ts/objects/ores/Stone.ts","ts/objects/ores/StonyGround.ts","ts/managers/generator.ts","ts/stages/menu.ts","ts/main.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA;;AACA;;AACA;;AAGA;;AAGA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAGA;;AACA;;AACA;;AACA;;AACA;;AAGA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAGA;;AAGA;;AACA;;AACA;;AACA;;AAGA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAGA;;AAGA;;AACA;;AACA;;AACA;;AAGA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAGA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAGA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AAEA;;AACA;;;;AAtHA;AACA;AAC4D;AACA;AACA;AAE5D;AACyD;AAEzD;AACqD;AACc;AACZ;AACQ;AACI;AACR;AACN;AACY;AACM;AACF;AAErE;AACuD;AACJ;AACE;AACF;AACI;AAEvD;AAC8D;AACY;AAChB;AACE;AACF;AACI;AACF;AAE5D;AACoE;AAEpE;AAC0D;AACJ;AACJ;AACE;AAEpD;AACgE;AACJ;AACE;AACL;AACA;AACQ;AACM;AAEvE;AAC+D;AAE/D;AAC8D;AACJ;AACc;AACN;AAElE;AACuE;AACE;AACgB;AACF;AACE;AACgB;AACxB;AACgB;AAEjG;AAC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","file":"main.b89710fd.js","sourceRoot":"..\\src","sourcesContent":["import { Game } from \"../engine\"; // @ts-ignore\r\n// I can't setup declare module :(\r\n// > Player\r\nimport player_stay_img from \"../../images/player/stay.png\"; // @ts-ignore\r\nimport player_walk_img from \"../../images/player/walk.png\"; // @ts-ignore\r\nimport player_dead_img from \"../../images/player/dead.png\"; // @ts-ignore\r\n\r\n// > Entities\r\nimport robot_img from \"../../images/entities/robot.png\"; // @ts-ignore\r\n\r\n// > Stones\r\nimport stone_img from \"../../images/ores/stone.png\"; // @ts-ignore\r\nimport stony_ground_img from \"../../images/ores/stony-ground.png\"; // @ts-ignore\r\nimport basalt_img from \"../../images/ores/basalt.png\"; // @ts-ignore\r\nimport deep_stone_img from \"../../images/ores/deep-stone.png\"; // @ts-ignore\r\nimport burnt_basalt_img from \"../../images/ores/burnt-basalt.png\"; // @ts-ignore\r\nimport destrony_img from \"../../images/ores/destrony.png\"; // @ts-ignore\r\nimport manty_img from \"../../images/ores/manty.png\"; // @ts-ignore\r\nimport fetus_stone_img from \"../../images/ores/fetus-stone.png\"; // @ts-ignore\r\nimport mushroom_stone_img from \"../../images/ores/mushroom-stone.png\"; // @ts-ignore\r\nimport cracked_stone_img from \"../../images/ores/cracked-stone.png\"; // @ts-ignore\r\n\r\n// > Ores\r\nimport cidium_img from \"../../images/ores/cidium.png\"; // @ts-ignore\r\nimport osmy_img from \"../../images/ores/osmy.png\"; // @ts-ignore\r\nimport antin_img from \"../../images/ores/antin.png\"; // @ts-ignore\r\nimport rady_img from \"../../images/ores/rady.png\"; // @ts-ignore\r\nimport nerius_img from \"../../images/ores/nerius.png\"; // @ts-ignore\r\n\r\n// > Raw\r\nimport raw_cidium_img from \"../../images/raw/raw-cidium.png\"; // @ts-ignore\r\nimport raw_grade_cidium_img from \"../../images/raw/raw-grade-cidium.png\"; // @ts-ignore\r\nimport raw_osmy_img from \"../../images/raw/raw-osmy.png\"; // @ts-ignore\r\nimport raw_antin_img from \"../../images/raw/raw-antin.png\"; // @ts-ignore\r\nimport raw_rady_img from \"../../images/raw/raw-rady.png\"; // @ts-ignore\r\nimport raw_nerius_img from \"../../images/raw/raw-nerius.png\"; // @ts-ignore\r\nimport raw_manty_img from \"../../images/raw/raw-manty.png\"; // @ts-ignore\r\n\r\n// > Ready\r\nimport ready_cidium_img from \"../../images/ready/ready-cidium.png\"; // @ts-ignore\r\n\r\n// > Items\r\nimport battery_img from \"../../images/items/battery.png\"; // @ts-ignore\r\nimport drill_img from \"../../images/items/drill.png\"; // @ts-ignore\r\nimport box_img from \"../../images/items/box.png\"; // @ts-ignore\r\nimport card_img from \"../../images/items/card.png\"; // @ts-ignore\r\n\r\n// > Plants\r\nimport fetus_vine_img from \"../../images/flora/fetus-vine.png\"; // @ts-ignore\r\nimport mushroom_img from \"../../images/flora/mushroom.png\"; // @ts-ignore\r\nimport infection_img from \"../../images/flora/infection.png\"; // @ts-ignore\r\nimport datura_img from  \"../../images/flora/datura.png\"; // @ts-ignore\r\nimport plants_img from  \"../../images/flora/plants.png\"; // @ts-ignore\r\nimport stalactite_img from  \"../../images/flora/stalactite.png\"; // @ts-ignore\r\nimport datura_tongue_img from  \"../../images/flora/datura-tongue.png\"; // @ts-ignore\r\n\r\n// > Food\r\nimport food_fetus_img from \"../../images/food/food-fetus.png\"; // @ts-ignore\r\n\r\n// > Environment\r\nimport ground_img from \"../../images/environment/ground.png\"; // @ts-ignore\r\nimport dome_img from \"../../images/environment/dome.png\"; // @ts-ignore\r\nimport under_stone_img from \"../../images/environment/under-stone.png\"; // @ts-ignore\r\nimport disputes_img from \"../../images/environment/disputes.png\"; // @ts-ignore\r\n\r\n// > Gear\r\nimport gear_storage_1_img from \"../../images/gear/gear-storage-1.png\"; // @ts-ignore\r\nimport gear_recycler_1_img from \"../../images/gear/gear-recycler-1.png\"; // @ts-ignore\r\nimport gear_oxygen_generator_1_img from \"../../images/gear/gear-oxygen-generator-1.png\"; // @ts-ignore\r\nimport gear_storage_1_outline_img from \"../../images/gear/gear-storage-1-outline.png\"; // @ts-ignore\r\nimport gear_recycler_1_outline_img from \"../../images/gear/gear-recycler-1-outline.png\"; // @ts-ignore\r\nimport gear_oxygen_generator_1_outline_img from \"../../images/gear/gear-oxygen-generator-1-outline.png\"; // @ts-ignore\r\nimport gear_documentation_img from \"../../images/gear/gear-documentation-1.png\"; // @ts-ignore\r\nimport gear_documentation_outline_img from \"../../images/gear/gear-documentation-1-outline.png\"; // @ts-ignore\r\n\r\n// > UI\r\nimport interact_img from \"../../images/ui/interact.png\"; // @ts-ignore\r\nimport close_img from \"../../images/ui/close.png\"; // @ts-ignore\r\nimport drop_img from \"../../images/ui/drop.png\"; // @ts-ignore\r\nimport craft_img from \"../../images/ui/craft.png\"; // @ts-ignore\r\nimport button_img from \"../../images/ui/button.png\"; // @ts-ignore\r\nimport tools_img from \"../../images/ui/tools.png\"; // @ts-ignore\r\nimport bottle_img from \"../../images/ui/bottle.png\"; // @ts-ignore\r\nimport damage_img from \"../../images/ui/damage.png\"; // @ts-ignore\r\nimport level_up_img from \"../../images/ui/level-up.png\"; // @ts-ignore\r\nimport storage_ui_img from \"../../images/ui/storage-ui.png\"; // @ts-ignore\r\nimport recycler_ui_img from \"../../images/ui/recycler-ui.png\"; // @ts-ignore\r\nimport description_ui_img from \"../../images/ui/description-ui.png\"; // @ts-ignore\r\nimport documentation_ui_img from \"../../images/ui/documentation-ui.png\"; // @ts-ignore\r\nimport oxygen_generator_ui_img from \"../../images/ui/oxygen-generator-ui.png\"; // @ts-ignore\r\nimport health_img from \"../../images/ui/health.png\"; // @ts-ignore\r\nimport basics_img from \"../../images/ui/basics.png\"; // @ts-ignore\r\nimport menu_img from \"../../images/ui/menu.png\"; // @ts-ignore\r\nimport logo_img from \"../../images/ui/logo.png\"; // @ts-ignore\r\nimport item_robot_img from \"../../images/ui/item-robot.png\"; // @ts-ignore\r\nimport storage_level_up_img from \"../../images/ui/storage-level-up.png\"; // @ts-ignore\r\n\r\n// > Audio\r\nimport stone_hit_mp from \"../../audio/stone-hit.mp3\"; // @ts-ignore\r\nimport stone_break1_mp from \"../../audio/stone-break/stone-break-1.mp3\"; // @ts-ignore\r\nimport stone_break2_mp from \"../../audio/stone-break/stone-break-2.mp3\"; // @ts-ignore\r\nimport stone_break3_mp from \"../../audio/stone-break/stone-break-3.mp3\"; // @ts-ignore\r\nimport fall_stone_break_mp from \"../../audio/stone-break/fall-stone-break.mp3\"; // @ts-ignore\r\nimport plant_break_mp from \"../../audio/plants/plant-break.mp3\"; // @ts-ignore\r\nimport plant_hit_mp from \"../../audio/plants/plant-hit.mp3\"; // @ts-ignore\r\nimport wave_mp from \"../../audio/plants/wave.mp3\"; // @ts-ignore\r\nimport bonk_mp from \"../../audio/bonk.mp3\"; // @ts-ignore\r\nimport hit_mp from \"../../audio/hit/hit.mp3\"; // @ts-ignore\r\n\r\nimport step1_mp from \"../../audio/steps/1.mp3\"; // @ts-ignore\r\nimport step2_mp from \"../../audio/steps/2.mp3\"; // @ts-ignore\r\nimport step3_mp from \"../../audio/steps/3.mp3\"; // @ts-ignore\r\n\r\nimport storage_mp from \"../../audio/gear/storage.mp3\"; // @ts-ignore\r\nimport store_mp from \"../../audio/gear/store.mp3\"; // @ts-ignore\r\nimport crafting_mp from \"../../audio/gear/craft.mp3\"; // @ts-ignore\r\nimport error_mp from \"../../audio/gear/error.mp3\"; // @ts-ignore\r\n\r\nimport motor_mp from \"../../audio/robot/motor.mp3\"; // @ts-ignore\r\nimport motor_start_mp from \"../../audio/robot/motor-start.mp3\"; // @ts-ignore\r\n\r\nexport function initAssets(game: Game) {\r\n    \r\n    // > Player\r\n    game.loadAsset(\"player-stay\", [player_stay_img]);\r\n    game.loadAsset(\"player-walk\", [player_walk_img]);\r\n    game.loadAsset(\"player-dead\", [player_dead_img]);\r\n\r\n    // > Entities\r\n    game.loadAsset(\"robot\", [robot_img]);\r\n\r\n    // > Stones\r\n    game.loadAsset(\"stone\", [stone_img]);\r\n    game.loadAsset(\"stony-ground\", [stony_ground_img]);\r\n    game.loadAsset(\"basalt\", [basalt_img]);\r\n    game.loadAsset(\"deep-stone\", [deep_stone_img]);\r\n    game.loadAsset(\"burnt-basalt\", [burnt_basalt_img]);\r\n    game.loadAsset(\"destrony\", [destrony_img]);\r\n    game.loadAsset(\"manty\", [manty_img]);\r\n    game.loadAsset(\"fetus-stone\", [fetus_stone_img]);\r\n    game.loadAsset(\"mushroom-stone\", [mushroom_stone_img]);\r\n    game.loadAsset(\"cracked-stone\", [cracked_stone_img]);\r\n\r\n    // > Ores\r\n    game.loadAsset(\"cidium\", [cidium_img]);\r\n    game.loadAsset(\"osmy\", [osmy_img]);\r\n    game.loadAsset(\"antin\", [antin_img]);\r\n    game.loadAsset(\"rady\", [rady_img]);\r\n    game.loadAsset(\"nerius\", [nerius_img]);\r\n\r\n    // > Raws\r\n    game.loadAsset(\"raw-cidium\", [raw_cidium_img]);\r\n    game.loadAsset(\"raw-grade-cidium\", [raw_grade_cidium_img]);\r\n    game.loadAsset(\"raw-osmy\", [raw_osmy_img]);\r\n    game.loadAsset(\"raw-antin\", [raw_antin_img]);\r\n    game.loadAsset(\"raw-rady\", [raw_rady_img]);\r\n    game.loadAsset(\"raw-nerius\", [raw_nerius_img]);\r\n    game.loadAsset(\"raw-manty\", [raw_manty_img]);\r\n\r\n    // > Ready\r\n    game.loadAsset(\"ready-cidium\", [ready_cidium_img]);\r\n\r\n    // > Items\r\n    game.loadAsset(\"battery\", [battery_img]);\r\n    game.loadAsset(\"drill\", [drill_img]);\r\n    game.loadAsset(\"box\", [box_img]);\r\n    game.loadAsset(\"card\", [card_img]);\r\n\r\n    // > Plants\r\n    game.loadAsset(\"fetus-vine\", [fetus_vine_img]);\r\n    game.loadAsset(\"mushroom\", [mushroom_img]);\r\n    game.loadAsset(\"datura\", [datura_img]);\r\n    game.loadAsset(\"plants\", [plants_img]);\r\n    game.loadAsset(\"datura-tongue\", [datura_tongue_img]);\r\n    game.loadAsset(\"infection\", [infection_img]);\r\n    game.loadAsset(\"stalactite\", [stalactite_img]);\r\n\r\n    // > Food\r\n    game.loadAsset(\"food-fetus\", [food_fetus_img]);\r\n    \r\n    // > Environment\r\n    game.loadAsset(\"ground\", [ground_img])\r\n    game.loadAsset(\"dome\", [dome_img])\r\n    game.loadAsset(\"under-stone\", [under_stone_img]);\r\n    game.loadAsset(\"disputes\", [disputes_img])\r\n\r\n    // > Gear\r\n    game.loadAsset(\"gear-storage-1\", [gear_storage_1_img])\r\n    game.loadAsset(\"gear-recycler-1\", [gear_recycler_1_img])\r\n    game.loadAsset(\"gear-oxygen-generator-1\", [gear_oxygen_generator_1_img])\r\n    game.loadAsset(\"gear-storage-1-outline\", [gear_storage_1_outline_img])\r\n    game.loadAsset(\"gear-recycler-1-outline\", [gear_recycler_1_outline_img])\r\n    game.loadAsset(\"gear-oxygen-generator-1-outline\", [gear_oxygen_generator_1_outline_img])\r\n    game.loadAsset(\"gear-documentation-1\", [gear_documentation_img])\r\n    game.loadAsset(\"gear-documentation-1-outline\", [gear_documentation_outline_img])\r\n\r\n    // > UI\r\n    game.loadAsset(\"interact\", [interact_img])\r\n    game.loadAsset(\"close\", [close_img])\r\n    game.loadAsset(\"drop\", [drop_img])\r\n    game.loadAsset(\"craft\", [craft_img])\r\n    game.loadAsset(\"button\", [button_img])\r\n    game.loadAsset(\"tools\", [tools_img])\r\n    game.loadAsset(\"bottle\", [bottle_img])\r\n    game.loadAsset(\"damage\", [damage_img])\r\n    game.loadAsset(\"storage-ui\", [storage_ui_img])\r\n    game.loadAsset(\"level-up\", [level_up_img])\r\n    game.loadAsset(\"recycler-ui\", [recycler_ui_img])\r\n    game.loadAsset(\"description-ui\", [description_ui_img])\r\n    game.loadAsset(\"documentation-ui\", [documentation_ui_img])\r\n    game.loadAsset(\"oxygen-generator-ui\", [oxygen_generator_ui_img])\r\n    game.loadAsset(\"health\", [health_img])\r\n    game.loadAsset(\"basics\", [basics_img])\r\n    game.loadAsset(\"menu\", [menu_img])\r\n    game.loadAsset(\"logo\", [logo_img])\r\n    game.loadAsset(\"item-robot\", [item_robot_img])\r\n    game.loadAsset(\"storage-level-up\", [storage_level_up_img])\r\n\r\n    // > Audio\r\n    game.loadAsset(\"stone-hit\", stone_hit_mp, \"audio\")\r\n    game.loadAsset(\"stone-break-1\", stone_break1_mp, \"audio\")\r\n    game.loadAsset(\"stone-break-2\", stone_break2_mp, \"audio\")\r\n    game.loadAsset(\"stone-break-3\", stone_break3_mp, \"audio\")\r\n    game.loadAsset(\"fall-stone-break\", fall_stone_break_mp, \"audio\")\r\n    game.loadAsset(\"plant-break\", plant_break_mp, \"audio\")\r\n    game.loadAsset(\"plant-hit\", plant_hit_mp, \"audio\")\r\n    game.loadAsset(\"wave\", wave_mp, \"audio\")\r\n    game.loadAsset(\"bonk\", bonk_mp, \"audio\")\r\n    game.loadAsset(\"hit\", hit_mp, \"audio\")\r\n\r\n    game.loadAsset(\"step-1\", step1_mp, \"audio\")\r\n    game.loadAsset(\"step-2\", step2_mp, \"audio\")\r\n    game.loadAsset(\"step-3\", step3_mp, \"audio\")\r\n    game.loadAsset(\"storage\", storage_mp, \"audio\")\r\n    game.loadAsset(\"error\", error_mp, \"audio\")\r\n    \r\n    game.loadAsset(\"store\", store_mp, \"audio\")\r\n    game.loadAsset(\"crafting\", crafting_mp, \"audio\")\r\n\r\n    game.loadAsset(\"motor\", motor_mp, \"audio\")\r\n    game.loadAsset(\"motor-start\", motor_start_mp, \"audio\")\r\n\r\n}","import { ToolLevel } from \"./objects/entities/Player\";\r\nimport { GearLevel } from \"./objects/gear/Gear\";\r\n\r\nexport const VERSION = \"1.2.0\";\r\nexport enum Config {\r\n    ALLOW_DARK = 1, // ! IS DEV!\r\n    IS_DEV = 1, // ! IS DEV!\r\n    TEST_GEARS = 1, // ! IS DEV!\r\n    ALLOW_HUNK = 1, // ! IS DEV!\r\n    \r\n    // World size and chunks size in blocks\r\n    WORLD_WIDTH = 82,\r\n    WORLD_HEIGHT = 225,\r\n    CHUNK_SIZE = 4,\r\n    \r\n    SPRITE_SCALE = 5,\r\n    SPRITE_PIXEL_SIZE = 16,\r\n    SPRITE_SIZE = SPRITE_PIXEL_SIZE * SPRITE_SCALE,\r\n    PARTICLES_GRAVITY = .4,\r\n    WORLD_X_CENTER = WORLD_WIDTH * SPRITE_SIZE / 2, // In pixels\r\n\r\n    OXYGEN_GENERATOR_BATTERY_DEFUSE_TICK = 400,\r\n    OXYGEN_GENERATOR_OXYGEN_DEFUSE_TICK = 250,\r\n\r\n    VINE_GROW_TICK = IS_DEV ? 100 : 220,\r\n    VINE_GROW_CHANCE = IS_DEV ? 60 : 12,\r\n    VINE_MIN_LENGTH = 4,\r\n    VINE_MAX_LENGTH = 8,\r\n\r\n    MAX_STALACTITE_LENGTH = 4,\r\n    STALACTITE_GROW_TICK = 300,\r\n    STALACTITE_GROW_CHANCE = 10,\r\n\r\n    INFECTION_GROW_TICK = IS_DEV ? 100 : 200,\r\n    INFECTION_GROW_CHANCE = IS_DEV ? 100 : 12,\r\n    \r\n    ROBOT_PICKUP_DISTANCE = SPRITE_SIZE,\r\n    ROBOT_DAMAGE = 4,\r\n    ROBOT_HIT_SPEED = 10,\r\n    ROBOT_ALLOW_PICKUP_DELAY = 20,\r\n\r\n    PICKUP_DISTANCE = 60,\r\n    WIRE_LENGTH = 60,\r\n    GEAR_INTERACT_DISTANCE = 85,\r\n    DOME_DIAMETER = SPRITE_SIZE * 6,\r\n    GROUND_HEIGHT = SPRITE_SIZE * 2,\r\n    OXYGEN_HUNGRY_TIME = IS_DEV ? 4 : 60,\r\n    \r\n    ITEMS_LIVE_TIME = 800,\r\n    ORE_FALL_DELAY = 30,\r\n    DEFAULT_ANIMATION_SPEED = 8,\r\n    RESPAWN_TIME = IS_DEV ? 4 : 12\r\n}\r\nexport enum GeneratorConfig {\r\n    LAYERS_BLEND_HEIGHT = 10,\r\n    BASALT_LAYER_HEIGHT = 150,\r\n    BURNT_BASALT_LAYER_HEIGHT = Config.WORLD_HEIGHT - 5,\r\n}\r\nexport enum Color {\r\n    STONE_LAYER_COLOR = \"#090d23\",\r\n    BASALT_LAYER_COLOR = \"#1b1d27\",\r\n    BURNT_BASALT_LAYER_COLOR = \"#040508\",\r\n\r\n    WHITE = \"#fff\",\r\n    BLACK = \"#0f1531\",\r\n    GREY = \"#2c2f3d\",\r\n    DARK_GREY = \"#13151e\",\r\n    YELLOW = \"#fbc67e\",\r\n    ORANGE = \"#ff935c\",\r\n    BLUE = \"#b9c5ff\",\r\n    RED = \"#fb7e88\",\r\n    GREEN = \"#6aff81\",\r\n    YELLOW_LIGHT = \"#fde3bf\",\r\n    BLUE_LIGHT = \"#e0e6ff\",\r\n    RED_LIGHT = \"#f9cace\",\r\n    GREEN_LIGHT = \"#d4ffdb\",\r\n}\r\nexport const OreSettings: { [key: string]: { hp: number, tool?: ToolLevel } } = {\r\n    \"stone\": { hp: 10 },\r\n    \"stony-ground\": { hp: 8 },\r\n    \"antin\": { hp: 52, tool: 3 },\r\n    \"basalt\": { hp: 40, tool: 3 },\r\n    \"burnt-basalt\": { hp: 80, tool: 4 },\r\n    \"manty\": { hp: 108, tool: 4 },\r\n    \"cidium\": { hp: 20 },\r\n    \"cracked-stone\": { hp: 6 },\r\n    \"deep-stone\": { hp: 26, tool: 2 },\r\n    \"osmy\": { hp: 36, tool: 2 },\r\n    \"nerius\": { hp: 32, tool: 2 },\r\n    \"rady\": { hp: 58, tool: 4 },\r\n    \"root-stone\": { hp: 14 },\r\n    \"mushroom-stone\": { hp: 32, tool: 3 },\r\n    \"stalactite\": { hp: 26, tool: 2 },\r\n}\r\nexport const ItemSettings: { [key: string]: { lineColor: Color, storage: GearLevel } } = {\r\n    \"raw-cidium\": {\r\n        lineColor: Color.YELLOW_LIGHT,\r\n        storage: 1\r\n    },\r\n    \"raw-grade-cidium\": {\r\n        lineColor: Color.YELLOW_LIGHT,\r\n        storage: 1\r\n    },\r\n    \"raw-osmy\": {\r\n        lineColor: Color.BLUE_LIGHT,\r\n        storage: 1\r\n    },\r\n    \"raw-antin\": {\r\n        lineColor: Color.RED_LIGHT,\r\n        storage: 3\r\n    },\r\n    \"raw-rady\": {\r\n        lineColor: Color.GREEN_LIGHT,\r\n        storage: 3\r\n    },\r\n    \"raw-nerius\": {\r\n        lineColor: Color.WHITE,\r\n        storage: 2\r\n    },\r\n    \"raw-manty\": {\r\n        lineColor: Color.RED_LIGHT,\r\n        storage: 3\r\n    },\r\n}","/*\r\n * >> Adaptive to typescript by Bogdanov :D\r\n * >> https://github.com/CloudBogdan\r\n *\r\n * A speed-improved perlin and simplex noise algorithms for 2D.\r\n *\r\n * Based on example code by Stefan Gustavson (stegu@itn.liu.se).\r\n * Optimisations by Peter Eastman (peastman@drizzle.stanford.edu).\r\n * Better rank ordering method by Stefan Gustavson in 2012.\r\n * Converted to Javascript by Joseph Gentle.\r\n *\r\n * Version 2012-03-09\r\n *\r\n * This code was placed in the public domain by its original author,\r\n * Stefan Gustavson. You may use it as you see fit, but\r\n * attribution is appreciated.\r\n *\r\n */\r\nclass Grad {\r\n    x: number\r\n    y: number\r\n    z: number\r\n    \r\n    constructor(x: number, y: number, z: number) {\r\n        this.x = x; this.y = y; this.z = z;\r\n    }\r\n\r\n    dot2(x: number, y: number) {\r\n        return this.x * x + this.y * y;\r\n    }\r\n    dot3(x: number, y: number, z: number) {\r\n        return this.x * x + this.y * y + this.z * z;\r\n    }\r\n}\r\n// function Grad(x: number, y: number, z: number) {\r\n//     this.x = x; this.y = y; this.z = z;\r\n// }\r\n\r\n// Grad.prototype.dot2 = function (x: number, y: number) {\r\n//     return this.x * x + this.y * y;\r\n// };\r\n\r\n// Grad.prototype.dot3 = function (x: number, y: number, z: number) {\r\n//     return this.x * x + this.y * y + this.z * z;\r\n// };\r\n\r\nvar grad3 = [new Grad(1, 1, 0), new Grad(-1, 1, 0), new Grad(1, -1, 0), new Grad(-1, -1, 0),\r\nnew Grad(1, 0, 1), new Grad(-1, 0, 1), new Grad(1, 0, -1), new Grad(-1, 0, -1),\r\nnew Grad(0, 1, 1), new Grad(0, -1, 1), new Grad(0, 1, -1), new Grad(0, -1, -1)];\r\n\r\nvar p = [151, 160, 137, 91, 90, 15,\r\n    131, 13, 201, 95, 96, 53, 194, 233, 7, 225, 140, 36, 103, 30, 69, 142, 8, 99, 37, 240, 21, 10, 23,\r\n    190, 6, 148, 247, 120, 234, 75, 0, 26, 197, 62, 94, 252, 219, 203, 117, 35, 11, 32, 57, 177, 33,\r\n    88, 237, 149, 56, 87, 174, 20, 125, 136, 171, 168, 68, 175, 74, 165, 71, 134, 139, 48, 27, 166,\r\n    77, 146, 158, 231, 83, 111, 229, 122, 60, 211, 133, 230, 220, 105, 92, 41, 55, 46, 245, 40, 244,\r\n    102, 143, 54, 65, 25, 63, 161, 1, 216, 80, 73, 209, 76, 132, 187, 208, 89, 18, 169, 200, 196,\r\n    135, 130, 116, 188, 159, 86, 164, 100, 109, 198, 173, 186, 3, 64, 52, 217, 226, 250, 124, 123,\r\n    5, 202, 38, 147, 118, 126, 255, 82, 85, 212, 207, 206, 59, 227, 47, 16, 58, 17, 182, 189, 28, 42,\r\n    223, 183, 170, 213, 119, 248, 152, 2, 44, 154, 163, 70, 221, 153, 101, 155, 167, 43, 172, 9,\r\n    129, 22, 39, 253, 19, 98, 108, 110, 79, 113, 224, 232, 178, 185, 112, 104, 218, 246, 97, 228,\r\n    251, 34, 242, 193, 238, 210, 144, 12, 191, 179, 162, 241, 81, 51, 145, 235, 249, 14, 239, 107,\r\n    49, 192, 214, 31, 181, 199, 106, 157, 184, 84, 204, 176, 115, 121, 50, 45, 127, 4, 150, 254,\r\n    138, 236, 205, 93, 222, 114, 67, 29, 24, 72, 243, 141, 128, 195, 78, 66, 215, 61, 156, 180];\r\n// To remove the need for index wrapping, double the permutation table length\r\nvar perm = new Array(512);\r\nvar gradP = new Array(512);\r\n\r\n// This isn't a very good seeding function, but it works ok. It supports 2^16\r\n// different seed values. Write something better if you need more seeds.\r\nexport function seed(seed: number) {\r\n    if (seed > 0 && seed < 1) {\r\n        // Scale the seed out\r\n        seed *= 65536;\r\n    }\r\n\r\n    seed = Math.floor(seed);\r\n    if (seed < 256) {\r\n        seed |= seed << 8;\r\n    }\r\n\r\n    for (var i = 0; i < 256; i++) {\r\n        var v: number;\r\n        if (i & 1) {\r\n            v = p[i] ^ (seed & 255);\r\n        } else {\r\n            v = p[i] ^ ((seed >> 8) & 255);\r\n        }\r\n\r\n        perm[i] = perm[i + 256] = v;\r\n        gradP[i] = gradP[i + 256] = grad3[v % 12];\r\n    }\r\n};\r\n\r\nseed(0);\r\n\r\n/*\r\nfor(var i=0; i<256; i++) {\r\n  perm[i] = perm[i + 256] = p[i];\r\n  gradP[i] = gradP[i + 256] = grad3[perm[i] % 12];\r\n}*/\r\n\r\n// Skewing and unskewing factors for 2, 3, and 4 dimensions\r\nvar F2 = 0.5 * (Math.sqrt(3) - 1);\r\nvar G2 = (3 - Math.sqrt(3)) / 6;\r\n\r\nvar F3 = 1 / 3;\r\nvar G3 = 1 / 6;\r\n\r\n// 2D simplex noise\r\nexport function simplex2(xin: number, yin: number) {\r\n    var n0: number, n1: number, n2: number; // Noise contributions from the three corners\r\n    // Skew the input space to determine which simplex cell we're in\r\n    var s = (xin + yin) * F2; // Hairy factor for 2D\r\n    var i = Math.floor(xin + s);\r\n    var j = Math.floor(yin + s);\r\n    var t = (i + j) * G2;\r\n    var x0 = xin - i + t; // The x,y distances from the cell origin, unskewed.\r\n    var y0 = yin - j + t;\r\n    // For the 2D case, the simplex shape is an equilateral triangle.\r\n    // Determine which simplex we are in.\r\n    var i1: number, j1: number; // Offsets for second (middle) corner of simplex in (i,j) coords\r\n    if (x0 > y0) { // lower triangle, XY order: (0,0)->(1,0)->(1,1)\r\n        i1 = 1; j1 = 0;\r\n    } else {    // upper triangle, YX order: (0,0)->(0,1)->(1,1)\r\n        i1 = 0; j1 = 1;\r\n    }\r\n    // A step of (1,0) in (i,j) means a step of (1-c,-c) in (x,y), and\r\n    // a step of (0,1) in (i,j) means a step of (-c,1-c) in (x,y), where\r\n    // c = (3-sqrt(3))/6\r\n    var x1 = x0 - i1 + G2; // Offsets for middle corner in (x,y) unskewed coords\r\n    var y1 = y0 - j1 + G2;\r\n    var x2 = x0 - 1 + 2 * G2; // Offsets for last corner in (x,y) unskewed coords\r\n    var y2 = y0 - 1 + 2 * G2;\r\n    // Work out the hashed gradient indices of the three simplex corners\r\n    i &= 255;\r\n    j &= 255;\r\n    var gi0 = gradP[i + perm[j]];\r\n    var gi1 = gradP[i + i1 + perm[j + j1]];\r\n    var gi2 = gradP[i + 1 + perm[j + 1]];\r\n    // Calculate the contribution from the three corners\r\n    var t0 = 0.5 - x0 * x0 - y0 * y0;\r\n    if (t0 < 0) {\r\n        n0 = 0;\r\n    } else {\r\n        t0 *= t0;\r\n        n0 = t0 * t0 * gi0.dot2(x0, y0);  // (x,y) of grad3 used for 2D gradient\r\n    }\r\n    var t1 = 0.5 - x1 * x1 - y1 * y1;\r\n    if (t1 < 0) {\r\n        n1 = 0;\r\n    } else {\r\n        t1 *= t1;\r\n        n1 = t1 * t1 * gi1.dot2(x1, y1);\r\n    }\r\n    var t2 = 0.5 - x2 * x2 - y2 * y2;\r\n    if (t2 < 0) {\r\n        n2 = 0;\r\n    } else {\r\n        t2 *= t2;\r\n        n2 = t2 * t2 * gi2.dot2(x2, y2);\r\n    }\r\n    // Add contributions from each corner to get the final noise value.\r\n    // The result is scaled to return values in the interval [-1,1].\r\n    return 70 * (n0 + n1 + n2);\r\n};\r\n\r\n// 3D simplex noise\r\nexport function simplex3(xin: number, yin: number, zin: number) {\r\n    var n0: number, n1: number, n2: number, n3: number; // Noise contributions from the four corners\r\n\r\n    // Skew the input space to determine which simplex cell we're in\r\n    var s = (xin + yin + zin) * F3; // Hairy factor for 2D\r\n    var i = Math.floor(xin + s);\r\n    var j = Math.floor(yin + s);\r\n    var k = Math.floor(zin + s);\r\n\r\n    var t = (i + j + k) * G3;\r\n    var x0 = xin - i + t; // The x,y distances from the cell origin, unskewed.\r\n    var y0 = yin - j + t;\r\n    var z0 = zin - k + t;\r\n\r\n    // For the 3D case, the simplex shape is a slightly irregular tetrahedron.\r\n    // Determine which simplex we are in.\r\n    var i1: number, j1: number, k1: number; // Offsets for second corner of simplex in (i,j,k) coords\r\n    var i2: number, j2: number, k2: number; // Offsets for third corner of simplex in (i,j,k) coords\r\n    if (x0 >= y0) {\r\n        if (y0 >= z0) { i1 = 1; j1 = 0; k1 = 0; i2 = 1; j2 = 1; k2 = 0; }\r\n        else if (x0 >= z0) { i1 = 1; j1 = 0; k1 = 0; i2 = 1; j2 = 0; k2 = 1; }\r\n        else { i1 = 0; j1 = 0; k1 = 1; i2 = 1; j2 = 0; k2 = 1; }\r\n    } else {\r\n        if (y0 < z0) { i1 = 0; j1 = 0; k1 = 1; i2 = 0; j2 = 1; k2 = 1; }\r\n        else if (x0 < z0) { i1 = 0; j1 = 1; k1 = 0; i2 = 0; j2 = 1; k2 = 1; }\r\n        else { i1 = 0; j1 = 1; k1 = 0; i2 = 1; j2 = 1; k2 = 0; }\r\n    }\r\n    // A step of (1,0,0) in (i,j,k) means a step of (1-c,-c,-c) in (x,y,z),\r\n    // a step of (0,1,0) in (i,j,k) means a step of (-c,1-c,-c) in (x,y,z), and\r\n    // a step of (0,0,1) in (i,j,k) means a step of (-c,-c,1-c) in (x,y,z), where\r\n    // c = 1/6.\r\n    var x1 = x0 - i1 + G3; // Offsets for second corner\r\n    var y1 = y0 - j1 + G3;\r\n    var z1 = z0 - k1 + G3;\r\n\r\n    var x2 = x0 - i2 + 2 * G3; // Offsets for third corner\r\n    var y2 = y0 - j2 + 2 * G3;\r\n    var z2 = z0 - k2 + 2 * G3;\r\n\r\n    var x3 = x0 - 1 + 3 * G3; // Offsets for fourth corner\r\n    var y3 = y0 - 1 + 3 * G3;\r\n    var z3 = z0 - 1 + 3 * G3;\r\n\r\n    // Work out the hashed gradient indices of the four simplex corners\r\n    i &= 255;\r\n    j &= 255;\r\n    k &= 255;\r\n    var gi0 = gradP[i + perm[j + perm[k]]];\r\n    var gi1 = gradP[i + i1 + perm[j + j1 + perm[k + k1]]];\r\n    var gi2 = gradP[i + i2 + perm[j + j2 + perm[k + k2]]];\r\n    var gi3 = gradP[i + 1 + perm[j + 1 + perm[k + 1]]];\r\n\r\n    // Calculate the contribution from the four corners\r\n    var t0 = 0.6 - x0 * x0 - y0 * y0 - z0 * z0;\r\n    if (t0 < 0) {\r\n        n0 = 0;\r\n    } else {\r\n        t0 *= t0;\r\n        n0 = t0 * t0 * gi0.dot3(x0, y0, z0);  // (x,y) of grad3 used for 2D gradient\r\n    }\r\n    var t1 = 0.6 - x1 * x1 - y1 * y1 - z1 * z1;\r\n    if (t1 < 0) {\r\n        n1 = 0;\r\n    } else {\r\n        t1 *= t1;\r\n        n1 = t1 * t1 * gi1.dot3(x1, y1, z1);\r\n    }\r\n    var t2 = 0.6 - x2 * x2 - y2 * y2 - z2 * z2;\r\n    if (t2 < 0) {\r\n        n2 = 0;\r\n    } else {\r\n        t2 *= t2;\r\n        n2 = t2 * t2 * gi2.dot3(x2, y2, z2);\r\n    }\r\n    var t3 = 0.6 - x3 * x3 - y3 * y3 - z3 * z3;\r\n    if (t3 < 0) {\r\n        n3 = 0;\r\n    } else {\r\n        t3 *= t3;\r\n        n3 = t3 * t3 * gi3.dot3(x3, y3, z3);\r\n    }\r\n    // Add contributions from each corner to get the final noise value.\r\n    // The result is scaled to return values in the interval [-1,1].\r\n    return 32 * (n0 + n1 + n2 + n3);\r\n\r\n};\r\n\r\n// ##### Perlin noise stuff\r\n\r\nfunction fade(t: number) {\r\n    return t * t * t * (t * (t * 6 - 15) + 10);\r\n}\r\n\r\nfunction lerp(a: number, b: number, t: number) {\r\n    return (1 - t) * a + t * b;\r\n}\r\n\r\n// 2D Perlin Noise\r\nexport function perlin2(x: number, y: number) {\r\n    // Find unit grid cell containing point\r\n    var X = Math.floor(x), Y = Math.floor(y);\r\n    // Get relative xy coordinates of point within that cell\r\n    x = x - X; y = y - Y;\r\n    // Wrap the integer cells at 255 (smaller integer period can be introduced here)\r\n    X = X & 255; Y = Y & 255;\r\n\r\n    // Calculate noise contributions from each of the four corners\r\n    var n00 = gradP[X + perm[Y]].dot2(x, y);\r\n    var n01 = gradP[X + perm[Y + 1]].dot2(x, y - 1);\r\n    var n10 = gradP[X + 1 + perm[Y]].dot2(x - 1, y);\r\n    var n11 = gradP[X + 1 + perm[Y + 1]].dot2(x - 1, y - 1);\r\n\r\n    // Compute the fade curve value for x\r\n    var u = fade(x);\r\n\r\n    // Interpolate the four results\r\n    return lerp(\r\n        lerp(n00, n10, u),\r\n        lerp(n01, n11, u),\r\n        fade(y));\r\n};\r\n\r\n// 3D Perlin Noise\r\nexport function perlin3(x: number, y: number, z: number) {\r\n    // Find unit grid cell containing point\r\n    var X = Math.floor(x), Y = Math.floor(y), Z = Math.floor(z);\r\n    // Get relative xyz coordinates of point within that cell\r\n    x = x - X; y = y - Y; z = z - Z;\r\n    // Wrap the integer cells at 255 (smaller integer period can be introduced here)\r\n    X = X & 255; Y = Y & 255; Z = Z & 255;\r\n\r\n    // Calculate noise contributions from each of the eight corners\r\n    var n000 = gradP[X + perm[Y + perm[Z]]].dot3(x, y, z);\r\n    var n001 = gradP[X + perm[Y + perm[Z + 1]]].dot3(x, y, z - 1);\r\n    var n010 = gradP[X + perm[Y + 1 + perm[Z]]].dot3(x, y - 1, z);\r\n    var n011 = gradP[X + perm[Y + 1 + perm[Z + 1]]].dot3(x, y - 1, z - 1);\r\n    var n100 = gradP[X + 1 + perm[Y + perm[Z]]].dot3(x - 1, y, z);\r\n    var n101 = gradP[X + 1 + perm[Y + perm[Z + 1]]].dot3(x - 1, y, z - 1);\r\n    var n110 = gradP[X + 1 + perm[Y + 1 + perm[Z]]].dot3(x - 1, y - 1, z);\r\n    var n111 = gradP[X + 1 + perm[Y + 1 + perm[Z + 1]]].dot3(x - 1, y - 1, z - 1);\r\n\r\n    // Compute the fade curve value for x, y, z\r\n    var u = fade(x);\r\n    var v = fade(y);\r\n    var w = fade(z);\r\n\r\n    // Interpolate\r\n    return lerp(\r\n        lerp(\r\n            lerp(n000, n100, u),\r\n            lerp(n001, n101, u), w),\r\n        lerp(\r\n            lerp(n010, n110, u),\r\n            lerp(n011, n111, u), w),\r\n        v);\r\n};","import { Config } from \"../../config\";\r\nimport { Storage } from \"../../objects/gear/Storage\";\r\nimport { Axes, Direction } from \"../../types\";\r\nimport { Asset, AssetType } from \"../Asset\";\r\nimport { simplex2 } from \"./noise\";\r\n\r\nexport class Vector2 {\r\n    x: number\r\n    y: number\r\n    \r\n    constructor(x?: number, y?: number) {\r\n        this.x = x || 0;\r\n        this.y = y || 0;\r\n    }\r\n\r\n    set(x?: number, y?: number): Vector2 {\r\n        this.x = x || 0;\r\n        this.y = y || 0;\r\n        \r\n        return this;\r\n    }\r\n    copy(vec: Vector2): Vector2 {\r\n        this.x = vec.x;\r\n        this.y = vec.y;\r\n        return this;\r\n    }\r\n    normalize(): Vector2 {\r\n        const v = new Vector2(this.x, this.y);\r\n\r\n        const a = Math.sqrt(v.x ** 2 + v.y ** 2);\r\n        v.x /= a || 1;\r\n        v.y /= a || 1;\r\n\r\n        return v;\r\n    }\r\n    distance(vec: Vector2): number {\r\n        return Math.sqrt((this.x - vec.x) ** 2 + (this.y - vec.y) ** 2);\r\n    }\r\n    expand(): Vector2 {\r\n        return new Vector2(this.x, this.y);\r\n    }\r\n\r\n    apply(func: (v: number)=> number) {\r\n        return new Vector2(func(this.x), func(this.y));\r\n    }\r\n\r\n    add(vec: Vector2): Vector2 {\r\n        return new Vector2(this.x + vec.x, this.y + vec.y);\r\n    }\r\n    sub(vec: Vector2): Vector2 {\r\n        return new Vector2(this.x - vec.x, this.y - vec.y);\r\n    }\r\n    mul(value: number): Vector2 {\r\n        return new Vector2(this.x * value, this.y * value);\r\n    }\r\n    div(value: number): Vector2 {\r\n        return new Vector2(this.x / value, this.y / value);\r\n    }\r\n\r\n    lerp(to: Vector2, time: number): Vector2 {\r\n        this.x = this.x + (to.x - this.x) * time;\r\n        this.y = this.y + (to.y - this.y) * time;\r\n        \r\n        return this;\r\n    }\r\n    angle(): number {\r\n\r\n        if (this.x > 0 && this.y > 0) return Math.PI / 2 - Math.atan(this.x / this.y);\r\n        if (this.x < 0 && this.y > 0) return Math.PI / 2 - Math.atan(this.x / this.y);\r\n        if (this.x < 0 && this.y < 0) return Math.PI + Math.atan(this.y / this.x);\r\n        if (this.x > 0 && this.y < 0) return Math.PI * 3 / 2 + Math.abs(Math.atan(this.x / this.y));\r\n\r\n        return 0;\r\n\r\n    }\r\n\r\n    static add(vec1: Vector2, vec2: Vector2): Vector2 {\r\n        return new Vector2(vec1.x + vec2.x, vec1.y + vec2.y);\r\n    }\r\n    static sub(vec1: Vector2, vec2: Vector2): Vector2 {\r\n        return new Vector2(vec1.x - vec2.x, vec1.y - vec2.y);\r\n    }\r\n    \r\n    static zero(): Vector2 {\r\n        return new Vector2();\r\n    }\r\n    static all(value?: number): Vector2 {\r\n        return new Vector2(value || 1, value || 1);\r\n    }\r\n    static compare(vec1: Vector2, vec2: Vector2): boolean {\r\n        return vec1.x == vec2.x && vec1.y == vec2.y;\r\n    }\r\n}\r\n\r\nexport function assetIsValid(asset: Asset | undefined | null, type: AssetType): boolean {\r\n    return asset != null && asset.type != null && asset.type == type;\r\n}\r\nexport function safeValue<T>(value: T | undefined | null, safe: T): T {\r\n    return (value === undefined || value === null) ? safe : value;\r\n}\r\nexport function safeSlot(slot: Storage[\"contains\"][\"slots\"][0] | undefined): Storage[\"contains\"][\"slots\"][0] {\r\n    return safeValue(slot, { count: 0 });\r\n}\r\nexport function asImage(asset: Asset | undefined | null): HTMLImageElement | undefined {\r\n    if (!asset) return;\r\n\r\n    if (assetIsValid(asset as any, \"image\"))\r\n        return ((asset as Asset).element as HTMLImageElement[])[0];\r\n}\r\nexport function asAudio(asset: Asset | undefined | null): HTMLAudioElement | undefined {\r\n    if (!asset) return;\r\n\r\n    if (assetIsValid(asset as any, \"audio\"))\r\n        return (asset as Asset).element as HTMLAudioElement;\r\n}\r\n\r\nexport function standardName(name: string): string {\r\n    return name.trim().split(\" \").join(\"-\").toLocaleLowerCase();\r\n}\r\nexport function compareNames(name1: string, name2: string): boolean {\r\n    return standardName(name1) == standardName(name2);\r\n}\r\nexport function buildName(...args: string[]) {\r\n    return [...args].join(\" \");\r\n}\r\nexport function wrapText(text: string, maxLength: number): { text: string, wrapCount: number } {\r\n    let result: string = \"\";\r\n    let wrapCount = 0;\r\n\r\n    for (let i = 0; i < text.length; i ++) {\r\n\r\n        let letter = text[i];\r\n        \r\n        if ((i-1) > 0 && (i-1) % maxLength == 0) {\r\n            if (text[i] != \" \")\r\n                result += `-\\n`;\r\n            else\r\n                result += `\\n`;\r\n\r\n            wrapCount ++;\r\n            letter = text[i].trim();\r\n        }\r\n        result += letter;\r\n        \r\n    }\r\n        \r\n    return {\r\n        text: result,\r\n        wrapCount\r\n    };\r\n}\r\nexport function inChunkIdToPosition(inChunkId: string): Vector2 {\r\n    const size = Config.SPRITE_SIZE;\r\n    const inChunkPos = inChunkId.split(\"-\").map(p=> +p);\r\n\r\n    return new Vector2(\r\n        (inChunkPos[0] + inChunkPos[2] * Config.CHUNK_SIZE) * size,\r\n        (inChunkPos[1] + inChunkPos[3] * Config.CHUNK_SIZE) * size,\r\n    );\r\n}\r\n\r\nexport function lerp(from: number, to: number, time: number): number {\r\n    return from + (to - from) * time;\r\n}\r\nexport function random(from: number, to: number): number {\r\n    return Math.random() * (to - from) + from;\r\n}\r\nexport function randomInt(from: number, to: number): number {\r\n    return Math.floor(Math.random() * ((to + 1) - from) + from);\r\n}\r\nexport function randomNoise(depends: number, from: number, to: number): number {\r\n    return ((simplex2(depends/4, depends/4) + 1) / 2) * (to - from) + from;\r\n}\r\nexport function chance(percent: number): boolean {\r\n    return randomInt(0, 100) <= percent;\r\n}\r\nexport function clamp(value: number, min: number, max: number) {\r\n    if (value < min)\r\n        return min;\r\n    else if (value > max)\r\n        return max;\r\n    else\r\n        return value;\r\n}\r\nexport function inRange(value: number, from: number, to: number): boolean {\r\n    return value >= from && value <= to;\r\n}","import { standardName } from \"./utils/math\";\r\n\r\nexport type AssetType = \"image\" | \"audio\"; \r\n\r\nexport class Asset {\r\n    name: string\r\n    src: string | string[]\r\n    type: AssetType\r\n    element: HTMLAudioElement | HTMLImageElement[]\r\n    // element: PIXI.Texture | HTMLAudioElement | PIXI.Texture[]\r\n    \r\n    constructor(name: string, src: string | string[], type?: AssetType) {\r\n        this.name = standardName(name);\r\n        this.src = src;\r\n        this.type = type || \"image\";\r\n        this.element = [];\r\n\r\n        if (this.type == \"image\") {\r\n            this.element = (this.src as string[]).map(s=> {\r\n                const i = new Image();\r\n                i.src = s;\r\n                return i;\r\n            });\r\n        }\r\n        else if (type == \"audio\") {\r\n            this.element = new Audio(this.src as string);\r\n        }\r\n    }\r\n}","import { Config } from \"../config\";\r\nimport { Point } from \"./components/Point\";\r\nimport { Game } from \"./Game\";\r\nimport { Vector2 } from \"./utils/math\";\r\n\r\nexport type Collide = {\r\n    id: Point[\"id\"] | null\r\n    right: boolean\r\n    left: boolean\r\n    top: boolean\r\n    bottom: boolean\r\n    any: boolean\r\n}\r\nexport type CollideRect = {\r\n    id: string\r\n    width: number\r\n    height: number\r\n    position: Vector2\r\n}\r\nexport type ColliderType = \"solid\" | \"dynamic\" | \"none\";\r\nexport class Collider {\r\n    type: ColliderType\r\n    \r\n    width: number\r\n    height: number\r\n    offset: Vector2\r\n\r\n    collidable: boolean\r\n    collidesWith: Collide | null\r\n    parent: Point\r\n\r\n    constructor(parent: Point) {\r\n        this.type = \"dynamic\";\r\n\r\n        this.width = Config.SPRITE_PIXEL_SIZE * Config.SPRITE_SCALE;\r\n        this.height = Config.SPRITE_PIXEL_SIZE * Config.SPRITE_SCALE;\r\n        this.offset = new Vector2();\r\n\r\n        this.collidable = true;\r\n        this.collidesWith = null;\r\n        this.parent = parent;\r\n\r\n    }\r\n}\r\n\r\nexport class Physics {\r\n    game: Game\r\n    \r\n    constructor(game: Game) {\r\n        this.game = game;\r\n    }\r\n\r\n    /**\r\n     * **Do not forgot for \".any\" !**\r\n     */\r\n    collideWithRect(rect1: CollideRect, rect2: CollideRect): Collide {\r\n\r\n        const\r\n            pos1 = rect1.position,\r\n            pos2 = rect2.position;\r\n        const\r\n            w1 = rect1.width / 2,\r\n            w2 = rect2.width / 2;\r\n        const\r\n            h1 = rect1.height / 2,\r\n            h2 = rect2.height / 2;\r\n        const valid = rect1.id != rect2.id;\r\n        const horizontal = (\r\n            ((pos1.x + w1) > (pos2.x - w2)) && // Right\r\n            ((pos1.x - w1) < (pos2.x + w2)) // Left\r\n        ) && valid;\r\n        const vertical = (\r\n            ((pos1.y + h1) > (pos2.y - h2)) && // Bottom\r\n            ((pos1.y - h2) < (pos2.y + h2)) // Top\r\n        ) && valid;\r\n\r\n        const locationX = Math.abs(pos1.x - pos2.x);\r\n        const locationY = Math.abs(pos1.y - pos2.y);\r\n\r\n        // Right\r\n        const right = (\r\n            ((pos1.x + w1) > (pos2.x - w2)) && pos2.x > pos1.x\r\n        ) && vertical && (locationX > locationY);\r\n        // Left\r\n        const left = (\r\n            ((pos1.x - w1) < (pos2.x + w2)) && pos1.x > pos2.x\r\n        ) && vertical && (locationX > locationY);\r\n        \r\n        // Top\r\n        const top = (\r\n            ((pos1.y - h1) < (pos2.y + h2)) && pos1.y > pos2.y\r\n        ) && horizontal && (locationY > locationX);\r\n        // Bottom\r\n        const bottom = (\r\n            ((pos1.y + h1) > (pos2.y - h2)) && pos2.y > pos1.y\r\n        ) && horizontal && (locationY > locationX);\r\n\r\n        const any = right || left || top || bottom;\r\n        \r\n        return {\r\n            id: rect2?.id || null, any,\r\n            right, left,\r\n            top, bottom\r\n        };\r\n\r\n    }\r\n    /**\r\n     * **Do not forgot for \".any\" !**\r\n     */\r\n    collide(point1: Point, point2: Point): Collide {\r\n        \r\n        const\r\n            pos1 = Vector2.add(point1.position, point1.collider.offset).add(point1.velocity),\r\n            pos2 = Vector2.add(point2.position, point2.collider.offset).add(point2.velocity);\r\n        const\r\n            w1 = point1.collider.width,\r\n            w2 = point2.collider.width;\r\n        const\r\n            h1 = point1.collider.height,\r\n            h2 = point2.collider.height;\r\n\r\n        return this.collideWithRect({\r\n            id: point1.id,\r\n            position: pos1,\r\n            width: w1,\r\n            height: h1\r\n        }, {\r\n            id: point2.id,\r\n            position: pos2,\r\n            width: w2,\r\n            height: h2\r\n        });\r\n    }\r\n    \r\n    update() {\r\n        const children = this.game.children.filter(child=> (child.collider.type != \"none\" && child.collider.collidable));\r\n        \r\n        children.filter(child=> child.collider.type == \"solid\").map(solidChild=> {\r\n            children.filter(child=> child.collider.type == \"dynamic\").map(dynamicChild=> {\r\n                this.collideWith(dynamicChild, solidChild);\r\n            });\r\n        })\r\n    }\r\n\r\n    collideWith(dynamicCollider: Point, solidCollider: Point) {\r\n        if (!dynamicCollider.collider.collidable || !solidCollider.collider.collidable) return;\r\n\r\n        const collide = this.collide(dynamicCollider, solidCollider);\r\n        \r\n        const col1 = dynamicCollider.collider;\r\n        const col2 = solidCollider.collider;\r\n        \r\n        // Right\r\n        if (collide.right && dynamicCollider.velocity.x > 0) {\r\n            dynamicCollider.position.x =\r\n                solidCollider.position.x - col2.width / 2 - col1.width / 2 + 1 + col2.offset.x - col1.offset.x;\r\n            dynamicCollider.velocity.x = 0;\r\n        }\r\n        // Left\r\n        if (collide.left && dynamicCollider.velocity.x < 0) {\r\n            dynamicCollider.position.x =\r\n                solidCollider.position.x + col2.width / 2 + col1.width / 2 - 1 + col2.offset.x - col1.offset.x;\r\n            dynamicCollider.velocity.x = 0;\r\n        }\r\n\r\n        // Top\r\n        if (collide.top && dynamicCollider.velocity.y < 0) {\r\n            dynamicCollider.position.y =\r\n                solidCollider.position.y + col2.height / 2 + col1.height / 2 - 1 + col2.offset.y - col1.offset.y;\r\n            dynamicCollider.velocity.y = 0;\r\n        } \r\n        // Bottom\r\n        if (collide.bottom && dynamicCollider.velocity.y > 0) {\r\n            dynamicCollider.position.y =\r\n                solidCollider.position.y - col2.height / 2 - col1.height / 2 + 1 + col2.offset.y - col1.offset.y;\r\n            dynamicCollider.velocity.y = 0;\r\n        }\r\n\r\n        if (collide.any) {\r\n            dynamicCollider.collider.collidesWith = {...collide};\r\n        }\r\n    }\r\n}","import { ComponentType } from \"../../types\";\r\nimport { Game } from \"../Game\";\r\nimport { Collider, ColliderType } from \"../Physics\";\r\nimport { Renderer } from \"../Renderer\";\r\nimport { safeValue, standardName as standardName, Vector2 } from \"../utils/math\";\r\n\r\nlet __id = 0;\r\n\r\nexport type IPointProps = {\r\n    position?: Vector2\r\n    rotation?: number\r\n    scale?: Vector2\r\n    layer?: string\r\n    visible?: boolean\r\n\r\n    colliderType?: ColliderType\r\n\r\n    group?: string | null\r\n}\r\n\r\nexport class Point {\r\n    game!: Game\r\n    id: string\r\n    type: ComponentType\r\n    name: string\r\n    group: string\r\n    inited: boolean\r\n    layer: string\r\n    \r\n    velocity: Vector2\r\n    acceleration: Vector2\r\n    position: Vector2\r\n    rotation: number\r\n    scale: Vector2\r\n    visible: boolean\r\n\r\n    collider: Collider\r\n    \r\n    constructor(name: string, props?: IPointProps) {\r\n        this.id = `${ name }-${ __id ++ }`;\r\n        this.type = \"point\";\r\n        this.name = standardName(name);\r\n        this.group = props?.group ? standardName(props.group) : \"\";\r\n        this.inited = false;\r\n        this.layer = props?.layer || \"game\";\r\n\r\n        this.position = props?.position || Vector2.zero();\r\n        this.velocity = Vector2.zero();\r\n        this.acceleration = Vector2.all();\r\n        this.rotation = props?.rotation || 0;\r\n        this.scale = props?.scale || Vector2.all();\r\n        this.visible = safeValue(props?.visible, true);\r\n\r\n        this.collider = new Collider(this);\r\n        this.collider.type = props?.colliderType || \"dynamic\";\r\n    }\r\n    \r\n    init() {\r\n        this.inited = true;\r\n    }\r\n    update() {\r\n        this.velocity.x *= this.acceleration.x;\r\n        this.velocity.y *= this.acceleration.y;\r\n        this.position.x += this.velocity.x;\r\n        this.position.y += this.velocity.y;\r\n    }\r\n    render() {\r\n    }\r\n    destroy() {\r\n    }\r\n}","import { IPointProps, Point } from \"./Point\";\r\nimport { asImage, assetIsValid, clamp, safeValue, Vector2 } from \"../utils/math\";\r\nimport messages from \"../../messages\";\r\nimport { Config } from \"../../config\";\r\n\r\nexport type ISpriteProps = {\r\n    width?: number\r\n    height?: number\r\n\r\n    flip?: { x: boolean, y: boolean }\r\n    repeat?: Vector2\r\n    frame?: Vector2\r\n} & IPointProps;\r\n\r\nexport class Sprite extends Point {\r\n    width: number\r\n    height: number\r\n\r\n    offset: Vector2\r\n    flip: { x: boolean, y: boolean }\r\n    repeat: Vector2\r\n    frame: Vector2\r\n\r\n    assetName: string\r\n    texture: HTMLImageElement | null | undefined;\r\n    opacity: number\r\n    \r\n    constructor(name: string, assetName: string, props?: ISpriteProps) {\r\n        super(name, props);\r\n        this.type = \"sprite\";\r\n\r\n        this.width = props?.width || 1;\r\n        this.height = props?.height || 1;\r\n\r\n        this.offset = Vector2.zero();\r\n        this.flip = props?.flip || { x: false, y: false };\r\n        this.repeat = props?.repeat || Vector2.all();\r\n        this.opacity = 1;\r\n        this.frame = props?.frame || Vector2.zero();\r\n\r\n        this.assetName = assetName;\r\n        this.texture = null;\r\n    }\r\n    \r\n    init() {\r\n        super.init();\r\n        \r\n        this.updateAsset();\r\n    }\r\n    \r\n    updateAsset() {\r\n        this.texture = asImage(this.game.getAssetByName(this.assetName));\r\n    }\r\n    update() {\r\n        super.update();\r\n    }\r\n    render() {\r\n        super.render();\r\n\r\n        if (!this.texture || !this.visible) return;\r\n\r\n        this.game.renderer.drawSprite({\r\n            ...this,\r\n            texture: this.texture\r\n        });\r\n    }\r\n\r\n    blink() {\r\n        if (this.game.tick(5))\r\n            this.visible = !this.visible;\r\n    }\r\n\r\n    playAnimation(assetName: string, framesCount: number, speed?: number, loop?: boolean, reversed?: boolean) {\r\n        this.texture = asImage(this.game.getAssetByName(assetName));\r\n        \r\n        if (framesCount <= 1) {\r\n            this.frame.x = 0;\r\n            return;\r\n        }\r\n\r\n        if (this.game.tick(speed || Config.DEFAULT_ANIMATION_SPEED)) {\r\n            // const allow = safeValue(loop, true);\r\n            this.frame.x += reversed ? -1 : 1;\r\n            if (this.frame.x < 0)\r\n                this.frame.x = framesCount;\r\n            if (this.frame.x >= framesCount && safeValue(loop, true))\r\n                this.frame.x = 0;\r\n\r\n            this.frame.x = clamp(this.frame.x, 0, framesCount);\r\n        }\r\n    }\r\n}","import { Sprite, ISpriteProps } from \"./Sprite\";\r\nimport { Game } from \"../Game\";\r\nimport { Point, IPointProps } from \"./Point\";\r\nimport { compareNames } from \"../utils/math\";\r\nimport { Group } from \"./Group\";\r\n\r\nexport class Container {\r\n    children: Point[]\r\n\r\n    constructor() {\r\n        this.children = [];\r\n    }\r\n\r\n    createPoint(name: Point[\"name\"], props?: IPointProps): Point {\r\n        return this.add(new Point(name, props));\r\n    }\r\n    createSprite(name: Sprite[\"name\"], assetName: Sprite[\"assetName\"], props?: ISpriteProps): Sprite {\r\n        return this.add(new Sprite(name, assetName, props)) as Sprite;\r\n    }\r\n\r\n    getChildrenByName<T>(name: Point[\"name\"]): T[] {\r\n        return (this.children.filter(child=> child.name.indexOf(name.toLowerCase()) >= 0) as any[]) as T[];\r\n    }\r\n    getChildrenByGroupName<T>(groupName: Point[\"group\"]): T[] {\r\n        return (this.children.filter(child=> child.group.indexOf(groupName.toLowerCase()) >= 0) as any[]) as T[];\r\n    }\r\n    getChildById<T>(id: Point[\"id\"] | null): T | undefined {\r\n        if (id)\r\n            return this.children.find(child=> child.id.indexOf(id.toLowerCase()) >= 0) as T | undefined;\r\n    }\r\n    removeChildById(id: Point[\"id\"]) {\r\n        this.children = this.children.filter(child=> {\r\n            if (!compareNames(child.id, id))\r\n                return true;\r\n            else {\r\n                child.destroy();\r\n                return false;\r\n            }\r\n        });\r\n    }\r\n    removeChildrenByGroupName(group: string) {\r\n        this.children.map(child=> {\r\n            if (compareNames(child.group, group)) {\r\n                this.removeChildById(child.id);\r\n            }\r\n        });\r\n    }\r\n    \r\n    add<T>(child: Point | Group): T {\r\n        this.children.push(child as any);\r\n        return child as any;\r\n    }\r\n\r\n    initChildren(game: Game) {\r\n        this.children.filter(child=> !child.inited).map(child=> {\r\n            child.game = game;\r\n            child.init()\r\n        });\r\n    }\r\n    callChildren(method: string) {\r\n        this.children.map(child=> (child as any)[method]());\r\n    }\r\n}","import { Config } from \"../../config\"\r\n\r\nexport class Gamepad {\r\n    eventKeys: {\r\n        [name: string]: string[]\r\n    }\r\n    \r\n    keys: {\r\n        right: boolean\r\n        left: boolean\r\n        up: boolean\r\n        down: boolean\r\n        enter: boolean\r\n    }\r\n\r\n    pressed: boolean\r\n\r\n    onKeyDownListeners: ({ id: string, name: string, callback: ()=> void})[]\r\n    onAnyKeyDownListeners: ({ id: string, callback: (name: string)=> void })[]\r\n    \r\n    constructor() {\r\n        this.eventKeys = {\r\n            \"right\": [\"ArrowRight\", \"KeyD\"],\r\n            \"left\": [\"ArrowLeft\", \"KeyA\"],\r\n            \"up\": [\"ArrowUp\", \"KeyW\"],\r\n            \"down\": [\"ArrowDown\", \"KeyS\"],\r\n            \"enter\": [\"Enter\"],\r\n        };\r\n\r\n        this.keys = {\r\n            right: false,\r\n            left: false,\r\n            up: false,\r\n            down: false,\r\n            enter: false,\r\n        }\r\n\r\n        this.pressed = false;\r\n    \r\n        this.onKeyDownListeners = [];\r\n        this.onAnyKeyDownListeners = [];\r\n        \r\n        window.addEventListener(\"keydown\", e=> {\r\n            if (!Config.IS_DEV)\r\n                e.preventDefault();\r\n            this.updateKey(e.code, true)\r\n\r\n            if (this.pressed) return;\r\n            this.onKeyDownListeners.map(listener=> {\r\n                this.eventKeys[listener.name].map(key=> {\r\n                    \r\n                    if (e.code.toLowerCase() == key.toLowerCase() || e.key.toLowerCase() == key.toLowerCase()) {\r\n                        listener.callback();\r\n                        this.pressed = true;\r\n                    }\r\n                    \r\n                });\r\n            });\r\n            this.onAnyKeyDownListeners.map(listener=> {\r\n                Object.keys(this.eventKeys).map(ekey=> {\r\n                \r\n                    this.eventKeys[ekey].map(key=> {\r\n    \r\n                        if (e.code.toLowerCase() == key.toLowerCase() || e.key.toLowerCase() == key.toLowerCase()) {\r\n                            listener.callback(ekey);\r\n                            this.pressed = true;\r\n                        }\r\n    \r\n                    })\r\n                    \r\n                });\r\n            });\r\n            \r\n        });\r\n        window.addEventListener(\"keyup\", e=> {\r\n            if (!Config.IS_DEV)\r\n                e.preventDefault();\r\n            this.updateKey(e.code, false);\r\n            this.pressed = false;\r\n        });\r\n    }\r\n\r\n    onKeyDown(id: string, name: string, callback: ()=> void) {\r\n\r\n        this.onKeyDownListeners.push({\r\n            id, name, callback\r\n        });\r\n        \r\n    }\r\n    onAnyKeyDown(id: string, callback: (name: string)=> void) {\r\n        \r\n        this.onAnyKeyDownListeners.push({\r\n            id, callback\r\n        });\r\n\r\n    }\r\n\r\n    removeListenerById(id: string) {\r\n        this.onKeyDownListeners = this.onKeyDownListeners.filter(l=> l.id != id);\r\n        this.onAnyKeyDownListeners = this.onAnyKeyDownListeners.filter(l=> l.id != id);\r\n    }\r\n\r\n    updateKey(code: string, enabled: boolean) {\r\n        this.mapKeys((ekey, key)=> {\r\n            if (code == key)\r\n                this.keys[ekey as keyof typeof this.keys] = enabled;\r\n        });\r\n    }\r\n    mapKeys(func: (ekey: string, key: string)=> void) {\r\n        Object.keys(this.eventKeys).map(ekey=> {\r\n            this.eventKeys[ekey].map(key=> func(ekey, key))\r\n        })\r\n    }\r\n}","import { ISpriteProps } from \".\";\r\nimport { Color, Config, GeneratorConfig } from \"../config\";\r\nimport { Particle } from \"./components/Particles\";\r\nimport { Game } from \"./Game\";\r\nimport { safeValue, Vector2 } from \"./utils/math\";\r\n\r\ntype RendererLayer = {\r\n    render: boolean\r\n    canvas: HTMLCanvasElement\r\n    context: CanvasRenderingContext2D\r\n    update: boolean\r\n    cameraFactor: number\r\n}\r\nexport type StrokeSettings = { width: number, color: string }\r\nexport type DrawRectProps = {\r\n    color?: string\r\n    width?: number\r\n    height?: number\r\n    position?: Vector2\r\n    rotation?: number\r\n    opacity?: number\r\n    stroke?: StrokeSettings\r\n    layer?: string\r\n};\r\nexport type DrawLineProps = {\r\n    color?: string\r\n    width: number\r\n    points: [Vector2, Vector2]\r\n    opacity?: number\r\n    layer?: string\r\n};\r\nexport type DrawTextProps = {\r\n    text?: string\r\n    color?: string\r\n    font?: string\r\n    align?: CanvasTextAlign\r\n    position?: Vector2\r\n    rotation?: number\r\n    scale?: Vector2\r\n    opacity?: number\r\n    layer?: string\r\n    stroke?: StrokeSettings\r\n    lineHeight?: number\r\n};\r\nexport type DrawSpriteProps = {\r\n    texture?: HTMLImageElement | undefined,\r\n    width?: number, height?: number,\r\n    position?: Vector2, rotation?: number, offset?: Vector2, origin?: Vector2\r\n    layer?: string,\r\n    scale?: Vector2, flip?: { x: boolean, y: boolean },\r\n    opacity?: number, repeat?: Vector2,\r\n    frame?: Vector2, framed?: boolean\r\n};\r\n\r\nexport class Renderer {\r\n    game: Game\r\n    particles: Particle[]\r\n    layers:{ [name: string]: RendererLayer }\r\n    \r\n    constructor(game: Game) {\r\n        this.game = game;\r\n\r\n        this.particles = [];\r\n\r\n        this.layers = {\r\n            \"bg\": this.createLayer(\"bg\"),\r\n            \"game\": this.createLayer(\"game\"),\r\n            \"player\": this.createLayer(\"player\"),\r\n            \"plants\": this.createLayer(\"plants\"),\r\n            \"game-ui\": this.createLayer(\"game-ui\"),\r\n            \"particles\": this.createLayer(\"particles\"),\r\n            \"ui\": this.createLayer(\"ui\", true, 0),\r\n            \"upper-ui\": this.createLayer(\"upper-ui\", true, 0),\r\n            \"debug\": this.createLayer(\"debug\", false),\r\n        };\r\n        \r\n        document.body.style.background = Color.STONE_LAYER_COLOR;\r\n    }\r\n    \r\n    // Create new layer\r\n    createLayer(name: string, update?: boolean, cameraFactor?: number): RendererLayer {\r\n        const canvas = document.createElement(\"canvas\");\r\n\r\n        canvas.setAttribute(\"id\", name);\r\n        canvas.width = window.innerWidth;\r\n        canvas.height = window.innerHeight;\r\n        document.body.appendChild(canvas);\r\n\r\n        const context = canvas.getContext(\"2d\")!;\r\n        context.imageSmoothingEnabled = false;\r\n\r\n        return {\r\n            render: true,\r\n            canvas,\r\n            context,\r\n            update: safeValue(update, true),\r\n            cameraFactor: safeValue(cameraFactor, 1)\r\n        };\r\n    }\r\n\r\n    render() {\r\n        // > Clear layers\r\n        Object.keys(this.layers).map(key=> {\r\n            if (this.layers[key].update)\r\n                this.layers[key].context.clearRect(0, 0, window.innerWidth, window.innerHeight)\r\n        });\r\n\r\n        this.changeBGColor();\r\n    }\r\n    // > Change bg color\r\n    changeBGColor() {\r\n        const spriteSize = Config.SPRITE_SIZE;\r\n        const layerBlendHeight = GeneratorConfig.LAYERS_BLEND_HEIGHT;\r\n        \r\n        // Basalt layer color\r\n        if (this.game.camera.position.y > (GeneratorConfig.BASALT_LAYER_HEIGHT - layerBlendHeight) * spriteSize)\r\n            document.body.style.background = Color.BASALT_LAYER_COLOR;\r\n        // Burnt basalt layer color\r\n        if (this.game.camera.position.y > (GeneratorConfig.BURNT_BASALT_LAYER_HEIGHT - layerBlendHeight) * spriteSize)\r\n            document.body.style.background = Color.BURNT_BASALT_LAYER_COLOR;\r\n        // Stone layer color\r\n        else if (this.game.camera.position.y < (GeneratorConfig.BASALT_LAYER_HEIGHT - layerBlendHeight) * spriteSize)\r\n            document.body.style.background = Color.STONE_LAYER_COLOR;\r\n    }\r\n    // > Render particles\r\n    renderParticles() {\r\n        this.particles.map(part=> {\r\n            \r\n            part.update(this.game);\r\n\r\n            part.render(this, part);\r\n        });\r\n        this.particles.map((part, index)=> {\r\n\r\n            if (part.size <= 0 || part.opacity <= 0) \r\n                this.particles.splice(index, 1);\r\n        });\r\n    }\r\n    inCameraViewport(pos: Vector2, width?: number, height?: number): boolean {\r\n        const cam = this.game.camera.position;\r\n        const \r\n            w = innerWidth + 150,\r\n            h = innerHeight + 150;\r\n        width = safeValue(width, Config.SPRITE_SIZE);\r\n        height = safeValue(height, Config.SPRITE_SIZE);\r\n        return (\r\n            pos.x + width / 2 > cam.x - w / 2 &&\r\n            pos.y + height / 2 > cam.y - h / 2 &&\r\n            pos.x - width / 2 < cam.x + w / 2 &&\r\n            pos.y - height / 2 < cam.y + h / 2\r\n        );\r\n    }\r\n    getCameraPosition(layer?: string): Vector2 {\r\n        const factor = this.layers[layer || \"game\"];\r\n        \r\n        return this.game.camera.position.add(this.game.camera.offset).mul(factor.cameraFactor);\r\n    }\r\n\r\n    // Get layer context\r\n    getContext(layer?: string): Renderer[\"layers\"][0][\"context\"] {\r\n        return this.layers[layer || \"game\"].context;\r\n    }\r\n    startTransform(layer?: string, pos?: Vector2, rotation?: number, scale?: Vector2, opacity?: number,origin?: Vector2) {\r\n        const l = this.layers[layer || \"game\"];\r\n\r\n        const p = pos || Vector2.zero();\r\n        const o = origin || Vector2.zero();\r\n        \r\n        l.context.save();\r\n\r\n        l.context.translate(innerWidth / 2 * l.cameraFactor, innerHeight / 2 * l.cameraFactor)\r\n        l.context.rotate(this.game.camera.rotation * l.cameraFactor);\r\n\r\n        l.context.transform(\r\n            scale?.x || 1, 0, 0, scale?.y || 1,\r\n            p.x - this.getCameraPosition(layer).x + o.x,\r\n            p.y - this.getCameraPosition(layer).y + o.y\r\n        );\r\n        l.context.rotate(rotation || 0);\r\n\r\n        const op = safeValue(opacity, 1);\r\n        l.context.globalAlpha = op > 0 ? op : 0;\r\n    }\r\n    endTransform(layer?: string) {\r\n        this.layers[layer || \"game\"].context.restore();\r\n    }\r\n    \r\n    // Draw primitives\r\n    drawRect(props: DrawRectProps) {\r\n        if (!this.layers[props.layer || \"game\"].render) return;\r\n        \r\n        const w = Math.floor(safeValue(props.width, 1) * Config.SPRITE_SIZE);\r\n        const h = Math.floor(safeValue(props.height, 1) * Config.SPRITE_SIZE);\r\n\r\n        if (!this.inCameraViewport(safeValue(props.position, Vector2.zero()), w, h) && this.layers[props.layer || \"game\"].cameraFactor == 1) return;\r\n\r\n        this.startTransform(props.layer, props.position, props.rotation, Vector2.all(), props.opacity);\r\n\r\n        const context = this.getContext(props.layer);\r\n\r\n        context.fillStyle = props.color || \"#fff\";\r\n        context.fillRect(-w / 2, -h / 2, w, h);\r\n        if (props.stroke) {\r\n            context.lineWidth = props.stroke.width;\r\n            context.strokeStyle = props.stroke.color;\r\n            context.strokeRect(-w / 2, -h / 2, w, h);\r\n        }\r\n\r\n        this.endTransform(props.layer);\r\n    }\r\n    drawLine(props: DrawLineProps) { \r\n        if (!this.layers[props.layer || \"game\"].render) return;\r\n        \r\n        const context = this.getContext(props.layer);\r\n        context.save();\r\n\r\n        context.globalAlpha = safeValue(props.opacity, 1);\r\n        \r\n        context.lineWidth = props.width;\r\n        context.strokeStyle = props.color || \"#fff\";\r\n\r\n        const w = window.innerWidth / 2;\r\n        const h = window.innerHeight / 2;\r\n        \r\n        context.moveTo(props.points[0].x - this.getCameraPosition(props.layer).x + w, props.points[0].y - this.getCameraPosition(props.layer).y + h);\r\n        context.lineTo(props.points[1].x - this.getCameraPosition(props.layer).x + w, props.points[1].y - this.getCameraPosition(props.layer).y + h);\r\n        \r\n        context.stroke();\r\n        context.beginPath();\r\n        context.restore();\r\n    }\r\n    drawText(props: DrawTextProps) { \r\n        if (!this.layers[props.layer || \"game\"].render) return;\r\n        \r\n        const context = this.getContext(props.layer);\r\n        \r\n        this.startTransform(props.layer, props.position, props.rotation, props.scale, props.opacity);\r\n\r\n        const stroke = safeValue(props.stroke, { width: 8, color: Color.STONE_LAYER_COLOR });\r\n\r\n        function renderText(text: string, pos: Vector2) {\r\n            context.strokeText(text, pos.x, pos.y);\r\n            context.fillText(text, pos.x, pos.y);\r\n        }\r\n        \r\n        context.strokeStyle = stroke.color;\r\n        context.lineWidth = stroke.width;\r\n        context.miterLimit = stroke.width;\r\n        context.lineJoin = \"round\";\r\n        \r\n        context.fillStyle = props.color || \"#fff\";\r\n        context.font = props.font || \"18px Pixel\";\r\n        context.textAlign = props.align || \"center\";\r\n        context.textBaseline = \"middle\"\r\n\r\n        if ((props as any).centered != undefined) {\r\n            console.warn(\"Text centered!\");\r\n        }\r\n\r\n        const text = props.text || \"\";\r\n        if (text.indexOf(\"\\n\") >= 0) {\r\n            for (let i = 0; i < text.split(\"\\n\").length; i ++)\r\n                renderText(text.split(\"\\n\")[i], new Vector2(0, i * safeValue(props.lineHeight, parseInt(context.font.split(\" \")[0]))));\r\n        } else\r\n            renderText(text, Vector2.zero());\r\n\r\n        // context.s();\r\n        \r\n        this.endTransform(props.layer);\r\n    }\r\n    \r\n    drawSprite(props: DrawSpriteProps) {\r\n        if (!this.layers[props.layer || \"game\"].render) return;\r\n        \r\n        try {\r\n            if (!props.texture) return;\r\n\r\n            const size = Config.SPRITE_SIZE;\r\n\r\n            const w = safeValue(props.width, 1) * size;\r\n            const h = safeValue(props.height, 1) * size;\r\n            const frameW = safeValue(props.width, 1) * Config.SPRITE_PIXEL_SIZE;\r\n            const frameH = safeValue(props.height, 1) * Config.SPRITE_PIXEL_SIZE;\r\n            const framePos = props.frame || Vector2.zero();\r\n            \r\n            const p = props.position || Vector2.zero();\r\n            const o = props.offset || Vector2.zero();\r\n            const or = props.origin || Vector2.zero();\r\n            \r\n            if ((!this.inCameraViewport(p, w*safeValue(props.repeat?.x, 1), h*safeValue(props.repeat?.y, 1))) && this.layers[props.layer || \"game\"].cameraFactor == 1) return;\r\n            \r\n            const f = safeValue(props.flip, { x: false, y: false });\r\n            const s = props.scale || Vector2.all();\r\n            const context = this.getContext(props.layer);\r\n            \r\n            this.startTransform(\r\n                props.layer,\r\n                p.add(o),\r\n                props.rotation,\r\n                new Vector2(s.x * (f.x ? -1 : 1), s.y * (f.y ? -1 : 1)),\r\n                props.opacity,\r\n                or\r\n            );\r\n            \r\n            // Draw sprite without repeat\r\n            if (!props.repeat || Vector2.compare(props.repeat || Vector2.all(), Vector2.all())) {\r\n\r\n                if (safeValue(props.framed, true))\r\n                    context.drawImage(\r\n                        props.texture,\r\n                        // Clip rect\r\n                        framePos.x * frameW, framePos.y * frameH,\r\n                        frameW, frameH,\r\n                        \r\n                        // Transform\r\n                        -w / 2 - or.x, -h / 2 - or.y,\r\n                        w, h\r\n                    );\r\n                else\r\n                    context.drawImage(\r\n                        props.texture,\r\n                        // Transform\r\n                        -w / 2 - or.x, -h / 2 - or.y,\r\n                        w, h\r\n                    );\r\n                \r\n            }\r\n            else if (props.repeat)\r\n                // And... With repeat?\r\n                for (let repeatY = 0; repeatY < props.repeat.y; repeatY ++)\r\n                    for (let repeatX = 0; repeatX < props.repeat.x; repeatX ++)\r\n                        context.drawImage(\r\n                            props.texture,\r\n                            -w / 2 + repeatX * w,\r\n                            -h / 2 + repeatY * h,\r\n                            w, h\r\n                        );\r\n\r\n            this.endTransform(props.layer);\r\n        } catch(err) {}\r\n    }\r\n\r\n    updateAspect() {\r\n        Object.keys(this.layers).map(key=> {\r\n\r\n            this.layers[key].canvas.width = window.innerWidth;\r\n            this.layers[key].canvas.height = window.innerHeight;\r\n            this.layers[key].context.imageSmoothingEnabled = false;\r\n\r\n        })\r\n    }\r\n}","import { Game } from \"./Game\"\r\nimport { Ore } from \"../objects/ores/Ore\"\r\nimport { clamp, inChunkIdToPosition, inRange, Vector2 } from \"./utils/math\"\r\nimport { Point } from \"./components/Point\";\r\nimport { Color, Config } from \"../config\";\r\nimport { perlin2, seed } from \"./utils/noise\";\r\nimport { Block } from \"../objects/Block\";\r\n\r\nlet __chunkId = 0;\r\n\r\nexport type Chunk = {\r\n    group: string\r\n    pos: Vector2\r\n}\r\ntype GeneratorSettings = {\r\n    value?: [number, number]\r\n    height: [number, number]\r\n    block: typeof Block | any | null\r\n    divider?: number\r\n    rules?: (x: number, y: number)=> boolean\r\n    // rules?: (noiseX: number, noiseY: number, getValue: (x: number, y: number, div?: number)=> number)=> boolean\r\n}\r\nexport function noise(x: number, y: number, sharpness?: number, sharpnessDiv?: number): number {\r\n    const sharp = sharpness ? noise(x * sharpness, y * sharpness) : 0;\r\n    return clamp((perlin2(x, y) + 1) / 2 + sharp / (sharpnessDiv || 2), 0, 1);\r\n}\r\nexport class Generator {\r\n    game: Game\r\n\r\n    seed: number\r\n    \r\n    chunks: Chunk[]\r\n    destroyedOres: string[]\r\n    modifiedOres: {\r\n        [inChunkId: string]: { [dataKey: string]: any }\r\n    }\r\n    settings: GeneratorSettings[]\r\n    range: Vector2[]\r\n\r\n    onWorldChangeListeners: { id: string, pos: Vector2 | null, callback: ()=> void, listenChunks?: boolean }[]\r\n    \r\n    constructor(game: Game) {\r\n        this.game = game;\r\n\r\n        this.seed = 0;\r\n        this.changeSeed();\r\n\r\n        this.onWorldChangeListeners = [];\r\n\r\n        this.chunks = [];\r\n        this.destroyedOres = game.loadKey(\"destroyedOres\", []);\r\n        this.modifiedOres = game.loadKey(\"modifiedOres\", {});\r\n        this.settings = [];\r\n        this.range = [\r\n            new Vector2(1, 0), new Vector2(-1, 0),\r\n            new Vector2(0, 1), new Vector2(0, -1),\r\n            new Vector2(1, 1), new Vector2(-1, -1),\r\n            new Vector2(-1, 1), new Vector2(1, -1),\r\n            new Vector2(1, -1), new Vector2(-1, 1),\r\n            new Vector2(0, 0)\r\n        ];\r\n        \r\n    }\r\n\r\n    generateChunksAt(position: Vector2) {\r\n        const mul = 1;\r\n        const pos = this.game.camera.position.div(Config.SPRITE_SIZE * (Config.CHUNK_SIZE * mul)).apply(Math.floor);\r\n        const checkPos = pos.add(new Vector2(.5, .5)).mul(Config.SPRITE_SIZE * Config.CHUNK_SIZE * mul);\r\n        \r\n        // Create chunks\r\n        if (checkPos.distance(this.game.camera.position) > 100) {\r\n\r\n            this.range.map(p=> {\r\n\r\n                if (!this.chunks.find(c=> Vector2.compare(c.pos, pos.mul(mul).add(p)))) {\r\n                    const chunk = this.createChunk(pos.mul(mul).add(p));\r\n                    if (chunk)\r\n                        this.chunks.push(chunk);\r\n                }\r\n                \r\n            });\r\n\r\n            this.onWorldChangeListeners.filter(listener=> listener.listenChunks).map(listener=> {\r\n                listener.callback();\r\n            });\r\n            \r\n        }\r\n\r\n        // Remove chunks\r\n        this.chunks.map((chunk, index)=> {\r\n\r\n            if (this.game.camera.position.distance(chunk.pos.mul(Config.SPRITE_SIZE * Config.CHUNK_SIZE)) > 700) {\r\n                this.game.removeChildrenByGroupName(chunk.group);\r\n                this.chunks.splice(index, 1);\r\n            }\r\n        \r\n        });\r\n        \r\n    }\r\n    \r\n    createChunk(pos: Vector2): Chunk | undefined {\r\n\r\n        // if (pos.x < 0 || pos.x > Config.WORLD_WIDTH / Config.CHUNK_SIZE || pos.y < 0 || pos.y > Config.WORLD_HEIGHT / Config.CHUNK_SIZE)\r\n        if (pos.y < 0 || pos.y > Config.WORLD_HEIGHT / Config.CHUNK_SIZE)\r\n            return;\r\n        \r\n        const ores: (typeof Ore | null)[][] = [[null]];\r\n        __chunkId ++;\r\n    \r\n        for (let y = 0; y < Config.CHUNK_SIZE; y ++) {\r\n            ores.push([]);\r\n            for (let x = 0; x < Config.CHUNK_SIZE; x ++) {\r\n                ores[y].push(null);\r\n                const _y = y + pos.y * Config.CHUNK_SIZE;\r\n                const _x = x + pos.x * Config.CHUNK_SIZE;\r\n                \r\n                for (let i = 0; i < this.settings.length; i ++) {\r\n                    const gen = this.settings[i];\r\n    \r\n                    const noiseX = (x + pos.x * Config.CHUNK_SIZE)\r\n                    const noiseY = (y + pos.y * Config.CHUNK_SIZE)\r\n                    // const getValue = (x: number, y: number, div?: number)=> (+perlin2(x / (div || 10), y / (div || 10)) + 1) / 1.5;\r\n                    const getValue = (x: number, y: number, div?: number)=> noise(x / (div || 10), y / (div || 10), 3);\r\n                    const value = getValue(noiseX, noiseY, gen.divider);\r\n    \r\n                    const isValue = gen.value ? inRange(value, gen.value[0], gen.value[1]) : true; \r\n                    const rules = gen.rules ? gen.rules(noiseX, noiseY) : isValue;\r\n                    \r\n                    if (inRange(_y, gen.height[0], gen.height[1]) && rules)\r\n                        ores[y][x] = gen.block;\r\n                    // if (inRange(value, gen.value[0], gen.value[1]) && inRange(_y, gen.height[0], gen.height[1]) && rules)\r\n                    //     ores[y][x] = gen.block;\r\n                }\r\n                \r\n                const inChunkId = [x, y, pos.x, pos.y].join(\"-\");\r\n                if (ores[y][x] && this.destroyedOres.indexOf(inChunkId) < 0) {\r\n\r\n                    const ore = new (ores[y][x] as any)(new Vector2(_x, _y), this.modifiedOres[inChunkId]);\r\n                    ore.inChunkId = inChunkId;\r\n                    ore.group = `${ __chunkId }`;\r\n\r\n                    this.game.add(ore);\r\n\r\n                }\r\n    \r\n                \r\n            }\r\n        }\r\n    \r\n        this.game.initChildren();\r\n    \r\n        return { group: `${ __chunkId }`, pos };\r\n\r\n    }\r\n\r\n    checkIsInLoadedChunk(checkPosition: Vector2): boolean {\r\n        return this.chunks.findIndex(chunk=> Vector2.compare(chunk.pos, checkPosition.add(Vector2.all(Config.SPRITE_SIZE / 2)).div(Config.SPRITE_SIZE * Config.CHUNK_SIZE).apply(Math.floor))) >= 0;\r\n    }\r\n    destroyOre(inChunkId: Point[\"id\"]) {\r\n\r\n        delete this.modifiedOres[inChunkId];\r\n        this.destroyedOres.push(inChunkId);\r\n\r\n        this.onWorldChangeListeners.map(listener=> {\r\n            if ((listener.pos != null && listener.pos.distance(inChunkIdToPosition(inChunkId)) < 200) || !listener.pos)\r\n                listener.callback()\r\n        });\r\n\r\n        this.saveData();\r\n        \r\n    }\r\n    modifyOre(inChunkId: Point[\"id\"], data: Generator[\"modifiedOres\"][0][\"data\"]) {\r\n        this.modifiedOres[inChunkId] = data;\r\n        this.saveData();\r\n    }\r\n    onWorldChange(id: string, pos: Vector2 | null, callback: Generator[\"onWorldChangeListeners\"][0][\"callback\"], listenChunks?: boolean) {\r\n        this.onWorldChangeListeners.push({ id, pos, callback, listenChunks });\r\n    }\r\n    removeListenerById(id: string) {\r\n        this.onWorldChangeListeners = this.onWorldChangeListeners.filter(listener=> listener.id != id);\r\n    }\r\n\r\n    changeSeed() {\r\n        const needSeed = this.game.loadKey(\"seed\", Date.now());\r\n        this.seed = Config.IS_DEV ? 1636721068016 : (typeof needSeed == \"number\" ? needSeed : Date.now());\r\n        seed(this.seed);\r\n        this.game.saveKey(\"seed\", this.seed.toString());\r\n        console.log(`%cСид мира: ${ this.seed }`, `background: ${ Color.BLACK };color: ${ Color.YELLOW };padding:15px;font-size:20px;`);\r\n    }\r\n    saveData() {\r\n        this.game.saveKey(\"destroyedOres\", JSON.stringify(this.destroyedOres));\r\n        this.game.saveKey(\"modifiedOres\", JSON.stringify(this.modifiedOres));\r\n    }\r\n    reset() {\r\n        this.modifiedOres = {};\r\n        this.destroyedOres = [];\r\n        this.changeSeed();\r\n\r\n        this.saveData();\r\n    }\r\n}","export default {\r\n    err: {\r\n        assetLoadError: (name: string)=> `Failed to load asset with name \"${ name }\"`,\r\n        audioPlayError: (name: string)=> `Failed to play audio asset \"${ name }\"`,\r\n        cantFindBlockByInChunkId: (id: string)=> `Can't find block by inChunkId \"${ id }\"`,\r\n    }\r\n}","import { Game } from \"..\";\r\nimport messages from \"../../messages\";\r\nimport { Asset } from \"../Asset\"\r\nimport { asAudio, clamp, safeValue, Vector2 } from \"../utils/math\";\r\n\r\nexport class Sound {\r\n    assetName: string | null\r\n    audio: HTMLAudioElement | null | undefined\r\n    volume: number\r\n    \r\n    constructor() {\r\n        this.assetName = null;\r\n        this.audio = null;\r\n        this.volume = 1;\r\n    }\r\n\r\n    play(game: Game, assetName: string, volume?: number, loop?: boolean, toStart?: boolean) {\r\n        this.assetName = assetName;\r\n\r\n        this.audio = asAudio(game.getAssetByName(assetName));\r\n\r\n        if (!this.audio) {\r\n            console.error(messages.err.audioPlayError(assetName));\r\n            return;\r\n        }\r\n        \r\n        if (safeValue(toStart, true))\r\n            this.audio.currentTime = 0;\r\n            this.volume = safeValue(volume, 1)\r\n        this.audio.volume = this.volume;\r\n        this.audio.play();\r\n\r\n        if (loop)\r\n            this.audio.ontimeupdate = ()=> {\r\n                if (!this.audio) return;\r\n\r\n                if (this.audio.currentTime >= this.audio.duration-.3) {\r\n                    this.audio.currentTime = 0;\r\n                    this.audio.play();\r\n                }\r\n            }\r\n    }\r\n    stop() {\r\n        if (!this.audio) return;\r\n        if (this.audio.paused) return;\r\n        \r\n        this.audio.pause();\r\n        this.audio.currentTime = 0;\r\n    }\r\n\r\n    update3D(game: Game, emitterPosition: Vector2, maxDistance?: number) {\r\n        if (!this.audio) return;\r\n\r\n        const distance = safeValue(maxDistance, innerHeight / 2 + 300);\r\n        this.audio.volume = clamp(this.volume * clamp((1 - (game.camera.position.distance(emitterPosition) / distance)) * 1.8, 0, 1), 0, 1);\r\n        \r\n    }\r\n}","import { Point } from \"./components/Point\";\r\nimport { Asset, AssetType } from \"./Asset\";\r\nimport { Container } from \"./components/Container\";\r\nimport { Gamepad } from \"./events/Gamepad\";\r\nimport { Physics } from \"./Physics\";\r\nimport { Renderer } from \"./Renderer\";\r\nimport { random, Vector2 } from \"./utils/math\";\r\nimport { Generator } from \"./Generator\";\r\nimport { Sound } from \"./components/Sound\";\r\nimport messages from \"../messages\";\r\nimport { Config } from \"../config\";\r\n\r\nexport type Clock = {\r\n    elapsed: number\r\n    fps: number\r\n    delta: number\r\n};\r\ntype Camera = {\r\n    position: Vector2\r\n    rotation: number\r\n    offset: Vector2\r\n    startShakeElapsed: number\r\n    shaking: boolean\r\n    shakeAmplitude: number\r\n    follow: (pos: Vector2, lerp?: number)=> void\r\n    shake: (amplitude?: number)=> void\r\n}\r\n\r\nexport class Game extends Container {\r\n    paused: boolean\r\n    gamepad: Gamepad\r\n    camera: Camera\r\n    \r\n    assets: Asset[]\r\n    sounds: Sound[]\r\n\r\n    clock: Clock\r\n    initListeners: (()=> void)[]\r\n    updateListeners: ((clock: Clock)=> void)[]\r\n    renderListeners: ((renderer: Renderer)=> void)[]\r\n    \r\n    renderer: Renderer\r\n    physics: Physics\r\n    generator: Generator\r\n    \r\n    constructor() {\r\n        super();\r\n\r\n        this.paused = !false;\r\n        this.gamepad = new Gamepad();\r\n        this.camera = {\r\n            position: Vector2.zero(),\r\n            rotation: 0,\r\n            offset: Vector2.zero(),\r\n            startShakeElapsed: 0,\r\n            shaking: false,\r\n            shakeAmplitude: 2,\r\n            follow(pos: Vector2, lerp?: number) {\r\n                if (lerp)\r\n                    this.position.lerp(pos, lerp);\r\n                else\r\n                    this.position.copy(pos);\r\n            },\r\n            shake(amplitude?: number) {\r\n                this.shakeAmplitude = amplitude || 2;\r\n                if (!this.shaking) {\r\n                    this.shaking = true;\r\n                }\r\n            }\r\n        };\r\n        \r\n        this.assets = [];\r\n        this.sounds = [];\r\n        \r\n        this.clock = {\r\n            elapsed: 0,\r\n            fps: 0,\r\n            delta: 0\r\n        };\r\n        this.initListeners = [];\r\n        this.updateListeners = [];\r\n        this.renderListeners = [];\r\n        \r\n        this.renderer = new Renderer(this);\r\n        this.physics = new Physics(this);\r\n        this.generator = new Generator(this);\r\n\r\n        // if (Config.IS_DEV)\r\n        //     this.clearAllKeys();\r\n    }\r\n\r\n    saveKey(key: string, value: string) {\r\n        if (Config.IS_DEV) return;\r\n        \r\n        localStorage.setItem(key, value);\r\n    }\r\n    loadKey<T>(key: string, safe: T): T {\r\n        if (Config.IS_DEV) return safe;\r\n        \r\n        if (localStorage.getItem(key))\r\n            return JSON.parse(localStorage.getItem(key)!);\r\n        else\r\n            return safe;\r\n    }\r\n    clearAllKeys() {\r\n        localStorage.clear();\r\n    }\r\n\r\n    loadAsset(name: string, src: Asset[\"src\"], type?: AssetType) {\r\n        this.assets.push(new Asset(name, src, type));\r\n    }\r\n    getAssetByName(name: string): Asset | null | undefined {\r\n        const asset = this.assets.find(asset=> asset.name == name);\r\n        \r\n        if (asset)\r\n            return asset;\r\n        else\r\n            console.error(messages.err.assetLoadError(name));\r\n    }\r\n    \r\n    removeChildById(id: Point[\"id\"], listenerId?: string) {\r\n        this.gamepad.removeListenerById(listenerId || id);\r\n        this.generator.removeListenerById(listenerId || id);\r\n        super.removeChildById(id);\r\n    }\r\n\r\n    initChildren() {\r\n        super.initChildren(this);\r\n    }\r\n    \r\n    addInit(listener: Game[\"initListeners\"][0]) {\r\n        this.initListeners.push(listener);\r\n    }\r\n    addUpdate(listener: Game[\"updateListeners\"][0]) {\r\n        this.updateListeners.push(listener);\r\n    }\r\n    addRender(listener: Game[\"renderListeners\"][0]) {\r\n        this.renderListeners.push(listener);\r\n    }\r\n\r\n    tick(tick: number): boolean {\r\n        return this.clock.elapsed % tick == 0;\r\n    }\r\n    playSoundAt(position: Vector2, assetName: string, volume?: number) {\r\n        const sound = new Sound();\r\n\r\n        sound.play(this, assetName, volume);\r\n        \r\n        this.sounds.push(sound);\r\n    }\r\n\r\n    init() {\r\n\r\n        // Init\r\n        this.initListeners.map(listener=> listener());\r\n        this.initChildren();\r\n\r\n        let lastLoop = Date.now();\r\n\r\n        const loop = ()=> {\r\n            requestAnimationFrame(loop);\r\n            this.renderer.render();\r\n            this.clock.elapsed ++;\r\n\r\n            // Update clock\r\n            const thisLoop = Date.now();\r\n            this.clock.delta = (thisLoop - lastLoop) / 1000;\r\n            if (this.tick(30))\r\n                this.clock.fps = Math.floor(1000 / (thisLoop - lastLoop));\r\n            lastLoop = thisLoop;\r\n\r\n            // Camera shake\r\n            if (!this.camera.shaking) {\r\n                this.camera.startShakeElapsed = this.clock.elapsed;\r\n                this.camera.offset.lerp(Vector2.zero(), .2);\r\n            } else {\r\n                if ((this.clock.elapsed - this.camera.startShakeElapsed) % 10 == 0)\r\n                    this.camera.shaking = false;\r\n                this.camera.offset.copy(this.camera.offset.add(new Vector2(random(-this.camera.shakeAmplitude, this.camera.shakeAmplitude), random(-this.camera.shakeAmplitude, this.camera.shakeAmplitude))));\r\n            }\r\n            \r\n            // Update\r\n            this.physics.update();\r\n            this.callChildren(\"update\");\r\n            this.updateListeners.map(listener=> listener(this.clock));\r\n            \r\n            this.callChildren(\"render\");\r\n            this.renderListeners.map(listener=> listener(this.renderer));\r\n\r\n            this.renderer.renderParticles();\r\n            \r\n        }\r\n        // setInterval(loop, 16);\r\n        loop();\r\n\r\n        // Canvas update\r\n        window.addEventListener(\"resize\", ()=> {\r\n            this.renderer.updateAspect();\r\n        });\r\n        \r\n    }\r\n}","export class Timer {\r\n    started: boolean\r\n    elapsed: number\r\n    elapsedSeconds: number\r\n    startElapsed: number\r\n    triggerElapsed: number\r\n    \r\n    constructor(triggerElapsed: number) {\r\n        this.started = false;\r\n        this.elapsed = triggerElapsed * 60;\r\n        this.elapsedSeconds = triggerElapsed;\r\n        this.startElapsed = 0;\r\n        this.triggerElapsed = triggerElapsed;\r\n    }\r\n\r\n    start(elapsed: number) {\r\n        if (this.started) return;\r\n        \r\n        this.started = true;\r\n        this.startElapsed = elapsed;\r\n    }\r\n    reset() {\r\n        this.started = false;\r\n        this.startElapsed = this.triggerElapsed;\r\n        this.elapsed = this.triggerElapsed * 60;\r\n        this.elapsedSeconds = this.triggerElapsed;\r\n    }\r\n    update(elapsed: number) {\r\n        if (!this.started) return;\r\n        \r\n        this.elapsed = this.triggerElapsed * 60 - (elapsed - this.startElapsed);\r\n        this.elapsedSeconds = this.triggerElapsed - Math.floor((elapsed - this.startElapsed) / 60);\r\n    }\r\n    \r\n    isTriggered(): boolean {\r\n        return this.elapsed <= 0 && this.started;\r\n    }\r\n}","import { Game } from \"../Game\";\r\nimport { Renderer } from \"../Renderer\";\r\nimport { Point, IPointProps } from \"./Point\";\r\n\r\nexport type ITextProps = {\r\n    font?: string\r\n    color?: string\r\n} & IPointProps;\r\n\r\nexport class Text extends Point {\r\n    font: string\r\n    color: string\r\n    text: string\r\n    \r\n    constructor(name: string, text: string, props?: ITextProps) {\r\n        super(name, props);\r\n\r\n        this.text = text;\r\n        this.font = props?.font || \"18px Pixel\";\r\n        this.color = props?.color || \"#fff\";\r\n    }\r\n\r\n    render() {\r\n        super.render();\r\n\r\n        if (this.visible)\r\n            this.game.renderer.drawText({ ...this });\r\n    }\r\n}","import { Game } from \"..\";\r\nimport { ComponentType } from \"../../types\";\r\nimport { standardName, Vector2 } from \"../utils/math\";\r\nimport { Container } from \"./Container\";\r\n\r\nlet __id = 0;\r\n\r\nexport class Group extends Container {\r\n    game!: Game\r\n    id: string\r\n    type: ComponentType\r\n    name: string\r\n    \r\n    position: Vector2\r\n    visible: boolean\r\n    allowUpdateChildren: boolean\r\n    \r\n    constructor(name: string, position?: Vector2) {\r\n        super();\r\n        this.id = `${ name }-${ __id ++ }`;\r\n        this.type = \"group\";\r\n        this.name = standardName(name);\r\n\r\n        this.position = position || Vector2.zero();\r\n        this.visible = true;\r\n        this.allowUpdateChildren = true;\r\n    }\r\n\r\n    init() {\r\n        this.initChildren(this.game);\r\n    }\r\n    update() {\r\n        if (this.allowUpdateChildren)\r\n            this.callChildren(\"update\");\r\n    }\r\n    render() {\r\n        if (this.visible)\r\n            this.callChildren(\"render\");\r\n    }\r\n}","export * from \"./Game\";\r\n\r\nexport * from \"./utils/Timer\";\r\nexport * from \"./components/Point\";\r\nexport * from \"./components/Sprite\";\r\nexport * from \"./components/Text\";\r\nexport * from \"./components/Group\";","import { Game } from \"../Game\";\r\nimport { asImage, random, safeValue, Vector2 } from \"../utils/math\";\r\nimport { Color, Config } from \"../../config\";\r\nimport { Renderer } from \"../Renderer\";\r\n\r\ntype ParticlesSettings = {\r\n    colors?: any[]\r\n    downSize?: number\r\n    downOpacity?: number\r\n    size?: [number, number]\r\n    opacity?: number\r\n\r\n    gravity?: number\r\n    box?: ()=> Vector2\r\n\r\n    velocity?: ()=> Vector2\r\n    rotationVelocity?: ()=> number\r\n\r\n    render?: (renderer: Renderer, part: Particle)=> void\r\n}\r\n\r\nexport class Particle {\r\n    position: Vector2\r\n    rotation: number\r\n\r\n    velocity: Vector2\r\n    rotationVelocity: number\r\n\r\n    color: string\r\n    opacity: number\r\n    gravity: number\r\n    size: number\r\n    downSize: number\r\n    downOpacity: number\r\n    \r\n    render: (renderer: Renderer, part: Particle)=> void\r\n    \r\n    constructor(position: Vector2, settings?: ParticlesSettings) {\r\n        const c = settings?.colors;\r\n        this.color = c ? c[Math.floor(random(0, c.length))] : Color.BLACK;\r\n        this.opacity = safeValue(settings?.opacity, 1);\r\n        this.downOpacity = safeValue(settings?.downOpacity, 0);\r\n        \r\n        this.position = new Vector2(position.x, position.y);\r\n        this.rotation = random(0, Math.PI * 4);\r\n\r\n        const v = settings?.velocity;\r\n        const rv = settings?.rotationVelocity;\r\n        this.velocity = v ? v() : new Vector2(random(-5, 5), random(-10, 5));\r\n        this.rotationVelocity = rv ? rv() : random(-.1, .1)\r\n\r\n        const s = settings?.size;\r\n        this.size = (s ? s : [.5, 1.2])[Math.floor(random(0, 2))];\r\n        this.gravity = safeValue(settings?.gravity, Config.PARTICLES_GRAVITY);\r\n        this.downSize = safeValue(settings?.downSize, .01);\r\n\r\n        this.render = settings?.render ? settings?.render : (renderer, part)=> {\r\n            renderer.drawRect({\r\n                color: this.color,\r\n                width: this.size * .2,\r\n                height: this.size * .2,\r\n                position: this.position, rotation: this.rotation,\r\n                layer: \"particles\",\r\n                opacity: this.opacity\r\n            });\r\n        }\r\n    }\r\n\r\n    update(game: Game) {\r\n        this.velocity.y += this.gravity;\r\n\r\n        this.rotation += this.rotationVelocity;\r\n        this.size -= this.downSize;\r\n        this.opacity -= this.downOpacity;\r\n        \r\n        this.velocity.x *= .99;\r\n        this.velocity.y *= .99;\r\n        this.position.x += this.velocity.x;\r\n        this.position.y += this.velocity.y;\r\n    }\r\n}\r\n\r\nexport function SpawnParticles(game: Game, position: Vector2, settings?: ParticlesSettings & { count?: number }) {\r\n\r\n    const box = settings?.box;\r\n    \r\n    for (let i = settings?.count || 10; i --;)\r\n        game.renderer.particles.push(new Particle(position.expand().add(box ? box() : Vector2.zero()), settings));\r\n\r\n}\r\n\r\nexport function SpawnCrumbleParticles(game: Game, position: Vector2, colors?: ParticlesSettings[\"colors\"]) {\r\n    SpawnParticles(game, position, {\r\n        velocity: ()=> new Vector2(random(-2, 2), 0),\r\n        box: ()=> new Vector2(random(-40, 40), 0),\r\n        colors,\r\n        count: 5,\r\n    });\r\n}\r\n\r\nexport function SpawnDisputesParticles(game: Game, position: Vector2, intensity?: number) {\r\n    SpawnParticles(game, position, {\r\n        render: (renderer, part)=> {\r\n            renderer.drawSprite({\r\n                texture: asImage(game.getAssetByName(\"disputes\")),\r\n                position: part.position,\r\n                rotation: part.rotation,\r\n                opacity: part.opacity,\r\n                scale: Vector2.all(part.size)\r\n            })  \r\n        },\r\n        count: 6,\r\n        gravity: -.01,\r\n        size: [1.4 * safeValue(intensity, 1), 1.4 * safeValue(intensity, 1)],\r\n        rotationVelocity: ()=> random(-.01, -.01),\r\n        velocity: ()=> new Vector2(random(-1, 1), random(-1, 1)).mul(2 * safeValue(intensity, 1)),\r\n        opacity: 3 * safeValue(intensity, 1),\r\n        downSize: .002,\r\n        downOpacity: .01\r\n    });\r\n}","import { Color, Config } from \"../../config\";\r\nimport { Game, ISpriteProps, Sprite } from \"../../engine\"\r\nimport { Sound } from \"../../engine/components/Sound\";\r\nimport { SpawnParticles } from \"../../engine/components/Particles\";\r\nimport { random, safeValue, Vector2 } from \"../../engine/utils/math\"\r\nimport { Direction } from \"../../types\";\r\nimport { Ore } from \"../ores/Ore\";\r\nimport { ToolLevel } from \"./Player\";\r\n\r\nexport type IEntityProps = {\r\n    hp?: number\r\n    moveSpeed?: number\r\n} & ISpriteProps;\r\n\r\nexport class Entity extends Sprite {\r\n    sound: Sound\r\n    hp: number\r\n    initialMoveSpeed: number\r\n    moveSpeed: number\r\n    damaged: boolean\r\n    damagedElapsed: number\r\n    stayAnimation: string\r\n    walkAnimation: string\r\n    moveSpeedDown: number\r\n    startPosition: Vector2\r\n\r\n    dead: boolean\r\n    interest: boolean\r\n    regaining: boolean\r\n\r\n    movement: Vector2\r\n    allowMove: boolean\r\n    allowAnimate: boolean\r\n\r\n    digOffsetFactor: number\r\n    \r\n    constructor(name: string, assetName: string, props?: IEntityProps) {\r\n        super(name, assetName, props);\r\n        \r\n        this.sound = new Sound();\r\n        this.hp = props?.hp || 10;\r\n        this.moveSpeed = props?.moveSpeed || 5;\r\n        this.initialMoveSpeed = this.moveSpeed;\r\n        this.damaged = false;\r\n        this.damagedElapsed = 0;\r\n        this.stayAnimation = `${ name }-stay`;\r\n        this.walkAnimation = `${ name }-walk`;\r\n        this.moveSpeedDown = 0;\r\n        this.group = \"entity\";\r\n        this.startPosition = this.position.expand();\r\n\r\n        this.dead = false;\r\n        this.interest = true;\r\n        this.regaining = false;\r\n        \r\n        this.movement = new Vector2();\r\n        this.allowMove = true;\r\n        this.allowAnimate = true;\r\n\r\n        this.digOffsetFactor = .2;\r\n    }\r\n\r\n    init() {\r\n        super.init();\r\n\r\n        this.collider.type = \"dynamic\";\r\n    }\r\n\r\n    update() {\r\n        super.update();\r\n        this.bounds();\r\n        \r\n        if (!this.allowMove || this.regaining || this.dead || this.game.paused) {\r\n            this.movement.set();\r\n            this.velocity.set();\r\n        }\r\n\r\n        if (!this.damaged) {\r\n            this.damagedElapsed = this.game.clock.elapsed;\r\n            this.visible = true;\r\n        } else {\r\n            if ((this.game.clock.elapsed - this.damagedElapsed) % 50 == 0)\r\n                this.damaged = false;\r\n\r\n            this.blink();\r\n        }\r\n\r\n        this.offset.lerp(Vector2.zero(), this.digOffsetFactor);\r\n        this.animate();\r\n    }\r\n    dig(damage: number, speed: number, level: ToolLevel, direction: Direction) {\r\n        if (this.dead || this.regaining) return;\r\n        \r\n        if (this.collider.collidesWith != null && this.collider.collidesWith.any && this.collider.collidesWith.id!.indexOf(\"ore-\") >= 0) {\r\n            const ore = this.game.getChildById<Ore>(this.collider.collidesWith.id);\r\n\r\n            if (ore == undefined) return;\r\n\r\n            if (this.collider.collidesWith[direction] && this.position.distance(ore.position) < Config.SPRITE_SIZE * 2 && this.game.clock.elapsed % speed == 0) {\r\n                ore.hit(damage, level);\r\n\r\n                if (direction == \"right\")\r\n                    this.offset = new Vector2(10, 0);\r\n                else if (direction == \"left\")\r\n                    this.offset = new Vector2(-10, 0);\r\n                else if (direction == \"top\")\r\n                    this.offset = new Vector2(0, -10);\r\n                else if (direction == \"bottom\")\r\n                    this.offset = new Vector2(0, 10);\r\n            }\r\n\r\n        }\r\n        this.collider.collidesWith = null;\r\n\r\n    }\r\n\r\n    move() {\r\n        if (!this.allowMove || this.game.paused || this.regaining || this.dead) return;\r\n\r\n        if (this.movement.x != 0)\r\n            this.flip.x = this.movement.x < 0;\r\n        \r\n        this.velocity.x = this.movement.normalize().x * (this.moveSpeed - this.moveSpeedDown);\r\n        this.velocity.y = this.movement.normalize().y * (this.moveSpeed - this.moveSpeedDown);\r\n    }\r\n    animate() {\r\n        if (!this.allowAnimate || this.dead || this.regaining) return;\r\n        \r\n        if (this.velocity.x != 0 || this.velocity.y != 0)\r\n            this.playAnimation(this.walkAnimation, 4);\r\n        else\r\n            this.playAnimation(this.stayAnimation, 1);\r\n    }\r\n\r\n    hit(damage: number) {\r\n        if (this.damaged) return;\r\n\r\n        this.hp -= damage;\r\n        this.damaged = true;\r\n\r\n        this.spawnText(`-${ damage }`, undefined, Color.RED);\r\n    }\r\n    die() {\r\n        if (this.dead) return;\r\n        \r\n        this.allowMove = false;\r\n        this.interest = false;\r\n        this.dead = true;\r\n    }\r\n    bounds() {\r\n        // World bounds\r\n        const worldWidth = Math.floor((Config.WORLD_WIDTH * Config.SPRITE_SIZE));\r\n        \r\n        // By width\r\n        if (this.position.x < 0)\r\n            this.position.x = 0\r\n        else if (this.position.x > worldWidth)\r\n            this.position.x = worldWidth\r\n        \r\n        // Dome bounds\r\n        const halfDiameter = Config.DOME_DIAMETER / 2;\r\n\r\n        if (this.position.x > Config.WORLD_X_CENTER - halfDiameter + 40 && this.position.x < Config.WORLD_X_CENTER + halfDiameter - 40) {\r\n            if (this.position.y < -Config.SPRITE_SIZE / 2) {\r\n        \r\n                if (this.position.y < -Config.GROUND_HEIGHT) {\r\n                    this.position.y = -Config.GROUND_HEIGHT;\r\n                }\r\n                if (this.position.x < Config.WORLD_X_CENTER - halfDiameter + 48)\r\n                    this.position.x = Config.WORLD_X_CENTER - halfDiameter + 48;\r\n                if (this.position.x > Config.WORLD_X_CENTER + halfDiameter - 48)\r\n                    this.position.x = Config.WORLD_X_CENTER + halfDiameter - 48;\r\n\r\n            }\r\n\r\n        } else {\r\n            // By height\r\n            if (this.position.y < -Config.SPRITE_SIZE / 2)\r\n                this.position.y = -Config.SPRITE_SIZE / 2;\r\n        }\r\n    }\r\n\r\n    spawnText(text: string, offset?: Vector2, color?: string) {\r\n        SpawnParticles(this.game, this.position.add(safeValue(offset, new Vector2(0, -30))), {\r\n            render(renderer, part) {\r\n                renderer.drawText({\r\n                    text,\r\n                    font: \"22px Pixel\",\r\n                    color: color,\r\n                    position: part.position,\r\n                    opacity: part.opacity, \r\n                    rotation: part.velocity.y / 20,\r\n                    layer: \"particles\"\r\n                });\r\n            },\r\n            opacity: 5,\r\n            count: 1,\r\n            gravity: .04,\r\n            velocity: ()=> new Vector2(0, -2),\r\n            downOpacity: .08,\r\n            downSize: 0,\r\n            box: ()=> new Vector2(random(-10, 10), random(-10, 10))\r\n        });\r\n    }\r\n    blink() {\r\n        if (!this.dead)\r\n            super.blink();\r\n    }\r\n}","import { Color, Config } from \"../../config\";\r\nimport { Game } from \"../Game\";\r\nimport { DrawRectProps, DrawSpriteProps, DrawTextProps, Renderer, StrokeSettings } from \"../Renderer\";\r\nimport { asImage, assetIsValid, clamp, lerp, random, safeValue, Vector2, wrapText } from \"../utils/math\";\r\nimport { SpawnParticles } from \"./Particles\";\r\n\r\ntype IProgressBarProps = {\r\n    progress: number\r\n    color?: string\r\n    strokeColor?: string\r\n    width: number\r\n    height: number\r\n    position: Vector2\r\n    layer?: string\r\n}\r\n\r\nexport class Button {\r\n    width: number\r\n    height: number\r\n    \r\n    position: Vector2\r\n    assetName: string\r\n    layer: string\r\n\r\n    animatedPosY: number\r\n    allowScale: boolean\r\n    \r\n    constructor(width?: number, height?: number, layer?: string, assetName?: string, allowScale?: boolean) {\r\n        this.width = safeValue(width, 1);\r\n        this.height = safeValue(height, 1);\r\n        \r\n        this.position = Vector2.zero(); \r\n        this.assetName = assetName || \"interact\";\r\n        this.layer = layer || \"game-ui\";\r\n\r\n        this.animatedPosY = 0;\r\n        this.allowScale = safeValue(allowScale, true);\r\n    }\r\n    \r\n    render(game: Game) {\r\n        this.animatedPosY = lerp(this.animatedPosY, 0, .2);\r\n        \r\n        game.renderer.drawSprite({\r\n            texture: asImage(game.getAssetByName(this.assetName)),\r\n            width: this.width,\r\n            height: this.height,\r\n            position: this.position.add(new Vector2(0, this.animatedPosY)),\r\n            scale: Vector2.all(this.allowScale ? .7 : 1),\r\n            layer: this.layer\r\n        });\r\n    }\r\n    \r\n    click() {\r\n        this.animatedPosY = 10;\r\n    }\r\n}\r\n\r\nexport class UI {\r\n    game!: Game\r\n    enabled: boolean\r\n    \r\n    allowSelectSlots: boolean\r\n    focused: {\r\n        row: number\r\n        slot: number\r\n    }\r\n    ghostFocused: UI[\"focused\"]\r\n    template: number[]\r\n    \r\n    constructor() {\r\n        this.enabled = true;\r\n\r\n        this.allowSelectSlots = true;\r\n        this.focused = { row: 0, slot: 0 };\r\n        this.ghostFocused = { row: 0, slot: 0 };\r\n        this.template = [1];\r\n    }\r\n\r\n    init(game: Game) {\r\n        this.game = game;\r\n\r\n        game.gamepad.onAnyKeyDown(\"ui-listener\", name=> {\r\n            if (!this.allowSelectSlots || !this.enabled) return\r\n\r\n            switch (name) {\r\n                case \"right\":\r\n                    this.focused.slot ++;\r\n                    this.bounds();\r\n                    break;\r\n                case \"left\":\r\n                    this.focused.slot --;\r\n                    this.bounds();\r\n                    break;\r\n                case \"up\":\r\n                    if (this.ghostFocused.row == Math.abs((this.focused.row % this.template.length) - 1))\r\n                        this.focused.slot = this.ghostFocused.slot;\r\n                    this.focused.row --;\r\n                    this.bounds();\r\n                    break;\r\n                case \"down\":\r\n                    if (this.ghostFocused.row == (this.focused.row % this.template.length) + 1)\r\n                        this.focused.slot = this.ghostFocused.slot;\r\n                    this.focused.row ++;\r\n                    this.bounds();\r\n                    break;\r\n            }\r\n\r\n        });\r\n\r\n        \r\n    }\r\n    bounds() {\r\n        if (this.focused.row < 0)\r\n            this.focused.row = this.template.length-1;\r\n        else if (this.focused.row > this.template.length-1)\r\n            this.focused.row = 0;\r\n        \r\n        this.focused.row = clamp(this.focused.row, 0, this.template.length-1);\r\n        if (this.focused.slot > this.template[this.focused.row]-1)\r\n            this.focused.slot = 0;\r\n        else if (this.focused.slot < 0)\r\n            this.focused.slot = this.template[this.focused.row]-1;\r\n\r\n        this.focused.slot = clamp(this.focused.slot, 0, this.template[this.focused.row]-1);\r\n    }\r\n    render() {\r\n        if (!this.enabled) return;\r\n    }\r\n    updateTemplate(template: UI[\"template\"]) {\r\n        this.template = template.filter(t=> t > 0)\r\n    }\r\n\r\n    renderFocusable(pos: Vector2, row: number, slot: number, render: ()=> void, width?: number, height?: number, ghost?: boolean) {\r\n        if (!this.enabled) return;\r\n\r\n        const isFocused = this.focused.row == row && this.focused.slot == slot;\r\n        const isGhostFocused = this.ghostFocused.row == row && this.ghostFocused.slot == slot;\r\n        \r\n        if (ghost && isFocused)\r\n            this.ghostFocused = { row, slot };\r\n        render();\r\n        \r\n        if (isFocused || (isGhostFocused && ghost)) {\r\n            this.rect({\r\n                color: \"rgba(0, 0, 0, 0)\",\r\n                width: safeValue(width, 1),\r\n                height: safeValue(height, 1),\r\n                position: pos.apply(Math.floor),\r\n                stroke: { width: 4, color: Color.ORANGE },\r\n                opacity: (isGhostFocused && !isFocused) ? .2 : 1,\r\n            });\r\n        }\r\n\r\n    }\r\n    renderDescriptionUI(props: {\r\n        title: string,\r\n        titleColor?: string,\r\n        specials: string[],\r\n        description: string,\r\n        renderIcon: (pos: Vector2)=> void\r\n    }) {\r\n        const size = Config.SPRITE_SIZE;\r\n        const windowCenter = new Vector2(innerWidth / 2, innerHeight / 2).apply(Math.floor);\r\n        const margin = 6;\r\n        const lineHeight = 22;\r\n\r\n        // Container\r\n        this.sprite(\"description-ui\", {\r\n            position: new Vector2(0, size * 3).add(windowCenter),\r\n            width: 7,\r\n            height: 5,\r\n        });\r\n        \r\n        // Icon\r\n        props.renderIcon(new Vector2(-2.5 * size + size / 2, size + 70).add(windowCenter));\r\n\r\n        // Texts\r\n        const titleTextWrapped = wrapText(props.title, 26);\r\n        const specialText = props.specials.join(\"\\n\");\r\n        const descriptionText = wrapText(props.description, 31).text;\r\n        \r\n        // Title\r\n        this.text(titleTextWrapped.text, {\r\n            font: \"20px Pixel\",\r\n            position: new Vector2(-size * 1.3, size + 70 - size / 2 + 15).add(windowCenter),\r\n            align: \"left\",\r\n            color: props.titleColor || \"#fff\",\r\n        });\r\n        // Specials\r\n        this.text(specialText, {\r\n            color: Color.ORANGE,\r\n            position: new Vector2(-size * 1.3, size + 70 + margin + (titleTextWrapped.wrapCount >= 1 ? lineHeight : 0)).add(windowCenter),\r\n            align: \"left\",\r\n        });\r\n        // Description\r\n        this.text(descriptionText, {\r\n            position: new Vector2(-size * 1.3, size + 70 + lineHeight + margin * 2 + lineHeight * titleTextWrapped.wrapCount + lineHeight * (props.specials.length - 1)).add(windowCenter),\r\n            align: \"left\",\r\n        });\r\n\r\n    }\r\n    renderProgressBar(props: IProgressBarProps) {\r\n        if (!this.game) return;\r\n\r\n        const width = props.width;\r\n        const height = props.height;\r\n        const progress = height * props.progress;\r\n        const pos = props.position.apply(Math.floor);\r\n\r\n        this.game.renderer.drawRect({\r\n            width: (width + 10) / Config.SPRITE_SIZE,\r\n            height: (height + 10) / Config.SPRITE_SIZE,\r\n            position: pos.add(Vector2.all(.5)),\r\n            color: Color.STONE_LAYER_COLOR,\r\n            stroke: {\r\n                color: props.strokeColor || Color.ORANGE,\r\n                width: 4\r\n            },\r\n            layer: props.layer || \"ui\"\r\n        })\r\n        this.game.renderer.drawRect({\r\n            width: width / Config.SPRITE_SIZE,\r\n            height: progress / Config.SPRITE_SIZE,\r\n            position: pos.add(new Vector2(0, (height - height * props.progress) / 2)).add(Vector2.all(.5)),\r\n            color: props.color || Color.YELLOW,\r\n            layer: props.layer || \"ui\"\r\n        })\r\n        \r\n    }\r\n\r\n    spawnMessageText(text: string) {\r\n        SpawnParticles(this.game, new Vector2(20, innerHeight - 40), {\r\n            // custom: new Text(\"store-text\", text, { font: \"22px Pixel\" }),\r\n            render(renderer, part) {\r\n                renderer.drawText({\r\n                    text,\r\n                    font: \"22px Pixel\",\r\n                    position: part.position,\r\n                    opacity: part.size, \r\n                    layer: \"ui\",\r\n                    align: \"left\"\r\n                });\r\n            },\r\n            size: [5, 5],\r\n            count: 1,\r\n            gravity: 0,\r\n            rotationVelocity: ()=> random(-.02, .02),\r\n            velocity: ()=> new Vector2(0, -1.5),\r\n            downSize: .08,\r\n        });\r\n    }\r\n    isFocused(row: number, slot: number): boolean {\r\n        return this.focused.row == row && this.focused.slot == slot;\r\n    }\r\n\r\n    // Render\r\n    sprite(assetName: string, props?: DrawSpriteProps) {\r\n        this.game.renderer.drawSprite({\r\n            ...props,\r\n            layer: \"ui\",\r\n            texture: asImage(this.game.getAssetByName(assetName)),\r\n        });\r\n    }\r\n    text(text: string, props?: DrawTextProps) {\r\n        this.game.renderer.drawText({\r\n            ...props,\r\n            layer: \"ui\",\r\n            text\r\n        });\r\n    }\r\n    rect(props?: DrawRectProps) {\r\n        this.game.renderer.drawRect({\r\n            ...props,\r\n            layer: \"ui\"\r\n        }); \r\n    }\r\n}","import { Config, ItemSettings } from \"../../config\"\r\nimport { Game, ISpriteProps, Sprite } from \"../../engine\"\r\nimport { compareNames, random, Vector2 } from \"../../engine/utils/math\"\r\nimport { Player } from \"../entities/Player\"\r\n\r\nexport class ItemParent extends Sprite {\r\n    radius: number\r\n    picked: boolean\r\n    allowPickup: boolean\r\n    liveStartElapsed: number\r\n    nearOnInit: boolean\r\n    foldToPosition: Vector2\r\n    \r\n    constructor(name: string, assetName: string, position: Vector2, props?: ISpriteProps) {\r\n        super(name, assetName, {\r\n            ...props,\r\n            colliderType: \"dynamic\",\r\n            position: position.expand()\r\n        });\r\n\r\n        this.radius = 4;\r\n        this.group = \"items\";\r\n        this.allowPickup = true;\r\n        this.picked = false;\r\n        this.liveStartElapsed = 0;\r\n        this.nearOnInit = false;\r\n        this.foldToPosition = Vector2.zero();\r\n\r\n        this.collider.width = 6 * Config.SPRITE_SCALE;\r\n        this.collider.height = 6 * Config.SPRITE_SCALE;\r\n        this.acceleration.set(.8, .8);\r\n    }\r\n\r\n    init() {\r\n        super.init();\r\n        \r\n        this.liveStartElapsed = this.game.clock.elapsed;\r\n        this.layer = \"particles\";\r\n        this.velocity.set(random(-8, 8), random(-8, 8));\r\n\r\n        if (this.checkDistanceToPlayer(this.game.getChildById(\"player\"), Config.PICKUP_DISTANCE * 2))\r\n            this.nearOnInit = true;\r\n    }\r\n    update() {\r\n        super.update();\r\n\r\n        if (this.picked) {\r\n            const player = this.game.getChildById<Player>(\"player\");\r\n            if (player)\r\n                this.whenPicked(player);\r\n        }\r\n        \r\n        if (this.allowPickup) {\r\n            // Move to player wire\r\n            this.followPlayer(this.game.getChildById<Player>(\"player\"));\r\n            this.collideWidthOtherItems((this.game.children as ItemParent[]).filter(child=> child.group == \"items\" && child.allowPickup && child.picked));\r\n        } else {\r\n            // Fold\r\n            this.moveTo(this.foldToPosition);\r\n            if (this.foldToPosition.distance(this.position) < 30)\r\n                this.game.removeChildById(this.id);\r\n        }\r\n\r\n        // Change collider type\r\n        this.collider.type = this.picked ? \"dynamic\" : \"none\";\r\n    }\r\n\r\n    pickup(player: Player, count: number) {\r\n        player.pickup(this, this.name, count);\r\n    }\r\n    whenPicked(player: Player) {}\r\n\r\n    followPlayer(player: Player | undefined) {\r\n        if (!player) return;\r\n\r\n        if (!this.checkDistanceToPlayer(player))\r\n            this.nearOnInit = false;\r\n\r\n        if (this.nearOnInit) return;\r\n            \r\n        if (!this.picked && this.checkDistanceToPlayer(player)) {\r\n            this.pickup(player, 1);\r\n            this.picked = true;\r\n        }\r\n        else if (this.picked && player.wire.distance(this.position) > Config.PICKUP_DISTANCE) {\r\n            this.pickup(player, -1);\r\n            this.picked = false;\r\n        }\r\n        \r\n        if (!this.picked) return;\r\n\r\n        this.moveTo(player.wire);\r\n        this.game.renderer.drawLine({\r\n            color: ItemSettings[this.name] ? ItemSettings[this.name].lineColor : \"#fff\",\r\n            width: 2,\r\n            points: [this.position, player.position],\r\n            layer: \"bg\"\r\n        });\r\n\r\n    }\r\n    checkDistanceToPlayer(player: Player | undefined, distance?: number): boolean | undefined {\r\n        if (player)\r\n            return player.position.distance(this.position) < (distance || Config.PICKUP_DISTANCE);\r\n    }\r\n\r\n    collideWidthOtherItems(items: ItemParent[]) {\r\n        if (!this.picked) return;\r\n        \r\n        items.map((item, index)=> {\r\n        \r\n            if (item.position.distance(this.position) < (this.radius + item.radius) * Config.SPRITE_SCALE) {\r\n                item.position.copy(item.position.add(item.position.sub(this.position).normalize()));\r\n            }\r\n\r\n        });\r\n    }\r\n    moveTo(position: Vector2) {\r\n        this.velocity.copy(this.velocity.add(position.sub(this.position).mul(.04)));\r\n    }\r\n}","import { ISpriteProps } from \"../../engine\";\r\nimport { Vector2 } from \"../../engine/utils/math\";\r\nimport { ItemParent } from \"./ItemParent\";\r\n\r\nexport type ItemType = \r\n    \"item-robot\" | \"battery\" | \"drill\" | \"box\" | \"card\";\r\n\r\nexport class Item extends ItemParent {\r\n    itemType: ItemType\r\n    \r\n    constructor(type: ItemType, position: Vector2, props?: ISpriteProps) {\r\n        super(type, type, position, props);\r\n\r\n        this.itemType = type;\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { Player } from \"../entities/Player\";\r\nimport { Item } from \"./Item\";\r\n\r\nexport class RobotItem extends Item {\r\n    constructor(position: Vector2) {\r\n        super(\"item-robot\", position, {\r\n            scale: Vector2.all(.8)\r\n        });\r\n    }\r\n\r\n    whenPicked(player: Player) {\r\n        super.whenPicked(player);\r\n            \r\n        if (player.position.y < 20) return;\r\n        \r\n        player.expectedActionType = { name: \"place\", priority: 0 };\r\n\r\n    }\r\n\r\n}","import { Config } from \"../../config\";\r\nimport { SpawnParticles } from \"../../engine/components/Particles\";\r\nimport { Button } from \"../../engine/components/UI\";\r\nimport { random, Vector2 } from \"../../engine/utils/math\";\r\nimport { RobotItem } from \"../item/RobotItem\";\r\nimport { Ore } from \"../ores/Ore\";\r\nimport { Entity } from \"./Entity\";\r\nimport { Player } from \"./Player\";\r\n\r\nexport class Robot extends Entity {\r\n    pickupButton: Button\r\n    playerIsNear: boolean\r\n    \r\n    breaked: boolean\r\n\r\n    initElapsed: number\r\n    allowPickup: boolean\r\n    \r\n    constructor(position: Vector2) {\r\n        super(\"robot\", \"robot\", {\r\n            position: position.expand(),\r\n            scale: Vector2.zero()\r\n        });\r\n\r\n        this.pickupButton = new Button();\r\n        this.playerIsNear = false;\r\n        \r\n        this.movement = new Vector2(0, 1);\r\n        this.allowAnimate = false;\r\n        this.acceleration.set(.95, .95);\r\n        this.stayAnimation = \"robot\";\r\n\r\n        this.breaked = false;\r\n\r\n        this.initElapsed = 0;\r\n        this.allowPickup = false;\r\n\r\n        this.digOffsetFactor = .1;\r\n    }\r\n\r\n    init() {\r\n        super.init();\r\n\r\n        this.scale.set();\r\n\r\n        this.initElapsed = this.game.clock.elapsed;\r\n        this.game.gamepad.onKeyDown(this.id, \"enter\", ()=> {\r\n            if (!this.playerIsNear || !this.allowPickup) return;\r\n\r\n            // Pickup robot\r\n            this.pickupButton.click();\r\n            this.pickup();\r\n            console.log(true);\r\n        });\r\n\r\n        // Play motor start sound\r\n        this.sound.play(this.game, \"motor-start\", .5);\r\n    }\r\n    update() {\r\n        super.update();\r\n\r\n        // Audio\r\n        this.sound.update3D(this.game, this.position);\r\n\r\n        // Allow pickup\r\n        if (this.scale.mul(10).apply(Math.round).x >= 10 && !this.allowPickup)\r\n            this.allowPickup = true;\r\n        \r\n        // If not in loaded chunk\r\n        if (!this.game.generator.checkIsInLoadedChunk(this.position)) {\r\n            this.velocity.set();\r\n            return;\r\n        }\r\n\r\n        this.checkPlayerDistance();\r\n        \r\n        if (!this.breaked)\r\n            this._move();\r\n\r\n        if (!this.collider.collidesWith) return;\r\n        const ore = this.game.getChildById<Ore>(this.collider.collidesWith.id);\r\n        if (!ore) return;\r\n        \r\n        // If robot cant destroy ore\r\n        if (ore.needToolLevel > 2 && !this.breaked) {\r\n            this.breaked = true;\r\n        }\r\n        \r\n        this.dig(Config.ROBOT_DAMAGE, Config.ROBOT_HIT_SPEED, 2, \"bottom\");\r\n        \r\n    }\r\n    render() {\r\n        super.render();\r\n\r\n        this.scale.lerp(Vector2.all(), .1);\r\n\r\n        // Pickup button\r\n        if (this.playerIsNear) {\r\n            this.pickupButton.position = new Vector2(0, -90).add(this.position)\r\n            this.pickupButton.render(this.game);\r\n            this.game.renderer.drawText({\r\n                text: \"Подобрать\",\r\n                position: new Vector2(0, -50).add(this.position),\r\n            });\r\n        }\r\n        \r\n        // Smoke\r\n        if (this.breaked)\r\n            this.smoke();\r\n\r\n    }\r\n\r\n    _move() {\r\n        this.velocity.copy(this.velocity.add(this.movement.mul(.2)));\r\n    }\r\n\r\n    smoke() {\r\n\r\n        if (this.game.clock.elapsed % 20 == 0) {\r\n            SpawnParticles(this.game, this.position, {\r\n                render: (renderer, part)=> {\r\n\r\n                    renderer.drawRect({\r\n                        color: part.color,\r\n                        position: part.position,\r\n                        rotation: part.rotation,\r\n                        width: part.size / 5,\r\n                        height: part.size / 5,\r\n                        opacity: part.opacity\r\n                    });\r\n\r\n                },\r\n                colors: [\"rgba(50, 50, 50, .8)\"],\r\n                count: 1,\r\n                size: [1, 1.5],\r\n                velocity: ()=> new Vector2(random(-1, 1), random(-1, -3)),\r\n                box: ()=> new Vector2(random(-10, 10), random(-10, 10)),\r\n                rotationVelocity: ()=> random(-1, 1) * .01,\r\n                downSize: -.025,\r\n                downOpacity: .008,\r\n                gravity: .01,\r\n            });\r\n        }\r\n\r\n    }\r\n    checkPlayerDistance() {\r\n\r\n        const player = this.game.getChildById<Player>(\"player\");\r\n        if (!player) return;\r\n        \r\n        this.playerIsNear = player.position.distance(this.position) < Config.ROBOT_PICKUP_DISTANCE\r\n    }\r\n    pickup() {\r\n        this.game.add(new RobotItem(this.position));\r\n        this.game.initChildren();\r\n        this.game.removeChildById(this.id);\r\n        this.playerIsNear = false;\r\n    }\r\n}","import { Color, Config } from \"../../config\";\r\nimport { asImage, chance, clamp, lerp, random, Vector2 } from \"../../engine/utils/math\";\r\nimport { Entity } from \"./Entity\";\r\nimport { ItemParent } from \"../item/ItemParent\";\r\nimport { Robot } from \"./Robot\";\r\nimport { Food } from \"../food/Food\";\r\nimport { OxygenGenerator } from \"../gear/OxygenGenerator\";\r\nimport { Storage } from \"../gear/Storage\";\r\nimport { Recycler } from \"../gear/Recycler\";\r\nimport { Timer } from \"../../engine\";\r\n\r\n// > 5 is \"god tool\"\r\nexport type ToolLevel = 1 | 2 | 3 | 4 | 5 | 6;\r\nexport const MaxToolLevel = 4;\r\nexport type Tool = {\r\n    speed: number,\r\n    damage: number\r\n}\r\n\r\nconst tools: { [key: string]: Tool }  = {\r\n    \"1\": {\r\n        speed: 16,\r\n        damage: 2\r\n    },\r\n    \"2\": {\r\n        speed: 16,\r\n        damage: 4\r\n    },\r\n    \"3\": {\r\n        speed: 10,\r\n        damage: 3\r\n    },\r\n    \"4\": {\r\n        speed: 14,\r\n        damage: 8\r\n    },\r\n    \"5\": {\r\n        speed: 5,\r\n        damage: 20\r\n    },\r\n    \"6\": {\r\n        speed: 16,\r\n        damage: 6\r\n    },\r\n}\r\n\r\nexport class Player extends Entity {\r\n    storage!: Storage\r\n    oxygenGenerator!: OxygenGenerator\r\n    recycler!: Recycler\r\n    \r\n    oxygenHungry: boolean\r\n    oxygenHungryTimer: Timer\r\n\r\n    respawnTimer: Timer\r\n    animatedDieUI: number\r\n    tries: number\r\n    dieMessage: \"respawn\" | \"replay\"\r\n    \r\n    \r\n    wire: Vector2\r\n    inventory: {\r\n        totalCount: number\r\n        slots: {\r\n            [key: string]: {\r\n                count: number\r\n                instances: ItemParent[]\r\n            }\r\n        }\r\n    }\r\n    toolLevel: ToolLevel\r\n    hasBottle: boolean\r\n    allowPlaceRobot: boolean\r\n    allowEatFood: boolean\r\n    actionText: { [name: string]: string }\r\n    actionType: { name: \"none\" | \"grab\" | \"place\" | \"eat\", priority: number } | null\r\n    expectedActionType: Player[\"actionType\"]\r\n    // nearFetusStone: FetusStone | undefined;\r\n\r\n    damageAnimatedOpacity: number\r\n    animatedCameraRotation: number\r\n    animatedTimerScale: number\r\n    \r\n    constructor() {\r\n        super(\"player\", \"player-stay\", {\r\n            position: new Vector2(Config.WORLD_WIDTH * Config.SPRITE_SIZE / 2, -Config.SPRITE_SIZE),\r\n            layer: \"player\"\r\n        });\r\n        \r\n        this.hp = 12;\r\n        this.oxygenHungry = false;\r\n        this.oxygenHungryTimer = new Timer(Config.OXYGEN_HUNGRY_TIME);\r\n\r\n        this.respawnTimer = new Timer(Config.RESPAWN_TIME);\r\n        this.animatedDieUI = 0;\r\n        this.tries = 2;\r\n        this.dieMessage = \"respawn\";\r\n\r\n        this.wire = this.position.expand();\r\n        this.inventory = {\r\n            totalCount: 0,\r\n            slots: {}\r\n        };\r\n        this.hasBottle = false;\r\n        this.toolLevel = Config.ALLOW_HUNK ? 5 : 1;\r\n        this.allowPlaceRobot = false;\r\n        this.allowEatFood = false;\r\n        this.actionType = null;\r\n        this.expectedActionType = null;\r\n        this.actionText = {\r\n            \"grab\": \"cобрать\",\r\n            \"place\": \"установить\",\r\n            \"eat\": \"съесть\"\r\n        }\r\n\r\n        this.damageAnimatedOpacity = 0;\r\n        this.animatedCameraRotation = 0;\r\n        this.animatedTimerScale = 1;\r\n\r\n        window.addEventListener(\"keydown\", e=> {\r\n            if (Config.ALLOW_HUNK || (window as any).MODER_CHEAT || Config.IS_DEV) {\r\n                \r\n                if (e.code == \"KeyT\") {\r\n                    this.collider.collidable = !this.collider.collidable;\r\n                    this.moveSpeed = !this.collider.collidable ? 60 : this.initialMoveSpeed;\r\n                    this.toolLevel = 6;\r\n\r\n                    const storage = this.game.getChildById<Storage>(\"gear-storage\");\r\n                    if (!storage) return;\r\n                    \r\n                    storage.contains = { totalCount: 0, slots: {\r\n                        \"raw-grade-cidium\": { count: 2 },\r\n                        \"ready-cidium\": { count: 2 },\r\n                        \"battery\": { count: 2 },\r\n                        \"item-robot\": { count: 2 },\r\n                        \"food-fetus\": { count: 2 },\r\n                        \"raw-manty\": { count: 1 },\r\n                        \"raw-rady\": { count: 1 },\r\n                    } };\r\n                    storage.calculateTotalCount();\r\n                }\r\n\r\n            }\r\n        })\r\n    }\r\n    \r\n    init() {\r\n        super.init();\r\n        \r\n        const tries = this.game.loadKey(\"tries\", 2);\r\n        this.tries = tries <= 0 ? 2 : tries;\r\n        this.hp = this.game.loadKey(\"player-hp\", 12);\r\n        this.toolLevel = this.game.loadKey(\"player-toolLevel\", 1);\r\n        \r\n        this.collider.width = 10 * Config.SPRITE_SCALE;\r\n        this.collider.height = 10 * Config.SPRITE_SCALE;\r\n        this.collider.offset = new Vector2(3, 0);\r\n\r\n        // Set robot\r\n        this.game.gamepad.onKeyDown(this.id, \"enter\", ()=> {\r\n            if (this.checkItemInInventory(\"item-robot\") && this.allowPlaceRobot)\r\n                this.placeRobot();\r\n\r\n            this.useFood();\r\n            \r\n        });\r\n\r\n        this.saveData();\r\n\r\n        // Gears\r\n        this.storage = this.game.getChildById(\"gear-storage\")!;\r\n        this.recycler = this.game.getChildById(\"gear-recycler\")!;\r\n        this.oxygenGenerator = this.game.getChildById(\"gear-oxygen-generator\")!;\r\n    }\r\n\r\n    update() {\r\n        super.update();\r\n        \r\n        this.game.renderer.layers[\"ui\"].render = !(this.dead || this.regaining); \r\n        \r\n        // Timers\r\n        this.respawnTimer.update(this.game.clock.elapsed);\r\n        this.oxygenHungryTimer.update(this.game.clock.elapsed);\r\n\r\n        // Animations\r\n        // Dead\r\n        if (this.dead) {\r\n            this.playAnimation(\"player-dead\", 5, 26, false)\r\n            if (this.frame.x >= 5) {\r\n                if (!this.respawnTimer.started)\r\n                    this.animatedDieUI = -4;\r\n                this.respawnTimer.start(this.game.clock.elapsed);\r\n            }\r\n\r\n            if (this.respawnTimer.isTriggered()) {\r\n                // Respawn\r\n                if (this.tries > 0)\r\n                    this.respawn();\r\n                else {\r\n                    this.respawn();\r\n                    this.gameOver();\r\n                }\r\n            }\r\n        }\r\n        if (this.regaining) {\r\n            this.playAnimation(\"player-dead\", 5, 26, false, true);\r\n\r\n            if (this.frame.x <= 0) {\r\n                this.regaining = false;\r\n                this.allowMove = true;\r\n                this.interest = true;\r\n            }\r\n        }\r\n        \r\n        this.movement.set(\r\n            (+this.game.gamepad.keys.right - +this.game.gamepad.keys.left),\r\n            (+this.game.gamepad.keys.down - +this.game.gamepad.keys.up)\r\n        );\r\n        this.move();\r\n\r\n        this.pullWire();\r\n        this.changeActionType();\r\n\r\n        this.allowEatFood = this.checkItemInInventory(\"food-fetus\") && this.hp <= 11;\r\n        this.allowPlaceRobot = this.position.y > 20;\r\n\r\n        // Oxygen hungry\r\n        this.doOxygenHungry();\r\n        // Sounds\r\n        this.footsStep();\r\n\r\n        // Slow\r\n        this.moveSpeedDown =\r\n            (this.checkItemInInventory(\"raw-nerius\") ? 2 : 0) +\r\n            (this.checkItemInInventory(\"ready-cidium\") ? -2 : 0);\r\n        \r\n        // Dig\r\n        this.digging();\r\n\r\n        //\r\n        this.damageAnimatedOpacity = lerp(this.damageAnimatedOpacity, 0, .05);\r\n    }\r\n    render() {\r\n        super.render();\r\n        \r\n        this.renderUI();\r\n    }\r\n    \r\n    changeActionType() {\r\n        if (this.game.tick(40))\r\n            this.expectedActionType = null;\r\n        \r\n        if (this.expectedActionType) {\r\n            if (this.actionType) {\r\n                if (this.expectedActionType.name != this.actionType?.name && this.actionType.priority < this.expectedActionType.priority)\r\n                    this.actionType = this.expectedActionType;\r\n            } else {\r\n                this.actionType = this.expectedActionType;\r\n            }\r\n        } else\r\n            this.actionType = null;\r\n\r\n    }\r\n    pickup(item: ItemParent, type: string, count: number) {\r\n        this.inventory.slots[type] = this.inventory.slots[type] || { count: 0, instances: [] };\r\n        this.inventory.slots[type].count += count;\r\n        const instances = this.inventory.slots[type].instances;\r\n        this.inventory.slots[type].instances.push(item);\r\n            \r\n        this.inventory.slots[type].instances = instances.filter((i, index)=> instances.indexOf(i) == index);\r\n\r\n        this.calculateTotalCount()\r\n    }\r\n    calculateTotalCount() {\r\n        this.inventory.totalCount = 0;\r\n\r\n        this.getInventorySlotNames().map(slotName=> {\r\n\r\n            this.inventory.totalCount += this.inventory.slots[slotName].count;\r\n\r\n        });\r\n\r\n        this.saveData();\r\n    }\r\n    pullWire() {\r\n        \r\n        if (this.position.distance(this.wire) > Config.WIRE_LENGTH) {\r\n            this.wire.copy(this.wire.add(this.position.sub(this.wire).normalize().mul(this.moveSpeed - this.moveSpeedDown)));\r\n        }\r\n\r\n    }\r\n    hit(damage: number) {\r\n        if (!this.damaged) {\r\n\r\n            this.damageAnimatedOpacity = 1.5;\r\n            this.game.camera.shake();\r\n            this.sound.play(this.game, chance(1) ? \"bonk\" : \"hit\");\r\n\r\n            this.saveData();\r\n        }\r\n        super.hit(damage);\r\n        \r\n        if (this.hp <= 0)\r\n            this.die();\r\n    }\r\n    die() {\r\n        if (this.dead) return;\r\n        \r\n        this.frame.x = 0;\r\n        this.tries --;\r\n        this.oxygenHungry = false;\r\n        this.oxygenHungryTimer.reset();\r\n        this.animatedDieUI = -6;\r\n        this.allowMove = false;\r\n        \r\n        super.die();\r\n        this.saveData();\r\n    }\r\n    respawn() {\r\n        if (this.oxygenGenerator.oxygenLevel <= 10) {\r\n            this.oxygenGenerator.oxygenLevel += 30;\r\n            this.oxygenGenerator.batteryLevel += 80;\r\n        }\r\n        this.respawnTimer.reset();\r\n        this.hp = 12;\r\n        this.frame.x = 5;\r\n        this.interest = false;\r\n        this.dead = false;\r\n        this.regaining = true;\r\n        // this.allowMove = true;\r\n        this.position.copy(this.startPosition);\r\n        this.game.camera.position.copy(this.position);\r\n\r\n        this.saveData();\r\n    }\r\n    gameOver() {\r\n        this.game.clearAllKeys();\r\n\r\n        this.oxygenGenerator.reset();\r\n        this.storage.reset();\r\n        this.recycler.reset();\r\n        this.game.generator.reset();\r\n        this.reset();\r\n    }\r\n    heal(heal: number) {\r\n        if (this.hp >= 12) return\r\n        \r\n        this.hp += heal;\r\n        this.hp = clamp(this.hp, 0, 12);\r\n        this.spawnText(`+${ heal }`, undefined, Color.GREEN);\r\n\r\n        this.saveData();\r\n    }\r\n\r\n    digging() {\r\n        const tool = tools[this.toolLevel.toString()];\r\n\r\n        if (this.movement.x != 0)\r\n            this.dig(tool.damage, tool.speed, this.toolLevel, this.movement.x > 0 ? \"right\" : \"left\");\r\n        else if (this.movement.y != 0)\r\n            this.dig(tool.damage, tool.speed, this.toolLevel, this.movement.y > 0 ? \"bottom\" : \"top\");\r\n    }\r\n    upgradeTool(levelUp: number) {\r\n        if (this.toolLevel < MaxToolLevel)\r\n            this.toolLevel += levelUp;\r\n\r\n        this.saveData();\r\n    }\r\n    placeRobot() {\r\n        if (this.checkItemInInventory(\"item-robot\")) {\r\n        \r\n            // Sub. robots count in inventory\r\n            this.inventory.slots[\"item-robot\"].count --;\r\n\r\n            // Remove robot inventory instance\r\n            this.game.removeChildById(this.inventory.slots[\"item-robot\"].instances[0].id);\r\n            this.inventory.slots[\"item-robot\"].instances.splice(0, 1);\r\n            this.calculateTotalCount()\r\n\r\n        }\r\n        \r\n        // Place robot\r\n        this.game.add(new Robot(this.position.div(Config.SPRITE_SIZE).add(Vector2.all(.5)).apply(Math.floor).mul(Config.SPRITE_SIZE)));\r\n        this.game.initChildren();\r\n\r\n        this.saveData();\r\n    }\r\n    foldItemsTo(slotName: string, count: number, position: Vector2) {\r\n\r\n        const slotInstances = this.inventory.slots[slotName].instances.filter(item=> this.game.children.indexOf(item) >= 0 && item.picked);\r\n            \r\n        for (let i = 0; i < count; i ++) {\r\n            if (slotInstances[i] && slotInstances[i].picked) {\r\n                slotInstances[i].allowPickup = false;\r\n                slotInstances[i].picked = false;\r\n                slotInstances[i].foldToPosition = position;\r\n            }\r\n        }\r\n        this.inventory.slots[slotName].instances.splice(0, count);\r\n\r\n        this.inventory.slots[slotName].count -= count;\r\n        this.calculateTotalCount();\r\n\r\n    }\r\n    useFood() {\r\n        if (this.allowEatFood) {\r\n\r\n            const foodSlotNames = this.getInventorySlotNames().filter(slotName=> slotName.indexOf(\"food\") >= 0);\r\n            (this.inventory.slots[foodSlotNames[0]].instances[0] as Food).onEat(this);\r\n            this.game.removeChildById(this.inventory.slots[foodSlotNames[0]].instances[0].id);\r\n            this.inventory.slots[foodSlotNames[0]].count --;\r\n            this.inventory.slots[foodSlotNames[0]].instances.splice(0, 1);\r\n\r\n        }\r\n    }\r\n    doOxygenHungry() {\r\n        if (this.dead) return;\r\n        \r\n        if (this.oxygenGenerator.oxygenLevel <= 0) {\r\n            this.oxygenHungryTimer.start(this.game.clock.elapsed);\r\n            this.oxygenHungry = true;\r\n        }\r\n        if (this.oxygenHungry) {\r\n            if (this.oxygenHungryTimer.isTriggered())\r\n                this.die();\r\n        }\r\n    }\r\n\r\n    // > Render\r\n    renderUI() {\r\n        \r\n        if (this.dead && this.respawnTimer.started) this.renderDieUI();\r\n        \r\n        if (this.game.paused) return;\r\n\r\n        const size = Config.SPRITE_SIZE;\r\n        const windowCenter = new Vector2(innerWidth / 2, innerHeight / 2);\r\n        \r\n        if (this.oxygenHungry) this.renderOxygenHungryUI();\r\n        this.renderHealthUI();\r\n        \r\n        // Tip text\r\n        if(this.actionType && this.actionText[this.actionType.name])\r\n            this.game.renderer.drawText({\r\n                text: `[OK] - ${ this.actionText[this.actionType.name] }`,\r\n                position: new Vector2(0, 150).add(windowCenter),\r\n                layer: \"ui\"\r\n            });\r\n        \r\n        // Tool level\r\n        this.game.renderer.drawSprite({\r\n            texture: asImage(this.game.getAssetByName(\"tools\")),\r\n            position: new Vector2(size, innerHeight - size),\r\n            layer: \"ui\"\r\n        });\r\n        this.game.renderer.drawText({\r\n            text: this.toolLevel + \"ур.\",\r\n            position: new Vector2(size, innerHeight - size).add(Vector2.all(size * .3)),\r\n            font: \"22px Pixel\",\r\n            layer: \"ui\"\r\n        });\r\n\r\n        // Bottle\r\n        if (this.hasBottle)\r\n            this.game.renderer.drawSprite({\r\n                texture: asImage(this.game.getAssetByName(\"bottle\")),\r\n                position: new Vector2(size * 2 + 20, innerHeight - size),\r\n                layer: \"ui\"\r\n            })\r\n\r\n        // Damage vignette\r\n        this.game.renderer.drawSprite({\r\n            texture: asImage(this.game.getAssetByName(\"damage\")),\r\n            width: innerWidth / Config.SPRITE_SIZE,\r\n            height: innerHeight / Config.SPRITE_SIZE,\r\n            position: new Vector2(innerWidth / 2, innerHeight / 2),\r\n            layer: \"ui\",\r\n            framed: false,\r\n            opacity: this.damageAnimatedOpacity\r\n        });\r\n    }\r\n\r\n    renderDieUI() {\r\n        const size = Config.SPRITE_SIZE;\r\n        const windowCenter = new Vector2(innerWidth / 2, innerHeight / 2);\r\n\r\n        // this.animatedDieUI = 10;\r\n        this.animatedDieUI = clamp(lerp(this.animatedDieUI, 4, .005), 0, 4);\r\n\r\n        // BG\r\n        this.game.renderer.drawRect({\r\n            color: \"#000\",\r\n            width: innerWidth / size,\r\n            height: innerHeight / size,\r\n            position: windowCenter,\r\n            layer: \"upper-ui\",\r\n            opacity: clamp(this.animatedDieUI, .5, 1.5) - .5\r\n        });\r\n\r\n        // Texts\r\n        this.game.renderer.drawText({\r\n            text: this.tries > 0 ? \"Все совершают ошибки...\" : \"Все совершают ошибки, на которые нужен шанс...\",\r\n            font: \"34px Pixel\",\r\n            opacity: clamp(this.animatedDieUI, 1, 2) - 1,\r\n            stroke: { width: 0, color: \"#000\" },\r\n            position: new Vector2().add(windowCenter),\r\n            layer: \"upper-ui\"\r\n        })\r\n        this.game.renderer.drawText({\r\n            text: this.tries > 0 ? \"Последний шанс, чтобы их исправить\" : \"Шанс, который вы упустили\",\r\n            opacity: clamp(this.animatedDieUI, 1.5, 2.5) - 1.5,\r\n            stroke: { width: 0, color: \"#000\" },\r\n            position: new Vector2(0, 30).add(windowCenter),\r\n            layer: \"upper-ui\"\r\n        });\r\n        this.game.renderer.drawText({\r\n            text: this.tries > 0 ? `Тебя приведут в сознание через:\\n0:${ this.respawnTimer.elapsedSeconds }` : `Тебя заменит другой доброволец через:\\n0:${ this.respawnTimer.elapsedSeconds }`,\r\n            opacity: clamp(this.animatedDieUI, 2.5, 3.5) - 2.5,\r\n            stroke: { width: 0, color: \"#000\" },\r\n            position: new Vector2(0, 80).add(windowCenter),\r\n            layer: \"upper-ui\"\r\n        });\r\n    \r\n    }\r\n    renderHealthUI() {\r\n        const size = Config.SPRITE_SIZE;\r\n        \r\n        for (let i = 0; i < 4; i ++) {\r\n            let frame = 0;\r\n\r\n            if (\r\n                (i == 0 && this.hp <= 11) ||\r\n                (i == 1 && this.hp <= 8) ||\r\n                (i == 2 && this.hp <= 5) ||\r\n                (i == 3 && this.hp <= 1)\r\n            )\r\n                frame = 1;\r\n            if (\r\n                (i == 0 && this.hp <= 9) ||\r\n                (i == 1 && this.hp <= 6) ||\r\n                (i == 2 && this.hp <= 3) ||\r\n                (i == 3 && this.hp <= 0)\r\n            )\r\n                frame = 2;\r\n\r\n            const sine = Math.sin(this.game.clock.elapsed / 10 + i) * 2 * frame;\r\n            \r\n            this.game.renderer.drawSprite({\r\n                texture: asImage(this.game.getAssetByName(\"health\")),\r\n                frame: new Vector2(frame),\r\n                scale: Vector2.all(.8),\r\n                position: new Vector2(innerWidth - size - i * size * .6, innerHeight - size + sine),\r\n                layer: \"ui\"\r\n            });\r\n        }\r\n\r\n    }\r\n    renderOxygenHungryUI() {\r\n        this.animatedTimerScale = lerp(this.animatedTimerScale, 1, .2);\r\n        if (this.oxygenHungryTimer.elapsed / 60 % 1 == 0)\r\n            this.animatedTimerScale = this.oxygenHungryTimer.elapsedSeconds < 20 ? 1.5 : 1.2\r\n        \r\n        this.game.renderer.drawText({\r\n            text: \"Кислородное голодание!\",\r\n            position: new Vector2(innerWidth/2, 100),\r\n            font: \"24px Pixel\",\r\n            layer: \"upper-ui\"\r\n        });\r\n        this.game.renderer.drawText({\r\n            text: `Вы потеряете сознание через:`,\r\n            position: new Vector2(innerWidth/2, 130),\r\n            layer: \"upper-ui\"\r\n        });\r\n        this.game.renderer.drawText({\r\n            text: `0:${ Math.floor(this.oxygenHungryTimer.elapsedSeconds) }`,\r\n            position: new Vector2(innerWidth/2, 180),\r\n            scale: Vector2.all(this.animatedTimerScale),\r\n            font: \"30px Pixel\",\r\n            layer: \"upper-ui\"\r\n        });\r\n        \r\n    }\r\n\r\n    footsStep() {\r\n\r\n        const allow = \r\n            (this.velocity.x > 0 && !this.collider.collidesWith?.right) ||\r\n            (this.velocity.x < 0 && !this.collider.collidesWith?.left) ||\r\n            (this.velocity.y < 0 && !this.collider.collidesWith?.top) ||\r\n            (this.velocity.y > 0 && !this.collider.collidesWith?.bottom)\r\n\r\n        if (this.game.clock.elapsed % 20 == 0 && allow)\r\n            this.sound.play(this.game, `step-${ Math.floor(random(1, 4)) }`, .3)\r\n\r\n    }\r\n\r\n    getInventorySlotNames(): string[] {\r\n        return Object.keys(this.inventory.slots);\r\n    }\r\n    checkItemInInventory(name: string) {\r\n        return this.inventory.slots[name] && this.inventory.slots[name].count > 0;\r\n    }\r\n    saveData() {\r\n        this.game.saveKey(\"tries\", this.tries.toString());\r\n        this.game.saveKey(\"player-hp\", this.hp.toString());\r\n        this.game.saveKey(\"player-toolLevel\", this.toolLevel.toString());\r\n    }\r\n    reset() {\r\n        this.toolLevel = 1;\r\n        [...this.game.getChildrenByName<ItemParent>(\"ore\"), ...this.game.getChildrenByName<ItemParent>(\"item\")].map(child=> {\r\n            this.game.removeChildById(child.id);\r\n        })\r\n    }\r\n}","import { Config } from \"../config\";\r\nimport { Game } from \"../engine\";\r\nimport { asImage, clamp, Vector2 } from \"../engine/utils/math\";\r\n\r\nexport function initLevel(game: Game) {\r\n\r\n    function render() {\r\n\r\n        const op = (1 - game.camera.position.y / 240) * .3;\r\n        \r\n        for (let i = 0; i < Config.WORLD_WIDTH; i ++)\r\n            game.renderer.drawSprite({\r\n                width: 4,\r\n                height: 4,\r\n                frame: new Vector2(i % 2, 0),\r\n                texture: asImage(game.getAssetByName(\"ground\")),\r\n                position: new Vector2(-Config.SPRITE_SIZE * 10 + (i * Config.SPRITE_SIZE * 4), -Config.SPRITE_SIZE * .5 * 3),\r\n                opacity: clamp(op, 0, 1),\r\n                layer: \"bg\"\r\n            })\r\n\r\n    }\r\n\r\n    return { render };\r\n\r\n}","import { buildName } from \"./engine/utils/math\";\r\n\r\ntype NamesType = {\r\n    [name: string]: {\r\n        name: string\r\n        desc: string\r\n        special?: string[] \r\n    }\r\n}\r\n\r\nconst prefixes = {\r\n    raw: \"Необработанный\",\r\n    ready: \"Обработанный\",\r\n}\r\n\r\nexport const ObjectNames: NamesType = {\r\n    \"basics\": {\r\n        name: \"Базовые знания\",\r\n        desc: \"\",\r\n        special: [\r\n            \"> Тебе достатачно подойти к руде,\\nчтобы сломать её\",\r\n            \"> Следите за запасом кислорода!\\nИ не забывайте заряжать генератор\\nпри помощи батареи\",\r\n            \"> Остерегайтесь обрушений!\",\r\n            \"> Следите за запасом здоровья.\\nЧтобы вылечится достаточно съесть\\nисцеляющий фрукт\"\r\n        ],\r\n    },\r\n    \r\n    // Raw\r\n    \"raw-cidium\": {\r\n        name: buildName(prefixes.raw, \"цидиум\"),\r\n        desc: \"Жёлтая руда, которая непонятным образом выделяет энергию, если её правильно обработать. При этом её очень легко найти\",\r\n    },\r\n    \"raw-osmy\": {\r\n        name: buildName(prefixes.raw, \"осмий\"),\r\n        desc: \"Осмий, кристалы, которые также есть и на земле. Казалось бы, ничего интересного, но вместе с цидиумом, осмий будет очень полезен\",\r\n    },\r\n    \"raw-grade-cidium\": {\r\n        name: buildName(prefixes.raw, \"второсортный цидиум\"),\r\n        desc: \"Цидиум 2-го сорта, руда, иногда встречающаяся вместе с осмием. Выделяет менее сильную энергию, чем цидиум\",\r\n    },\r\n    \"raw-antin\": {\r\n        name: buildName(prefixes.raw, \"антин\"),\r\n        desc: \"Антин, крайне странная руда, имеющая красный оттенок. Предположительно кристалы, которые миллионы лет назад из-за вулканической активности. Не зря они расположены ближе к мантии\",\r\n    },\r\n    \"raw-rady\": {\r\n        name: buildName(prefixes.raw, \"радий\"),\r\n        desc: \"Радий... Нам не удалось его подробно изучить. Известно только, то что он очень глубоко под землёй и излучает радиационный фон до 67.2 мк/ч, что выше нормы в 4 раза\",\r\n        special: [\"> Требуется специальная колба для сбора!\"]\r\n    },\r\n    \"raw-nerius\": {\r\n        name: buildName(prefixes.raw, \"нериус\"),\r\n        desc: \"Нериус, невероятно плотная руда, что значит она ещё и очень тяжёлая. 1см² весит около 300 грамм\",\r\n        special: [\"> Довольно сильно замедляет вас!\"]\r\n    },\r\n    \"raw-manty\": {\r\n        name: \"Мантий\",\r\n        desc: \"Мантий... Это то, для чего ты здесь. Но будь осторожен, он очень горячий, до 1200 С°\",\r\n        special: [\"> Требуется специальная колба для сбора!\"]\r\n    },\r\n\r\n    // Ready\r\n    \"ready-cidium\": {\r\n        name: buildName(prefixes.ready, \"цидиум\"),\r\n        desc: \"Обработанный цидиум, способен генерировать энегрию. Используется в создании батареи и других крафтов\"\r\n    },\r\n\r\n    // Recipes\r\n    \"recipe-storage-level-up\": {\r\n        name: \"Улучшить хранилище\",\r\n        desc: \"Улучшите своё хранилище для того, чтобы можно было хранить больше ресурсов и их типов.\"\r\n    },\r\n    \"recipe-tool-level-up\": {\r\n        name: \"Улучшить инструмент\",\r\n        desc: \"Для того чтобы быстрее ломать руду прокачайте свой инструмент. Более новые уровни инструмента позволяют добывать больше типов руд\"\r\n    },\r\n\r\n    // Items\r\n    \"bottle\": {\r\n        name: \"\\\"Специальная колба\\\"\",\r\n        desc: \"Колба для сбора особо опасных руд. На пример таких, как радий\"\r\n    },\r\n    \"battery\": {\r\n        name: \"Батарея\",\r\n        desc: \"Да будет свет! При помощи него можно зарядить генератор\"\r\n    },\r\n    \"drill\": {\r\n        name: \"Бур\",\r\n        desc: \"Изпользуется в квафте чего-либо\"\r\n    },\r\n    \"box\": {\r\n        name: \"Корпус\",\r\n        desc: \"Прочный корпус из нериуса. Из него можно что-нибудь соорудить\"\r\n    },\r\n    \"card\": {\r\n        name: \"Плата\",\r\n        desc: \"Умная плата для роботов\"\r\n    },\r\n    \"item-robot\": {\r\n        name: \"Робот\",\r\n        desc: \"Ваш лисный робот-компаньон. Копает небольшой тунель вниз. Безсилен против базальта\"\r\n    },\r\n\r\n    // Food\r\n    \"food-fetus\": {\r\n        name: \"Исцеляющий плод\",\r\n        desc: \"Сладкий плод цветущей лозы, востонавливает запас крови\"\r\n    },\r\n\r\n    // Gear\r\n    \"gear-storage\": {\r\n        name: \"Хранилище\",\r\n        desc: \"\"\r\n    },\r\n    \"gear-recycler\": {\r\n        name: \"Переработчик\",\r\n        desc: \"\"\r\n    },\r\n    \"gear-upgrader\": {\r\n        name: \"Улучшатель\",\r\n        desc: \"\"\r\n    },\r\n    \"gear-oxygen-generator\": {\r\n        name: \"Генератор кислорода\",\r\n        desc: \"\"\r\n    },\r\n    \"gear-documentation\": {\r\n        name: \"Справочник добровольца\",\r\n        desc: \"\"\r\n    },\r\n}","import { Config } from \"../../config\";\r\nimport { ISpriteProps, Sprite } from \"../../engine\";\r\nimport { Sound } from \"../../engine/components/Sound\";\r\nimport { SpawnParticles } from \"../../engine/components/Particles\";\r\nimport { UI, Button } from \"../../engine/components/UI\";\r\nimport { asImage, Vector2 } from \"../../engine/utils/math\";\r\nimport { ObjectNames } from \"../../names\";\r\nimport { Player } from \"../entities/Player\";\r\n\r\nexport type GearType = \r\n    \"gear-storage\" | \"gear-recycler\" | \"gear-upgrader\" | \"gear-oxygen-generator\" |\r\n    \"gear-documentation\";\r\nexport type GearLevel = 1 | 2 | 3;\r\nexport const MaxGearLevel = 3;\r\n\r\nexport class Gear extends Sprite {\r\n    sound: Sound\r\n    ui: UI\r\n    interactButton: Button\r\n    player: Player | undefined\r\n\r\n    maxRowItemsCount: number\r\n    gearType: GearType;\r\n    level: GearLevel\r\n    playerIsNear: boolean\r\n    allowInteract: boolean\r\n    allowActionButton: boolean\r\n    actionButtonAssetName: string\r\n\r\n    headerOffset: Vector2\r\n    interactText: string\r\n    tipText: string\r\n    \r\n    constructor(type: GearType, level: GearLevel, props?: ISpriteProps) {\r\n        super(type, [type, 1].join(\"-\"), {\r\n            layer: \"game\",\r\n            colliderType: \"none\",\r\n            ...props\r\n        });\r\n\r\n        this.width = \r\n        this.height = 2;\r\n\r\n        this.sound = new Sound();\r\n        this.ui = new UI();\r\n        this.interactButton = new Button();\r\n        this.player = undefined;\r\n        \r\n        this.maxRowItemsCount = 5;\r\n        this.gearType = type;\r\n        this.level = level;\r\n        this.playerIsNear = false;\r\n        this.allowInteract = true;\r\n        this.allowActionButton = true;\r\n        this.actionButtonAssetName = \"close\";\r\n\r\n        this.headerOffset = new Vector2();\r\n        this.interactText = \"\";\r\n        this.tipText = \"закрыть\";\r\n    }\r\n\r\n    init() {\r\n        super.init();\r\n\r\n        this.ui.init(this.game);\r\n        this.ui.enabled = false;\r\n        this.player = this.game.getChildById(\"player\");\r\n\r\n        this.game.gamepad.onKeyDown(this.id, \"enter\", ()=> {\r\n            if (!this.playerIsNear) return;\r\n\r\n            if (this.ui.enabled)\r\n                this.onUIAction();\r\n            \r\n            if (this.player)\r\n                this.onInteract();\r\n        });\r\n    }\r\n\r\n    update() {\r\n        super.update();\r\n\r\n        if (this.game.paused)\r\n            this.ui.enabled = false;\r\n            \r\n        this.checkInteract();\r\n    }\r\n\r\n    render() {\r\n        super.render();\r\n\r\n        this.renderUI();\r\n        this.renderOutline();\r\n        if (this.allowActionButton)\r\n            this.renderActionButton();\r\n    }\r\n    renderUI() {\r\n        this.ui.render();\r\n\r\n        if (this.ui.enabled) {\r\n            const size = Config.SPRITE_SIZE;\r\n            const windowCenter = new Vector2(innerWidth / 2, innerHeight / 2).apply(Math.floor);\r\n\r\n            // Background\r\n            this.ui.rect({\r\n                color: \"rgba(0, 0, 0, .6)\",\r\n                width: innerWidth / Config.SPRITE_SIZE,\r\n                height: innerHeight / Config.SPRITE_SIZE,\r\n                position: new Vector2(innerWidth / 2, innerHeight / 2),\r\n            });\r\n\r\n            // Container\r\n            this.ui.sprite([this.gearType.replace(\"gear-\", \"\"), \"ui\"].join(\"-\"), {\r\n                position: new Vector2(0, -size).add(windowCenter),\r\n                width: 7,\r\n                height: 5,\r\n            });\r\n            // Title\r\n            this.ui.text(`${ ObjectNames[this.name].name } ${ this.level }ур.`, {\r\n                position: new Vector2(-size*2.25, -size - 15).add(windowCenter).add(this.headerOffset),\r\n                align: \"left\",\r\n            });\r\n            // Tip text\r\n            this.ui.text(`[OK] - ${ this.tipText }`, {\r\n                position: new Vector2(-size * 3 + 20, -size * 2 - 40).add(windowCenter).add(this.headerOffset),\r\n                align: \"left\"\r\n            })\r\n\r\n        }\r\n        \r\n        // Draw interact button\r\n        if (this.playerIsNear && !this.ui.enabled) {\r\n            this.interactButton.position = this.position.add(new Vector2(0, -10 - this.height * 50));\r\n            this.interactButton.render(this.game);\r\n        }\r\n    }\r\n    renderOutline() {\r\n        if (this.playerIsNear && this.allowInteract) {\r\n            // Draw gear outline\r\n            this.game.renderer.drawSprite({\r\n                texture: asImage(this.game.getAssetByName([this.gearType, 1, \"outline\"].join(\"-\"))),\r\n                width: this.width, height: this.height,\r\n                position: this.position,\r\n                layer: this.layer,\r\n                flip: this.flip\r\n            });\r\n\r\n            // Interact text\r\n            this.game.renderer.drawText({\r\n                text: this.interactText,\r\n                font: \"22px Pixel\",\r\n                position: this.position.add(new Vector2(0, -70)),\r\n                layer: \"game-ui\"\r\n            });\r\n                \r\n        }\r\n    }\r\n    renderActionButton() {\r\n        const size = Config.SPRITE_SIZE;\r\n            const windowCenter = new Vector2(innerWidth / 2, innerHeight / 2).apply(Math.floor);\r\n\r\n        const pos = new Vector2(size*2, -size - 20).add(windowCenter).add(this.headerOffset);\r\n        this.ui.renderFocusable(pos.add(new Vector2(-2, 2)), 0, 0, ()=> {\r\n\r\n            this.ui.sprite(this.actionButtonAssetName, {\r\n                position: pos,\r\n            });\r\n\r\n        }, 14 / Config.SPRITE_PIXEL_SIZE);\r\n\r\n    }\r\n\r\n    upgrade(levelUp: number) {\r\n        if (this.level < MaxGearLevel) {\r\n            this.level += levelUp;\r\n\r\n            SpawnParticles(this.game, this.position, {\r\n                render: (renderer, part)=> {\r\n                    renderer.drawSprite({\r\n                        texture: asImage(this.game.getAssetByName(\"level-up\")),\r\n                        position: part.position,\r\n                        opacity: part.size,\r\n                        scale: Vector2.all(.8),\r\n                        layer: \"particles\"\r\n                    })\r\n                },\r\n                velocity: ()=> new Vector2(0, -1.5),\r\n                size: [5, 5],\r\n                downSize: .08,\r\n                count: 1,\r\n                gravity: 0\r\n            });\r\n        }\r\n    }\r\n    checkInteract() {\r\n        if (!this.player) return;\r\n\r\n        this.playerIsNear =\r\n            this.player.position.distance(this.position) < Config.GEAR_INTERACT_DISTANCE &&\r\n            ((this.player.position.x > this.position.x && this.player.flip.x) || (this.player.position.x < this.position.x && !this.player.flip.x));\r\n        if (this.playerIsNear) {\r\n            if (!this.player.dead)\r\n                this.player.allowMove = !this.ui.enabled;\r\n            else\r\n                this.ui.enabled = false;\r\n        }\r\n    }\r\n\r\n    onInteract() {\r\n        this.interactButton.click();\r\n    }\r\n    onUIAction() {\r\n        \r\n    }\r\n    saveData() {}\r\n    reset() {\r\n        this.level = 1;\r\n        this.saveData();\r\n    }\r\n    \r\n}","import { Config, OreSettings } from \"../../config\";\r\nimport { ISpriteProps } from \"../../engine\";\r\nimport { asImage, clamp, Vector2 } from \"../../engine/utils/math\";\r\nimport { ObjectNames } from \"../../names\";\r\nimport { Gear } from \"./Gear\";\r\n\r\nexport class Documentation extends Gear {\r\n    constructor(props?: ISpriteProps) {\r\n        super(\"gear-documentation\", 1, props);\r\n\r\n        this.width = 1;\r\n        this.height = 1;\r\n        this.allowActionButton = false;\r\n    }\r\n\r\n    renderUI() {\r\n        super.renderUI();\r\n\r\n        if (!this.ui.enabled) return;\r\n\r\n        const objectNames = Object.keys(ObjectNames).filter(name=> (name.indexOf(\"gear\") < 0 && name.indexOf(\"recipe\") < 0));\r\n        this.ui.updateTemplate([\r\n            objectNames.length\r\n        ]);\r\n            \r\n        this.renderObjectsCatalogUI(objectNames);\r\n        \r\n        const name = objectNames[this.ui.focused.slot];\r\n        const itemSettings = ObjectNames[name];\r\n        if (!itemSettings) return;\r\n        \r\n        const oreSettings = OreSettings[name.replace(\"raw-\", \"\")];\r\n        const special = oreSettings ? [\r\n            oreSettings ? `> Нужен инструмент ${ oreSettings.tool || 1 }ур. и выше` : \"> Можно найти\",\r\n            ...itemSettings.special || \"\"\r\n        ].filter(t=> t != \"\") : null;\r\n        const itemSpecial = itemSettings ? [\r\n            ...itemSettings.special || \"\"\r\n        ].filter(t=> t != \"\") : [];\r\n\r\n        // Render description\r\n        this.ui.renderDescriptionUI({\r\n            title: itemSettings.name,\r\n            specials: special || itemSpecial,\r\n            description: itemSettings.desc, \r\n            renderIcon: (pos)=> {\r\n                this.game.renderer.drawSprite({\r\n                    texture: asImage(this.game.getAssetByName(name)),\r\n                    position: pos,\r\n                    layer: \"ui\"\r\n                });\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    renderObjectsCatalogUI(objectNames: string[]) {\r\n        const size = Config.SPRITE_SIZE;\r\n        const windowCenter = new Vector2(innerWidth / 2, innerHeight / 2).apply(Math.floor);\r\n\r\n        objectNames.map((objectName, index)=> {\r\n\r\n            const slot = this.ui.focused.slot >= this.maxRowItemsCount ? this.ui.focused.slot : 0;\r\n\r\n            const pos = new Vector2(\r\n                index * size - Math.floor(this.maxRowItemsCount / 2)*size - slot*size,\r\n                0\r\n            ).add(windowCenter);\r\n                \r\n            if (index - slot < this.maxRowItemsCount && index+1 > slot)\r\n            this.ui.renderFocusable(pos, 0, index, ()=> {\r\n\r\n                this.game.renderer.drawSprite({\r\n                    texture: asImage(this.game.getAssetByName(objectName)),\r\n                    framed: false,\r\n                    position: pos,\r\n                    layer: \"ui\"\r\n                })\r\n\r\n            });\r\n\r\n        });\r\n        \r\n    }\r\n\r\n    onInteract() {\r\n        super.onInteract();\r\n        \r\n        this.ui.enabled = !this.ui.enabled;\r\n    }\r\n}","import { Color, Config } from \"../../config\";\r\nimport { ISpriteProps } from \"../../engine\";\r\nimport { clamp, lerp, random, randomInt, Vector2 } from \"../../engine/utils/math\";\r\nimport { Gear } from \"./Gear\";\r\n\r\nexport class OxygenGenerator extends Gear {\r\n    startPosition: Vector2\r\n    \r\n    oxygenLevel: number\r\n    batteryLevel: number\r\n    animatedOxygenLevel: number\r\n    animatedBatteryLevel: number\r\n    playerWithBattery: boolean\r\n    \r\n    constructor(props?: ISpriteProps) {\r\n        super(\"gear-oxygen-generator\", 1, props);\r\n\r\n        this.startPosition = this.position.expand();\r\n        \r\n        if (Config.TEST_GEARS) {\r\n            this.oxygenLevel = 100;\r\n            this.batteryLevel = 100;\r\n        } else {\r\n            this.oxygenLevel = 100;\r\n            this.batteryLevel = 100;\r\n        }\r\n        this.animatedOxygenLevel = 100;\r\n        this.animatedBatteryLevel = 100;\r\n        this.playerWithBattery = false;\r\n        this.allowActionButton = false;\r\n\r\n        this.headerOffset.set(0, -Config.SPRITE_SIZE / 2 - 15);\r\n\r\n    }\r\n\r\n    init() {\r\n        super.init();\r\n        if (Config.IS_DEV) return;\r\n\r\n        this.batteryLevel = this.game.loadKey(\"generator-batteryLevel\", 100);\r\n        this.oxygenLevel = this.game.loadKey(\"generator-oxygenLevel\", 100);\r\n    }\r\n    update() {\r\n        super.update();\r\n        if (this.game.paused) return;\r\n        \r\n        this.work();        \r\n        this.checkBattery();\r\n\r\n        if (this.oxygenLevel <= 50 || this.batteryLevel <= 10) {\r\n            // Shake\r\n            this.position.copy(this.startPosition.add(new Vector2(random(-1, 1), random(-1, 1))))\r\n        } else {\r\n            this.position.lerp(this.startPosition, .3);\r\n        }\r\n\r\n        this.animatedOxygenLevel = lerp(this.animatedOxygenLevel, this.oxygenLevel, .2);\r\n        this.animatedBatteryLevel = lerp(this.animatedBatteryLevel, this.batteryLevel, .2);\r\n    }\r\n\r\n    render() {\r\n        super.render();\r\n        \r\n        this.frame = new Vector2(4 - clamp(Math.floor((this.batteryLevel + 20) / 25), 0, 4));\r\n        \r\n        if (this.playerIsNear)\r\n            this.renderBars();\r\n    }\r\n\r\n    onInteract() {\r\n        super.onInteract();\r\n\r\n        if (!this.playerWithBattery)\r\n            this.ui.enabled = !this.ui.enabled;\r\n        else {\r\n            if (!this.player) return;\r\n\r\n            this.player.foldItemsTo(\"battery\", 1, this.position);\r\n            this.updateBatteryLevel(randomInt(50, 65));\r\n            this.updateOxygenLevel(randomInt(10, 14));\r\n        }\r\n    }\r\n\r\n    work() {\r\n        // Remove oxygen\r\n        if (this.batteryLevel < 90) {\r\n            if (this.game.tick(this.batteryLevel > 20 ? Config.OXYGEN_GENERATOR_OXYGEN_DEFUSE_TICK : (this.batteryLevel <= 0 ? 20 : 60)) && this.oxygenLevel > 0)\r\n                this.updateOxygenLevel(-randomInt(1, 3));\r\n        } else {\r\n            if (this.game.tick(30))\r\n                this.updateOxygenLevel(randomInt(1, 3));\r\n        }\r\n        \r\n        // Remove battery\r\n        if (this.game.tick(Config.OXYGEN_GENERATOR_BATTERY_DEFUSE_TICK) && this.batteryLevel > 0) {\r\n            this.updateBatteryLevel(-clamp(randomInt(-2, 3), 1, 3));\r\n\r\n            // Add oxygen\r\n            if (this.batteryLevel > 20)\r\n                this.updateOxygenLevel(randomInt(0, 8));\r\n        }\r\n    }\r\n    updateBatteryLevel(value: number) {\r\n        this.batteryLevel += value;\r\n        this.batteryLevel = clamp(this.batteryLevel, 0, 100);\r\n        this.saveData();\r\n    }\r\n    updateOxygenLevel(value: number) {\r\n        this.oxygenLevel += value;\r\n        this.oxygenLevel = clamp(this.oxygenLevel, 0, 100);\r\n        this.saveData();\r\n    }\r\n    \r\n    renderUI() {\r\n        super.renderUI();\r\n        if (!this.ui.enabled) return;\r\n\r\n        const size = Config.SPRITE_SIZE;\r\n        const windowCenter = new Vector2(innerWidth / 2, innerHeight / 2).apply(Math.floor);\r\n\r\n        // > Names\r\n        this.game.renderer.drawText({\r\n            text: \"Кислород\",\r\n            position: new Vector2(size*1.3, -size).add(windowCenter),\r\n            layer: \"ui\",\r\n            align: \"left\"\r\n        });\r\n        this.game.renderer.drawText({\r\n            text: \"Батарея\",\r\n            position: new Vector2(size*1.3, 0).add(windowCenter),\r\n            layer: \"ui\",\r\n            align: \"left\"\r\n        });\r\n\r\n        // > Progresses\r\n        const oxygenProgress = (this.animatedOxygenLevel / 100);\r\n        const batteryProgress = (this.animatedBatteryLevel / 100);\r\n        \r\n        // Oxygen\r\n        this.game.renderer.drawRect({\r\n            width: 2.5 * oxygenProgress,\r\n            height: .3,\r\n            color: Color.BLUE,\r\n            position: new Vector2(-size + (size * 2.5 * oxygenProgress - size*2.5)/2, -size).add(windowCenter),\r\n            layer: \"ui\"\r\n        });\r\n        // Battery\r\n        this.game.renderer.drawRect({\r\n            width: 2.5 * batteryProgress,\r\n            height: .3,\r\n            color: Color.YELLOW,\r\n            position: new Vector2(-size + (size * 2.5 * batteryProgress - size*2.5)/2).add(windowCenter),\r\n            layer: \"ui\"\r\n        });\r\n\r\n        // > Percents\r\n        // Oxygen\r\n        this.game.renderer.drawText({\r\n            text: `${ this.oxygenLevel }%`,\r\n            position: new Vector2(-size*2.1, -size).add(windowCenter),\r\n            layer: \"ui\",\r\n            align: \"left\"\r\n        });\r\n        // Battery\r\n        this.game.renderer.drawText({\r\n            text: `${ this.batteryLevel }%`,\r\n            position: new Vector2(-size*2.1, 0).add(windowCenter),\r\n            layer: \"ui\",\r\n            align: \"left\"\r\n        });\r\n    }\r\n\r\n    renderBars() {\r\n        \r\n        // Oxygen text\r\n        this.game.renderer.drawText({\r\n            text: `${ this.oxygenLevel }%`,\r\n            position: this.position.add(new Vector2(-80, -65)),\r\n            layer: \"particles\"\r\n        })\r\n        // Battery text\r\n        this.game.renderer.drawText({\r\n            text: `${ this.batteryLevel }%`,\r\n            position: this.position.add(new Vector2(80, -65)),\r\n            layer: \"particles\"\r\n        })\r\n        \r\n        // Oxygen level\r\n        this.ui.renderProgressBar({\r\n            progress: this.animatedOxygenLevel / 100,\r\n            position: this.position.add(new Vector2(-80, 0)),\r\n            width: 10,\r\n            height: 80,\r\n            layer: \"particles\",\r\n            color: Color.BLUE,\r\n            strokeColor: Color.BLUE\r\n        });\r\n        // Battery level\r\n        this.ui.renderProgressBar({\r\n            progress: this.animatedBatteryLevel / 100,\r\n            position: this.position.add(new Vector2(80, 0)),\r\n            width: 10,\r\n            height: 80,\r\n            layer: \"particles\"\r\n        });\r\n        \r\n    }\r\n\r\n    checkBattery() {\r\n        if (!this.playerIsNear || !this.player || !this.player.checkItemInInventory(\"battery\")) {\r\n            this.interactText = \"\";\r\n            this.playerWithBattery = false;\r\n            return;\r\n        }\r\n        \r\n        this.playerWithBattery = true;\r\n        this.interactText = \"Зарядить\";\r\n\r\n    }\r\n\r\n    saveData() {\r\n        super.saveData();\r\n        this.game.saveKey(\"generator-oxygenLevel\", this.oxygenLevel.toString());\r\n        this.game.saveKey(\"generator-batteryLevel\", this.batteryLevel.toString());\r\n    }\r\n    reset(): void {\r\n        this.oxygenLevel = 100;\r\n        this.batteryLevel = 100;\r\n        \r\n        super.reset();\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { Player } from \"../entities/Player\";\r\nimport { ItemParent } from \"../item/ItemParent\";\r\n\r\nexport type FoodType =\r\n    \"food-fetus\";\r\n\r\nexport class Food extends ItemParent {\r\n    foodType: FoodType\r\n    \r\n    constructor(type: FoodType, position: Vector2) {\r\n        super(type, type, position);\r\n\r\n        this.radius = 2;\r\n        this.foodType = type;\r\n    }\r\n\r\n    onEat(player: Player) {\r\n        \r\n    }\r\n    whenPicked(player: Player) {\r\n        super.whenPicked(player);\r\n\r\n        if (player.hp < 12)\r\n            player.expectedActionType = { name: \"eat\", priority: 1 };\r\n    }\r\n}","import { randomInt, Vector2 } from \"../../engine/utils/math\";\r\nimport { Player } from \"../entities/Player\";\r\nimport { Food } from \"./Food\";\r\n\r\nexport class HealingFetus extends Food {\r\n    constructor(position: Vector2) {\r\n        super(\"food-fetus\", position);\r\n    }\r\n\r\n    onEat(player: Player) {\r\n        super.onEat(player);\r\n\r\n        player.heal(randomInt(1, 2));\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { Item } from \"./Item\";\r\n\r\nexport class Battery extends Item {\r\n    constructor(position: Vector2) {\r\n        super(\"battery\", position);\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { Item } from \"./Item\";\r\n\r\nexport class Box extends Item {\r\n    constructor(position: Vector2) {\r\n        super(\"box\", position);\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { Item } from \"./Item\";\r\n\r\nexport class Card extends Item {\r\n    constructor(position: Vector2) {\r\n        super(\"card\", position);\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { Item } from \"./Item\";\r\n\r\nexport class Drill extends Item {\r\n    constructor(position: Vector2) {\r\n        super(\"drill\", position)\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { ItemParent } from \"../item/ItemParent\";\r\n\r\nexport type RawType = \r\n    \"raw-cidium\" | \"raw-osmy\" | \"raw-grade-cidium\" | \"raw-antin\" |\r\n    \"raw-rady\" | \"raw-nerius\" | \"raw-manty\";\r\n\r\nexport class Raw extends ItemParent {\r\n    rawType: RawType\r\n    \r\n    constructor(type: RawType, position: Vector2) {\r\n        super(type, type, position);\r\n\r\n        this.rawType = type;\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { Raw } from \"./Raw\";\r\n\r\nexport class RawAntin extends Raw {\r\n    constructor(position: Vector2) {\r\n        super(\"raw-antin\", position);\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { Raw } from \"./Raw\";\r\n\r\nexport class RawCidium extends Raw {\r\n    constructor(position: Vector2) {\r\n        super(\"raw-cidium\", position);\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { Raw } from \"./Raw\";\r\n\r\nexport class RawGradeCidium extends Raw {\r\n    constructor(position: Vector2) {\r\n        super(\"raw-grade-cidium\", position);\r\n    }\r\n}","import { Game } from \"../../engine\";\r\nimport { random, Vector2 } from \"../../engine/utils/math\";\r\nimport { Player } from \"../entities/Player\";\r\nimport { Raw, RawType } from \"./Raw\";\r\n\r\nexport class DangerRaw extends Raw {\r\n    constructor(type: RawType, position: Vector2) {\r\n        super(type, position);\r\n    }\r\n\r\n    update() {\r\n        super.update();\r\n        \r\n        const player = this.game.getChildById<Player>(\"player\");\r\n        if (!player) return;\r\n        if (player.hasBottle) return;\r\n\r\n        // If is picked, player get damage (1-2)\r\n        if (this.game.clock.elapsed % 80 == 0 && this.picked)\r\n            player.hit(Math.floor(random(1, 3)));\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { DangerRaw } from \"./DangerRaw\";\r\n\r\nexport class RawManty extends DangerRaw {\r\n    constructor(position: Vector2) {\r\n        super(\"raw-manty\", position);\r\n    }\r\n}","import { Game } from \"../../engine\";\r\nimport { Vector2 } from \"../../engine/utils/math\";\r\nimport { Player } from \"../entities/Player\";\r\nimport { Raw } from \"./Raw\";\r\n\r\nexport class RawNerius extends Raw {\r\n    constructor(position: Vector2) {\r\n        super(\"raw-nerius\", position);\r\n    }\r\n\r\n    update(game: Game) {\r\n        super.update(game);\r\n\r\n        // const player = game.getChildById<Player>(\"player\");\r\n        // if (!player) return;\r\n\r\n        // player.moveSpeed = this.picked ? 2 : 5;\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { Raw } from \"./Raw\";\r\n\r\nexport class RawOsmy extends Raw {\r\n    constructor(position: Vector2) {\r\n        super(\"raw-osmy\", position);\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { DangerRaw } from \"./DangerRaw\";\r\n\r\nexport class RawRady extends DangerRaw {\r\n    constructor(position: Vector2) {\r\n        super(\"raw-rady\", position);\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { ItemParent } from \"../item/ItemParent\";\r\n\r\nexport type ReadyType = \"ready-cidium\";\r\n\r\nexport class Ready extends ItemParent {\r\n    readyType: ReadyType\r\n    \r\n    constructor(type: ReadyType, position: Vector2) {\r\n        super(type, type, position);\r\n\r\n        this.readyType = type;\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { Ready } from \"./Ready\";\r\n\r\nexport class ReadyCidium extends Ready {\r\n    constructor(position: Vector2) {\r\n        super(\"ready-cidium\", position);\r\n    }\r\n}","import { HealingFetus } from \"./objects/food/HealingFetus\";\r\nimport { Battery } from \"./objects/item/Battery\";\r\nimport { Box } from \"./objects/item/Box\";\r\nimport { Card } from \"./objects/item/Card\";\r\nimport { Drill } from \"./objects/item/Drill\";\r\nimport { RobotItem } from \"./objects/item/RobotItem\";\r\nimport { RawAntin } from \"./objects/raws/RawAntin\";\r\nimport { RawCidium } from \"./objects/raws/RawCidium\";\r\nimport { RawGradeCidium } from \"./objects/raws/RawGradeCidium\";\r\nimport { RawManty } from \"./objects/raws/RawManty\";\r\nimport { RawNerius } from \"./objects/raws/RawNerius\";\r\nimport { RawOsmy } from \"./objects/raws/RawOsmy\";\r\nimport { RawRady } from \"./objects/raws/RawRady\";\r\nimport { ReadyCidium } from \"./objects/ready/ReadyCidium\";\r\n\r\nexport const Items: { [key: string]: any }  = {\r\n    // Raws\r\n    \"raw-cidium\": RawCidium,\r\n    \"raw-osmy\": RawOsmy,\r\n    \"raw-grade-cidium\": RawGradeCidium,\r\n    \"raw-antin\": RawAntin,\r\n    \"raw-rady\": RawRady,\r\n    \"raw-nerius\": RawNerius,\r\n    \"raw-manty\": RawManty,\r\n    // Ready\r\n    \"ready-cidium\": ReadyCidium,\r\n    // Items\r\n    \"item-robot\": RobotItem,\r\n    \"battery\": Battery,\r\n    \"drill\": Drill,\r\n    \"box\": Box,\r\n    \"card\": Card,\r\n    // Food\r\n    \"food-fetus\": HealingFetus\r\n};","import { Config } from \"../../config\";\r\nimport { Game } from \"../../engine\";\r\nimport { asImage, Vector2 } from \"../../engine/utils/math\";\r\nimport { MaxToolLevel } from \"../entities/Player\";\r\nimport { RobotItem } from \"../item/RobotItem\";\r\nimport { MaxGearLevel } from \"./Gear\";\r\nimport { Recipe, Recycler } from \"./Recycler\";\r\n\r\nconst recipes = (recycler: Recycler)=> ({\r\n\r\n    // Craft ready cidium\r\n    \"ready-cidium\": new Recipe({\r\n        recipe: ()=> ({\r\n            \"raw-cidium\": { count: 2 },\r\n        }),\r\n    }),\r\n\r\n    // Craft battery\r\n    \"battery\": new Recipe({\r\n        recipe: ()=> ({\r\n            \"ready-cidium\": { count: 1 },\r\n            \"raw-cidium\": { count: 2 },\r\n        }),\r\n    }),\r\n\r\n    // Craft drill\r\n    \"drill\": new Recipe({\r\n        recipe: ()=> ({\r\n            // \"ready-cidium\": { count: 1 },\r\n            \"ready-cidium\": { count: 2 },\r\n            \"raw-nerius\": { count: 2 },\r\n        }),\r\n    }),\r\n\r\n    // Craft box\r\n    \"box\": new Recipe({\r\n        recipe: ()=> ({\r\n            \"ready-cidium\": { count: 1 },\r\n            \"raw-nerius\": { count: 4 },\r\n        }),\r\n    }),\r\n\r\n    // Craft card\r\n    \"card\": new Recipe({\r\n        recipe: ()=> ({\r\n            \"ready-cidium\": { count: 2 },\r\n            \"raw-osmy\": { count: 3 },\r\n            \"raw-grade-cidium\": { count: 1 },\r\n        }),\r\n    }),\r\n    \r\n    // Storage up\r\n    \"recipe-storage-level-up\": new Recipe({\r\n        recipe: ()=> [\r\n            { \"ready-cidium\": { count: 2 }, \"raw-osmy\": { count: 3 } }, // Level 2\r\n            { \"ready-cidium\": { count: 4 }, \"raw-osmy\": { count: 3 }, \"raw-grade-cidium\": { count: 2 } }, // Level 3\r\n        ][recycler.storage.level - 1] as any,\r\n        // On craft\r\n        onCraft: ()=> {\r\n            recycler.storage.upgrade(1);\r\n        },\r\n        // Render icon\r\n        icon: (game, pos, opacity)=> {\r\n            game.renderer.drawSprite({\r\n                texture: asImage(game.getAssetByName(\"storage-level-up\")),\r\n                position: pos,\r\n                width: 2,\r\n                height: 2,\r\n                scale: Vector2.all(.7),\r\n                layer: \"ui\",\r\n                opacity\r\n            });\r\n            game.renderer.drawText({\r\n                text: `${ recycler.storage.level + 1 }ур.`,\r\n                position: pos.add(Vector2.all(Config.SPRITE_SIZE * .3)),\r\n                layer: \"ui\",\r\n            });\r\n        },\r\n        isRemoved: ()=> recycler.storage.level >= MaxGearLevel\r\n    }),\r\n\r\n    // Tool up\r\n    \"recipe-tool-level-up\": new Recipe({\r\n        recipe: ()=> [\r\n            { \"ready-cidium\": { count: 3 }  }, // Level 2\r\n            { \"ready-cidium\": { count: 2 }, \"card\": { count: 1 }, \"raw-grade-cidium\": { count: 1 } }, // Level 3\r\n            { \"ready-cidium\": { count: 3 }, \"raw-osmy\": { count: 4 }, \"drill\": { count: 1 }, \"raw-antin\": { count: 3 } }, // Level 4\r\n        ][recycler.player ? recycler.player?.toolLevel - 1 : 0] as any,\r\n        onCraft: ()=> {\r\n            if (!recycler.player) return;\r\n\r\n            recycler.player.upgradeTool(1);\r\n        },\r\n        icon: (game, pos, opacity)=> {\r\n            if (!recycler.player) return;\r\n\r\n            game.renderer.drawSprite({\r\n                texture: asImage(game.getAssetByName(\"tools\")),\r\n                position: pos,\r\n                layer: \"ui\",\r\n                opacity\r\n            });\r\n            game.renderer.drawText({\r\n                text: `${ recycler.player.toolLevel + 1 }ур.`,\r\n                position: pos.add(Vector2.all(Config.SPRITE_SIZE * .3)),\r\n                layer: \"ui\",\r\n            });\r\n        },\r\n        isRemoved: ()=> recycler.player ? recycler.player.toolLevel >= MaxToolLevel : false\r\n    }),\r\n\r\n    // Craft bottle\r\n    \"bottle\": new Recipe({\r\n        recipe: ()=> ({\r\n            \"ready-cidium\": { count: 3 },\r\n            \"box\": { count: 1 },\r\n            \"raw-antin\": { count: 4 },\r\n            \"raw-grade-cidium\": { count: 2 }\r\n        }),\r\n        onCraft: ()=> {\r\n            if (!recycler.player) return\r\n            recycler.player.hasBottle = true;\r\n        },\r\n        isRemoved: ()=> recycler.player ? recycler.player.hasBottle : false\r\n    }),\r\n\r\n    // Craft robot\r\n    \"item-robot\": new Recipe({\r\n        recipe: ()=> ({\r\n            \"battery\": { count: 1 },\r\n            \"drill\": { count: 1 },\r\n            \"box\": { count: 1 },\r\n            \"card\": { count: 1 }\r\n        }),\r\n        isRemoved: ()=> recycler.player ? recycler.player.hasBottle : false\r\n    }),\r\n    \r\n});\r\n\r\nexport default recipes;","import { Color, Config } from \"../../config\";\r\nimport { Game, ISpriteProps } from \"../../engine\";\r\nimport { asImage, clamp, safeSlot, safeValue, Vector2 } from \"../../engine/utils/math\";\r\nimport { ObjectNames } from \"../../names\";\r\nimport { Items } from \"../../objects\";\r\nimport { Gear, GearLevel } from \"./Gear\";\r\nimport recipes from \"./recipes\";\r\nimport { Storage } from \"./Storage\";\r\n\r\nexport class Recycler extends Gear {\r\n    storage: Storage\r\n    recipes: { [key: string]: Recipe }\r\n    \r\n    constructor(storage: Storage, props?: ISpriteProps) {\r\n        super(\"gear-recycler\", 1, props);\r\n\r\n        this.ui.focused.slot = 1;\r\n        this.ui.focused.row = 10;\r\n\r\n        this.storage = storage;\r\n        this.recipes = recipes(this);\r\n        this.headerOffset.set(0, -Config.SPRITE_SIZE);\r\n    }\r\n    \r\n    onInteract() {\r\n        super.onInteract();\r\n\r\n        // Open\r\n        this.ui.enabled = true;\r\n        \r\n        // Close\r\n        if (this.ui.focused.slot == 0 && this.ui.focused.row == 0 && this.ui.enabled) {\r\n            this.ui.enabled = false;\r\n        \r\n            this.ui.focused.slot = 1;\r\n            this.ui.focused.row = 10;\r\n\r\n            return;\r\n        }\r\n\r\n        if (this.ui.enabled && this.ui.focused.slot == 1 && this.ui.focused.row == 10) {\r\n            this.ui.focused.slot = 0;\r\n            this.ui.focused.row = 0;\r\n        }\r\n\r\n        if (this.ui.focused.row != 0) {\r\n            \r\n            const focused = this.ui.focused.slot + (this.ui.focused.row - 1) * this.maxRowItemsCount;\r\n            const recipesKeys = this.getRecipesKeys();\r\n            const recipe = this.recipes[recipesKeys[focused]];\r\n            \r\n            // Craft\r\n            if (recipe.canCraft(this.storage)) {\r\n                recipe.onCraft(this.game, this.storage, this.position, recipesKeys[focused]);\r\n                this.ui.enabled = false;\r\n                this.sound.play(this.game, \"crafting\");\r\n                this.ui.focused.slot = 1;\r\n                this.ui.focused.row = 10;\r\n            } else {\r\n                // Can't craft\r\n                this.sound.play(this.game, \"error\");\r\n                this.ui.spawnMessageText(\"Недостатачно ресурсов\");\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    renderUI() {\r\n        super.renderUI();\r\n\r\n        const recipesKeys = this.getRecipesKeys();\r\n\r\n        this.actionButtonAssetName = (this.ui.focused.row == 0 && this.ui.focused.slot == 0) ? \"close\" : \"craft\";\r\n        this.tipText = this.actionButtonAssetName == \"close\" ? \"закрыть\" : \"изготовить\";\r\n\r\n        this.ui.updateTemplate([\r\n            1,\r\n            clamp(recipesKeys.length, 0, this.maxRowItemsCount),\r\n            recipesKeys.length > this.maxRowItemsCount ? recipesKeys.length - this.maxRowItemsCount : 0,\r\n        ]);\r\n        if (!this.ui.enabled) return;\r\n\r\n        this.renderRecipesUI(recipesKeys);\r\n        this.renderDescriptionUI(recipesKeys);\r\n    }\r\n\r\n    renderRecipesUI(recipes: string[]) {\r\n        const size = Config.SPRITE_SIZE;\r\n        const windowCenter = new Vector2(innerWidth / 2, innerHeight / 2).apply(Math.floor);\r\n        \r\n        recipes.map((recipeName, index)=> {\r\n\r\n            // Render recipe\r\n            const pos = new Vector2(\r\n                (index % this.maxRowItemsCount) * size - size * 2,\r\n                -size + Math.floor(index / this.maxRowItemsCount) * size\r\n            ).add(windowCenter);\r\n\r\n            this.ui.renderFocusable(\r\n                pos,\r\n                // Row\r\n                Math.floor(index / this.maxRowItemsCount) + 1,\r\n                // Slot\r\n                index % this.maxRowItemsCount,\r\n                ()=> {\r\n                \r\n                // Background\r\n                this.game.renderer.drawRect({\r\n                    position: pos,\r\n                    color: Color.STONE_LAYER_COLOR,\r\n                    layer: \"ui\",\r\n                    width: .5,\r\n                    height: .5,\r\n                });\r\n                \r\n                // Render recipe icon\r\n                const renderIcon = this.recipes[recipeName].icon;\r\n                if (renderIcon)\r\n                    renderIcon(\r\n                        this.game,\r\n                        pos,\r\n                        this.recipes[recipeName].canCraft(this.storage) ? 1 : .5\r\n                    );\r\n                else\r\n                    this.game.renderer.drawSprite({\r\n                        texture: asImage(this.game.getAssetByName(recipeName)),\r\n                        position: pos,\r\n                        opacity: this.recipes[recipeName].canCraft(this.storage) ? 1 : .5,\r\n                        layer: \"ui\"\r\n                    })\r\n\r\n            }, 1, 1, true);\r\n\r\n        });\r\n\r\n    }\r\n    renderDescriptionUI(recipesKeys: string[]) {\r\n        const size = Config.SPRITE_SIZE;\r\n        const windowCenter = new Vector2(innerWidth / 2, innerHeight / 2).apply(Math.floor);\r\n\r\n        // Get recipe by focused slot\r\n        const selectedSlot = this.ui.ghostFocused.slot + (this.ui.ghostFocused.row - 1) * this.maxRowItemsCount;\r\n        const currentRecipe = this.recipes[recipesKeys[selectedSlot]];\r\n        const recipeDescription = ObjectNames[recipesKeys[selectedSlot]];\r\n\r\n        if (!recipeDescription) return;\r\n\r\n        const isInStockCount = (slotName: string): number => safeSlot(this.storage.contains.slots[slotName]).count;\r\n        \r\n        this.ui.renderDescriptionUI({\r\n            title: recipeDescription.name,\r\n            titleColor: currentRecipe.canCraft(this.storage) ? \"#fff\" : Color.RED,\r\n            specials: [\"\", \"\"],\r\n            description: recipeDescription.desc,\r\n            renderIcon: (pos)=> {\r\n                const renderIcon = currentRecipe.icon\r\n                if (renderIcon)\r\n                    renderIcon(this.game, pos, 1);   \r\n                else\r\n                    this.game.renderer.drawSprite({\r\n                        texture: asImage(this.game.getAssetByName(recipesKeys[selectedSlot])),\r\n                        position: pos,\r\n                        layer: \"ui\"\r\n                    })\r\n            }\r\n        });\r\n\r\n        //\r\n        const selectedRecipeKeys = Object.keys(currentRecipe.recipe());\r\n        selectedRecipeKeys.map((slotName, index)=> {\r\n            const pos = new Vector2(index * Config.SPRITE_SIZE - size, size*2 + 5).add(windowCenter);\r\n            const count = isInStockCount(slotName);\r\n            const needCount = currentRecipe.recipe()[slotName].count;\r\n            \r\n            // Sprite\r\n            this.game.renderer.drawSprite({\r\n                texture: asImage(this.game.getAssetByName(slotName)),\r\n                position: pos,\r\n                layer: \"ui\"\r\n            });\r\n            // Count\r\n            this.game.renderer.drawText({\r\n                text: `${ count }/${ needCount }`,\r\n                color: count >= needCount ? \"#fff\" : Color.RED, \r\n                position: pos.add(Vector2.all(Config.SPRITE_SIZE * .2)),\r\n                layer: \"ui\"\r\n            })\r\n\r\n            // Plus\r\n            if (index < selectedRecipeKeys.length - 1)\r\n                this.game.renderer.drawText({\r\n                    text: \"+\",\r\n                    font: \"22px Pixel\",\r\n                    position: pos.add(new Vector2(size / 2)),\r\n                    layer: \"ui\"\r\n                })\r\n            \r\n        });\r\n\r\n    }\r\n\r\n    getRecipesKeys(): string[] {\r\n        return Object.keys(this.recipes).filter(name=> !this.recipes[name].isRemoved())\r\n    }\r\n}\r\n\r\nexport class Recipe {\r\n    recipe: ()=> Storage[\"contains\"][\"slots\"]\r\n    _onCraft: ((game: Game)=> void) | undefined\r\n    isRemoved: ()=> boolean\r\n    icon: ((game: Game, pos: Vector2, opacity: number)=> void) | undefined\r\n    \r\n    constructor(props: {\r\n        recipe: Recipe[\"recipe\"]\r\n        onCraft?: Recipe[\"_onCraft\"]\r\n        icon?: Recipe[\"icon\"]\r\n        isRemoved?: Recipe[\"isRemoved\"]\r\n    }) {\r\n        this.recipe = props.recipe;\r\n        this._onCraft = props.onCraft;\r\n        this.icon = props.icon;\r\n        this.isRemoved = props.isRemoved || (()=> false);\r\n    }\r\n\r\n    canCraft(storage: Storage): boolean {\r\n        const recipes = Object.keys(this.recipe());\r\n        // let can = false;\r\n        let hasCount = 0;\r\n\r\n        for (let i = 0; i < recipes.length; i ++) {\r\n            if (safeSlot(storage.contains.slots[recipes[i]]).count >= safeSlot(this.recipe()[recipes[i]]).count)\r\n                hasCount ++;\r\n        }\r\n        \r\n        return hasCount >= recipes.length;\r\n        // return can;\r\n    }\r\n    onCraft(game: Game, storage: Storage, position: Vector2, name: string) {\r\n        const recipes = Object.keys(this.recipe());\r\n\r\n        for (let i = 0; i < recipes.length; i ++) {\r\n            storage.contains.slots[recipes[i]].count -= this.recipe()[recipes[i]].count;\r\n        }\r\n\r\n        storage.calculateTotalCount()\r\n        if (this._onCraft)\r\n            this._onCraft(game);\r\n        else {\r\n            game.add(new Items[name](position));\r\n            game.initChildren();\r\n        }\r\n    }\r\n}","import { Color, Config, ItemSettings, OreSettings } from \"../../config\";\r\nimport { ISpriteProps } from \"../../engine\";\r\nimport { asImage, clamp, safeValue, Vector2 } from \"../../engine/utils/math\";\r\nimport { ObjectNames } from \"../../names\";\r\nimport { Items } from \"../../objects\";\r\nimport { Gear, GearLevel } from \"./Gear\";\r\n\r\ntype InteractType = \"store\" | \"view\";\r\nenum MaxStorageTotalCount {\r\n    \"1-level\" = 18,\r\n    \"2-level\" = 28,\r\n    \"3-level\" = 42,\r\n}\r\n\r\nexport class Storage extends Gear {\r\n    contains: {\r\n        totalCount: number\r\n        slots: {\r\n            [key: string]: { count: number }\r\n        }\r\n    }\r\n    maxTotalCount: number\r\n    interactType: InteractType\r\n    \r\n    constructor(props?: ISpriteProps) {\r\n        super(\"gear-storage\", 1, props);\r\n        \r\n        this.contains = { totalCount: 0, slots: {} };\r\n        this.interactType = \"view\";\r\n        this.maxTotalCount = MaxStorageTotalCount[`${ this.level }-level`];\r\n        this.headerOffset.set(0, -Config.SPRITE_SIZE);\r\n        this.changeMaxTotalCount();\r\n    }\r\n\r\n    init() {\r\n        super.init();\r\n\r\n        this.level = this.game.loadKey(\"storage-level\", 1);\r\n        this.contains = this.game.loadKey(\"storage-contains\", { totalCount: 0, slots: {} });\r\n        \r\n        this.changeMaxTotalCount();\r\n        this.calculateTotalCount();\r\n    }\r\n\r\n    update() {\r\n        super.update();\r\n        \r\n        if (!this.player) return;\r\n        if (!this.playerIsNear) return;\r\n        \r\n        // Change interact type\r\n        this.interactType = (\r\n            this.player.inventory.totalCount == 0 ||\r\n            this.contains.totalCount >= this.maxTotalCount ||\r\n            this.filterItems(this.player.inventory.slots).length == this.filterItems(this.player.inventory.slots).filter(name=> safeValue(ItemSettings[name], { lineColor: \"#fff\", storage: 1 }).storage > this.level).length\r\n        ) ? \"view\" : \"store\";\r\n\r\n        this.actionButtonAssetName = (this.ui.focused.row == 0) ? \"close\" : \"drop\";\r\n\r\n        this.interactText = this.interactType == \"view\" ? \"Содержимое\" : \"Сложить\";\r\n        this.tipText = this.actionButtonAssetName == \"close\" ? \"закрыть\" : \"выбросить x1\";\r\n    }\r\n    \r\n    upgrade(levelUp: number) {\r\n        super.upgrade(levelUp);\r\n\r\n        this.maxTotalCount = MaxStorageTotalCount[`${ this.level }-level`];\r\n    }\r\n\r\n    store() {\r\n        if (this.contains.totalCount >= this.maxTotalCount || !this.player) return;\r\n        \r\n        let storedCount = 0;\r\n        let totalStoredCount = 0;\r\n        const slotNames = this.filterItems(this.player.inventory.slots).filter(name=> safeValue(ItemSettings[name], { lineColor: \"#fff\", storage: 1 }).storage <= this.level);\r\n        // Storage level less then need\r\n        if (this.filterItems(this.player.inventory.slots).filter(name=> safeValue(ItemSettings[name], { lineColor: \"#fff\", storage: 1 }).storage > this.level).length > 0)\r\n            this.player.spawnText(\"Низкий уровень\\nхранилища\", new Vector2(0, -90));\r\n        \r\n        slotNames.map(slotName=> {\r\n            if (!this.player) return;\r\n            \r\n            this.contains.slots[slotName] = this.contains.slots[slotName] || { count: 0 };\r\n            \r\n            // Add items\r\n            if (this.contains.totalCount >= this.maxTotalCount) {\r\n                this.player.spawnText(\"Хранилище перепольнено\", new Vector2(0, -50));\r\n                return;\r\n            }\r\n\r\n            storedCount = this.player.inventory.slots[slotName].count + this.contains.totalCount <= this.maxTotalCount ? this.player.inventory.slots[slotName].count : (this.maxTotalCount - this.contains.totalCount);\r\n            this.contains.slots[slotName].count += storedCount;\r\n            totalStoredCount += storedCount;\r\n            \r\n            this.player.foldItemsTo(slotName, storedCount, this.position);\r\n\r\n            this.calculateTotalCount();\r\n            this.player.calculateTotalCount();\r\n        });\r\n        \r\n        if (slotNames.length <= 0) return;\r\n        \r\n        // Play store audio\r\n        this.sound.play(this.game, \"store\");\r\n        this.player.spawnText(totalStoredCount.toString());\r\n\r\n        this.saveData();\r\n    }\r\n    drop(slotName: string, count: number) {\r\n        if (!this.contains.slots[slotName]) return\r\n        \r\n        this.contains.slots[slotName].count -= count;\r\n\r\n        this.game.add(new Items[slotName](this.position));\r\n        this.game.initChildren();\r\n        this.sound.play(this.game, \"store\");\r\n\r\n        this.calculateTotalCount();\r\n    }\r\n    calculateTotalCount() {\r\n        this.contains.totalCount = 0;\r\n\r\n        Object.keys(this.contains.slots).map(slotName=> {\r\n            this.contains.totalCount += this.contains.slots[slotName].count;\r\n        });\r\n\r\n        this.saveData();\r\n    }\r\n\r\n    renderUI() {\r\n        super.renderUI();\r\n\r\n        if (!this.ui.enabled) return;\r\n\r\n        const slotNames = this.filterItems(this.contains.slots);\r\n        this.ui.updateTemplate([\r\n            1,\r\n            clamp(slotNames.length, 0, this.maxRowItemsCount),\r\n            slotNames.length > this.maxRowItemsCount ? slotNames.length - this.maxRowItemsCount : 0,\r\n        ]);\r\n        if (!this.ui.template[0]) {\r\n            this.ui.focused.row = 1;\r\n            this.ui.focused.slot = 0;\r\n        }\r\n            \r\n        this.renderInventoryUI(slotNames);\r\n\r\n        const name = slotNames[this.ui.ghostFocused.slot + (this.ui.ghostFocused.row-1)*this.maxRowItemsCount]\r\n        const item = ObjectNames[name];\r\n        if (!item) return;\r\n        \r\n        const oreSettings = OreSettings[name.replace(\"raw-\", \"\")];\r\n        const special = [\r\n            oreSettings ? `> Нужен инструмент ${ oreSettings.tool || 1 }ур. и выше` : \"> Можно найти\",\r\n            ...item.special || \"\"\r\n        ].filter(t=> t != \"\");\r\n\r\n        // Render description\r\n        this.ui.renderDescriptionUI({\r\n            title: item.name,\r\n            specials: special,\r\n            description: item.desc, \r\n            renderIcon: (pos)=> {\r\n                this.game.renderer.drawSprite({\r\n                    texture: asImage(this.game.getAssetByName(name)),\r\n                    position: pos,\r\n                    layer: \"ui\"\r\n                });\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    renderInventoryUI(slots: string[]) {\r\n        const size = Config.SPRITE_SIZE;\r\n        const windowCenter = new Vector2(innerWidth / 2, innerHeight / 2).apply(Math.floor);\r\n\r\n        // Close button\r\n        if (slots.length == 0) {\r\n            this.ui.focused.row = 0;\r\n            this.ui.bounds();\r\n        }\r\n\r\n        // Draw count text\r\n        this.game.renderer.drawText({\r\n            text: `${ this.contains.totalCount }/${ this.maxTotalCount }`,\r\n            position: new Vector2(-size*2.25, -size * 2 + 10).add(windowCenter),\r\n            color: this.contains.totalCount >= this.maxTotalCount ? Color.RED : \"#fff\",\r\n            align: \"left\",\r\n            layer: \"ui\"\r\n        });\r\n\r\n        slots.map((slot, index)=> {\r\n            \r\n            const pos = new Vector2(\r\n                ((index % this.maxRowItemsCount) * size) - size * Math.floor(this.maxRowItemsCount / 2),\r\n                Math.floor(index / this.maxRowItemsCount) * size\r\n            ).add(windowCenter).add(new Vector2(0, -size));\r\n\r\n            this.ui.renderFocusable(\r\n                pos,\r\n                Math.floor(index / this.maxRowItemsCount) + 1,\r\n                index % this.maxRowItemsCount,\r\n                ()=> {\r\n                const count = this.contains.slots[slot].count;\r\n\r\n                // Draw item sprite\r\n                this.game.renderer.drawSprite({\r\n                    texture: asImage(this.game.getAssetByName(slot)),\r\n                    position: pos,\r\n                    layer: \"ui\"\r\n                });\r\n\r\n                // Draw item count text\r\n                if (count > 1)\r\n                    this.game.renderer.drawText({\r\n                        text: count.toString(),\r\n                        position: pos.add(Vector2.all(Config.SPRITE_SIZE * .3)),\r\n                        layer: \"ui\"\r\n                    });\r\n                \r\n            }, 1, 1, true);\r\n\r\n        });\r\n        \r\n    }\r\n\r\n    onInteract() {\r\n        super.onInteract();\r\n\r\n        if (this.ui.enabled && this.ui.focused.row == 0 && this.ui.focused.slot == 0) {\r\n            this.ui.enabled = false;\r\n            return;\r\n        }\r\n        if (this.ui.enabled && this.ui.focused.row != 0) {\r\n            const slotName = this.filterItems(this.contains.slots)[this.ui.ghostFocused.slot + (this.ui.ghostFocused.row - 1) * this.maxRowItemsCount];\r\n            this.drop(slotName, 1);\r\n            return;\r\n        }\r\n        \r\n        if (this.interactType == \"store\") {\r\n            this.ui.enabled = false;\r\n            this.store();\r\n        } else if (this.interactType == \"view\") {\r\n            if (!this.ui.enabled) {\r\n                this.ui.focused.row = 0;\r\n                this.ui.focused.slot = 0;\r\n            }\r\n            this.ui.enabled = true;\r\n            if (this.ui.enabled)\r\n                this.sound.play(this.game, \"storage\");\r\n        }        \r\n\r\n    }\r\n\r\n    filterItems(slots: Storage[\"contains\"][\"slots\"]) {\r\n        return Object.keys(slots).filter(name=> slots[name].count > 0);\r\n        // return Object.keys(slots).filter(name=> name.indexOf(\"raw\") >= 0 && ((slots[name] as any).count ? (slots[name] as any).count > 0 : slots[name] > 0));\r\n    }\r\n    saveData() {\r\n        super.saveData();\r\n        this.game.saveKey(\"storage-contains\", JSON.stringify(this.contains));\r\n        this.game.saveKey(\"storage-level\", this.level.toString());\r\n    }\r\n    changeMaxTotalCount() {\r\n        this.maxTotalCount = MaxStorageTotalCount[`${ this.level }-level`];\r\n    }\r\n    reset(): void {\r\n        this.contains.totalCount = 0;\r\n        this.contains.slots = {};\r\n        \r\n        super.reset();\r\n    }\r\n}","import { Config } from \"../config\";\r\nimport { Game, Sprite } from \"../engine\";\r\nimport { Vector2 } from \"../engine/utils/math\";\r\nimport { Documentation } from \"../objects/gear/Documentation\";\r\nimport { OxygenGenerator } from \"../objects/gear/OxygenGenerator\";\r\nimport { Recycler } from \"../objects/gear/Recycler\";\r\nimport { Storage } from \"../objects/gear/Storage\";\r\n\r\nexport function initDome(game: Game) {\r\n    const domePosition = new Vector2(Math.round(Config.WORLD_X_CENTER), -Config.SPRITE_SIZE * 1.5);\r\n\r\n    const storage = game.add<Storage>(new Storage({\r\n        position: domePosition.add(new Vector2(-150, 0))\r\n    }));\r\n\r\n    game.add<Sprite>(new OxygenGenerator({\r\n        position: domePosition.add(new Vector2(-60, -100))\r\n    }));\r\n    game.add<Sprite>(new Documentation({\r\n        position: domePosition.add(new Vector2(60, -100))\r\n    }));\r\n    game.add<Sprite>(new Recycler(storage, {\r\n        flip: { x: true, y: false },\r\n        position: domePosition.add(new Vector2(140, 0))\r\n    }));\r\n    \r\n    // Dome\r\n    game.add<Sprite>(new Sprite(\"dome\", \"dome\", {\r\n        width: 8,\r\n        height: 8,\r\n        position: domePosition,\r\n        layer: \"particles\",\r\n        colliderType: \"none\"\r\n    }));\r\n\r\n}","import { Config } from \"../config\"\r\nimport { ISpriteProps, Sprite } from \"../engine\"\r\nimport { Sound } from \"../engine/components/Sound\"\r\nimport { ColliderType } from \"../engine/Physics\"\r\nimport { chance, lerp, random, safeValue, Vector2 } from \"../engine/utils/math\"\r\nimport { ItemParent } from \"./item/ItemParent\"\r\n\r\nexport class Block extends Sprite {\r\n    inChunkId: string\r\n\r\n    sound: Sound\r\n    \r\n    animatedScale: number\r\n    animateScaleTo: number\r\n    darkenFactor: number\r\n    randomRotate: boolean\r\n    randomFlipX: boolean\r\n    customColliderType: ColliderType | undefined\r\n    \r\n    constructor(name: string, assetName: string, position: Vector2, props?: ISpriteProps) {\r\n        super(name, assetName, {\r\n            colliderType: \"none\",\r\n            ...props,\r\n            position: position.add(new Vector2(0, 0)).mul(Config.SPRITE_PIXEL_SIZE * Config.SPRITE_SCALE)\r\n        });\r\n\r\n        this.inChunkId = \"\";\r\n        \r\n        this.sound = new Sound();\r\n\r\n        this.animatedScale = 1;\r\n        this.animateScaleTo = 1;\r\n        this.darkenFactor = 1;\r\n        this.randomRotate = true;\r\n        this.randomFlipX = true;\r\n        this.customColliderType = \"solid\";\r\n        \r\n    }\r\n\r\n    static rules(x: number, y: number): boolean {\r\n        return false;\r\n    }\r\n\r\n    init() {\r\n        super.init();\r\n        \r\n        if (this.randomRotate)\r\n            this.rotation = Math.floor(random(1, 5)) * Math.PI;\r\n        if (this.randomFlipX)\r\n            this.flip.x = Boolean(Math.floor(random(0, 2)));\r\n\r\n        if (Config.ALLOW_DARK)\r\n            this.visible = false;\r\n    }\r\n    render() {\r\n        super.render();\r\n        \r\n        if (Config.ALLOW_DARK)\r\n            this.darken();\r\n        \r\n    }\r\n    update() {\r\n        super.update();\r\n\r\n        // this.sound.update3D(this.game, this.position);\r\n\r\n        this.animatedScale = lerp(this.animatedScale, this.animateScaleTo, .2);\r\n        this.scale.set(this.animatedScale, this.animatedScale);\r\n\r\n        if (this.game.children.find(child=> child.collider.type == \"dynamic\" && child.position.distance(this.position) < 300))\r\n            this.collider.type = safeValue(this.customColliderType, \"solid\");\r\n        else\r\n            this.collider.type = \"none\";\r\n    }\r\n\r\n    darken() {\r\n        \r\n        const t = 1 - this.game.camera.position.y / 200;\r\n        const d = (this.game.camera.position.distance(this.position) - 200);\r\n        this.darkenFactor = (d > 96 ? 1 : d / 96) + (t > 0 ? t : 0);\r\n        \r\n        if (this.darkenFactor < 1) \r\n            this.opacity = 1 - this.darkenFactor;\r\n        this.visible = this.darkenFactor < 1;\r\n    }\r\n    checkBlockIn(offset: Vector2, checkChunkBorders?: boolean, findName?: string): boolean {\r\n\r\n        const size = Config.SPRITE_SIZE;\r\n        const blocks = this.game.getChildrenByName<Block>(findName || \"ore\");\r\n        const thisPos = this.position.div(size).apply(Math.floor);\r\n\r\n        const top = +this.inChunkId.split(\"-\")[1] <= 0 && offset.y < 0;\r\n        const bottom = +this.inChunkId.split(\"-\")[1] >= 3 && offset.y > 0;\r\n        const vertical = bottom || top;\r\n        \r\n        return (vertical && safeValue(checkChunkBorders, true)) || blocks.filter(block=> block.name.indexOf(\"plant\") < 0).findIndex(block=> {\r\n            const orePos = block.position.div(size).apply(Math.floor);\r\n            \r\n            return Vector2.compare(orePos, thisPos.add(offset));\r\n        }) >= 0;\r\n    }\r\n    dropItem(item: typeof ItemParent | any, chancePercent?: number, offset?: Vector2) {\r\n        let drop = true;\r\n        \r\n        if (chancePercent)\r\n            drop = chance(chancePercent);\r\n            \r\n        if (!drop) return;\r\n        this.game.add<typeof item>(new (item as any)(this.position.add(offset || Vector2.zero()).add(new Vector2(random(-10, 10), random(-10, 10)))));\r\n        this.game.initChildren();\r\n    }\r\n}","import { asImage, chance, random, randomInt, Vector2 } from \"../../engine/utils/math\";\r\nimport { ISpriteProps } from \"../../engine\";\r\nimport { Config, Color, OreSettings } from \"../../config\";\r\nimport { ToolLevel } from \"../entities/Player\";\r\nimport { SpawnParticles } from \"../../engine/components/Particles\";\r\nimport { Block } from \"../Block\";\r\n\r\nexport type OreType =\r\n    \"stone\" | \"stony-ground\" | \"deep-stone\" | \"destrony\" | \"manty\" |\r\n    \"cracked-stone\" | \"basalt\" | \"burnt-basalt\" |\r\n    \"cidium\" | \"osmy\" | \"antin\" | \"rady\" | \"nerius\" | \"fetus-stone\" | \"mushroom-stone\" |\r\n    \"stalactite\";\r\n\r\nexport class Ore extends Block {\r\n    oreType: OreType\r\n\r\n    hp: number\r\n    tilePosition: Vector2\r\n    unbreakable: boolean\r\n    needToolLevel: ToolLevel\r\n    \r\n    particlesColors: string[]\r\n    hitAudioName: string\r\n    breakAudioNames: string[]\r\n\r\n    allowDecorations: boolean\r\n    \r\n    allowBottomDecorations: boolean\r\n    bottomDecorationsCount: number\r\n    currentBottomDecorationFrame: number | null\r\n\r\n    allowTopDecorations: boolean\r\n    topDecorationsCount: number\r\n    currentTopDecorationFrame: number | null\r\n\r\n    constructor(type: OreType, position: Vector2, props?: ISpriteProps) {\r\n        super(`ore-${ type }`, type, position, props);\r\n        \r\n        this.oreType = type;\r\n        this.tilePosition = position\r\n        \r\n        const settings = OreSettings[type];\r\n        this.hp = settings ? settings.hp : OreSettings[\"stone\"].hp;\r\n        this.needToolLevel = OreSettings[type]?.tool || 1;\r\n        this.unbreakable = false;\r\n\r\n        this.particlesColors = [Color.BLACK];\r\n        this.hitAudioName = \"stone-hit\";\r\n        this.breakAudioNames = [\"stone-break-1\", \"stone-break-2\", \"stone-break-3\"];\r\n\r\n        this.allowDecorations = false;\r\n        \r\n        this.allowBottomDecorations = false;\r\n        this.bottomDecorationsCount = 8;\r\n        this.currentBottomDecorationFrame = null;\r\n        \r\n        this.allowTopDecorations = false;\r\n        this.topDecorationsCount = 10;\r\n        this.currentTopDecorationFrame = null;\r\n    }\r\n\r\n    init() {\r\n        super.init();\r\n\r\n        if (!this.allowDecorations) return;\r\n        \r\n        // Top\r\n        if (!this.checkBlockIn(new Vector2(0, -1)))\r\n            this.allowTopDecorations = true;\r\n        // Bottom\r\n        if (!this.checkBlockIn(new Vector2(0, 1)))\r\n            this.allowBottomDecorations = true;\r\n        \r\n            \r\n        if (this.allowTopDecorations) {\r\n            if (chance(50))\r\n                this.currentTopDecorationFrame = randomInt(0, this.topDecorationsCount);\r\n            else\r\n                this.currentTopDecorationFrame = null;\r\n        }\r\n        if (this.allowBottomDecorations) {\r\n            if (chance(50))\r\n                this.currentBottomDecorationFrame = randomInt(0, this.bottomDecorationsCount);\r\n            else\r\n                this.currentBottomDecorationFrame = null;\r\n        }\r\n\r\n    }\r\n\r\n    render() {\r\n        super.render();\r\n\r\n        this.renderDecorations();\r\n    }\r\n\r\n    renderDecorations() {\r\n        if (!this.visible) return;\r\n\r\n        if (this.currentTopDecorationFrame)\r\n            this.game.renderer.drawSprite({\r\n                texture: asImage(this.game.getAssetByName(\"plants\")),\r\n                flip: this.flip,\r\n                frame: new Vector2(this.currentTopDecorationFrame, 0),\r\n                position: this.position.add(new Vector2(0, -Config.SPRITE_SIZE + (1-this.scale.y) * Config.SPRITE_SIZE)),\r\n                opacity: this.opacity,\r\n                scale: this.scale\r\n            });\r\n\r\n        if (this.currentBottomDecorationFrame)\r\n            this.game.renderer.drawSprite({\r\n                texture: asImage(this.game.getAssetByName(\"under-stone\")),\r\n                flip: this.flip,\r\n                frame: new Vector2(this.currentBottomDecorationFrame, 0),\r\n                position: this.position.add(new Vector2(0, Config.SPRITE_SIZE - (1-this.scale.y) * Config.SPRITE_SIZE)),\r\n                opacity: this.opacity,\r\n                scale: this.scale\r\n            });\r\n\r\n    }\r\n    \r\n    hit(damage: number, toolLevel: ToolLevel) {\r\n        if (!this.unbreakable && toolLevel >= this.needToolLevel) {\r\n\r\n            this.hp -= damage;\r\n            this.animatedScale = .8;\r\n            \r\n            SpawnParticles(this.game, this.position, {\r\n                colors: this.particlesColors,\r\n                size: [.2, .5],\r\n                count: 6,\r\n                box: ()=> new Vector2(random(-Config.SPRITE_SIZE / 2, Config.SPRITE_SIZE / 2), random(-Config.SPRITE_SIZE / 2, Config.SPRITE_SIZE / 2))\r\n            });\r\n\r\n            if (this.hp <= 0) {\r\n                // Break audio\r\n                this.sound.play(this.game, this.breakAudioNames[randomInt(0, this.breakAudioNames.length-1)]);\r\n                this.onBreak();\r\n            }\r\n        }\r\n\r\n        // Hit audio\r\n        if (this.hp > 0)\r\n            this.sound.play(this.game, this.hitAudioName);\r\n\r\n    }\r\n    onBreak() {\r\n\r\n        SpawnParticles(this.game, this.position, {\r\n            colors: this.particlesColors,\r\n        });\r\n        this.game.removeChildById(this.id);\r\n        this.game.generator.destroyOre(this.inChunkId);\r\n\r\n    }\r\n}","import { Color } from \"../../config\";\r\nimport { noise } from \"../../engine/Generator\";\r\nimport { inRange, Vector2 } from \"../../engine/utils/math\";\r\nimport { RawAntin } from \"../raws/RawAntin\";\r\nimport { Ore } from \"./Ore\";\r\n\r\nexport class Antin extends Ore {\r\n    constructor(position: Vector2) {\r\n        super(\"antin\", position);\r\n\r\n        this.particlesColors = [Color.GREY, Color.RED];\r\n    }\r\n\r\n    static rules(x: number, y: number): boolean {\r\n        const res = noise(x / 2, y / 2, 4, 3);\r\n        const mask = noise(x / 8 - 2, y / 8 + 10);\r\n        \r\n        return inRange(res + mask/4, 0, .6);\r\n    }\r\n\r\n    onBreak() {\r\n        super.onBreak();\r\n\r\n        this.dropItem(RawAntin);\r\n    }\r\n}","import { Config } from \"../../config\";\r\nimport { Game } from \"../../engine\";\r\nimport { SpawnCrumbleParticles, SpawnParticles } from \"../../engine/components/Particles\";\r\nimport { clamp, random, randomInt, Vector2 } from \"../../engine/utils/math\";\r\nimport { Entity } from \"../entities/Entity\";\r\nimport { Player } from \"../entities/Player\";\r\nimport { Ore, OreType } from \"./Ore\";\r\n\r\nexport class FallingOre extends Ore {\r\n    damage: [number, number]\r\n    \r\n    elapsedBeforeFall: number\r\n    allowFall: boolean\r\n    willFall: boolean\r\n    \r\n    constructor(type: OreType, position: Vector2) {\r\n        super(type, position);\r\n\r\n        this.damage = [2, 5];\r\n\r\n        this.elapsedBeforeFall = 0;\r\n        this.allowDecorations = true;\r\n        this.allowFall = false;\r\n        this.willFall = false;\r\n        this.customColliderType = \"solid\";\r\n    }\r\n\r\n    init() {\r\n        super.init();\r\n        \r\n        this.acceleration.y = .98;\r\n\r\n        // this.game.generator.onWorldChange(this.id, this.position, ()=> {\r\n\r\n        //     if (!this.checkBlockIn(new Vector2(0, 1), false)) {\r\n        //         this.animateScaleTo = .7;\r\n        //         SpawnCrumbleParticles(this.game, this.position.add(new Vector2(0, 40)));\r\n        //     }\r\n\r\n        // });\r\n    }\r\n    update() {\r\n        super.update();\r\n\r\n        this.gravity();\r\n    }\r\n\r\n    gravity() {\r\n        if (!this.willFall) {\r\n            this.elapsedBeforeFall = this.game.clock.elapsed;\r\n            return;\r\n        }\r\n        \r\n        if (this.game.generator.checkIsInLoadedChunk(this.position)) {\r\n\r\n            if ((this.game.clock.elapsed - this.elapsedBeforeFall) % Config.ORE_FALL_DELAY == 0 && !this.allowFall)\r\n                this.allowFall = true;\r\n\r\n            if (this.allowFall) {\r\n                if (this.collider.collidesWith?.bottom) {\r\n                    this.fallDestroy();\r\n                }\r\n                \r\n                this.customColliderType = \"dynamic\";\r\n                this.velocity.y ++;\r\n\r\n                this.hitEntity();\r\n\r\n            }\r\n        } else {\r\n            if (this.allowFall)\r\n                this.fallDestroy();\r\n        }\r\n\r\n        this.collider.collidesWith = null;\r\n    }\r\n    fall() {\r\n        this.willFall = true;\r\n        SpawnCrumbleParticles(this.game, this.position.add(new Vector2(0, 40)), this.particlesColors);\r\n    }\r\n    fallDestroy() {\r\n\r\n        SpawnParticles(this.game, this.position, { colors: this.particlesColors });\r\n        \r\n        this.sound.play(this.game, \"fall-stone-break\"); \r\n        this.game.removeChildById(this.id);\r\n        this.game.generator.destroyOre(this.inChunkId);\r\n\r\n    }\r\n    hitEntity() {\r\n        const entity = this.game.getChildrenByGroupName<Entity>(\"entity\").find(child=> {\r\n\r\n            return this.game.physics.collide(this, child).any;\r\n\r\n        });\r\n        if (!entity) return;\r\n\r\n        entity.hit(randomInt(this.damage[0], this.damage[0]));\r\n    }\r\n}","import { Color, Config } from \"../../config\";\r\nimport { SpawnParticles } from \"../../engine/components/Particles\";\r\nimport { asImage, chance, randomInt, Vector2 } from \"../../engine/utils/math\";\r\nimport { Block } from \"../Block\";\r\nimport { Entity } from \"../entities/Entity\";\r\nimport { FallingOre } from \"../ores/FallingORe\";\r\n\r\nexport class Stalactite extends FallingOre {\r\n    length: number\r\n    \r\n    constructor(length: number, parentInChunkId: Block[\"inChunkId\"], position: Vector2) {\r\n        super(\"stalactite\", position.div(Config.SPRITE_SIZE).apply(Math.floor));\r\n\r\n        this.length = length;\r\n        // const inChunkId = parentInChunkId.split(\"-\");\r\n        // inChunkId[1] = (+inChunkId[1] + 1).toString()\r\n        this.inChunkId = parentInChunkId;\r\n        // this.inChunkId = inChunkId.join(\"-\");\r\n        this.group = this.inChunkId;\r\n\r\n        this.damage = [4, 6];\r\n        this.particlesColors = [Color.GREY];\r\n        this.acceleration.set(0, .98);\r\n        this.collider.width = Config.SPRITE_SIZE * .7;\r\n    }\r\n    \r\n    init() {\r\n        super.init();\r\n\r\n        this.damage[0] = this.length + 4;\r\n    }\r\n    update() {\r\n        super.update();\r\n        this.growing();\r\n        \r\n        if (this.length <= 0) return;\r\n\r\n        if (this.allowFall) {\r\n            this.collider.width = Config.SPRITE_SIZE * .5;\r\n        }\r\n\r\n        this.tryFall();\r\n        this.particles();\r\n    }\r\n    render() {\r\n        const size = Config.SPRITE_SIZE;\r\n        \r\n        for (let i = 0; i < this.length; i ++) {\r\n\r\n            const pos = this.position.add(new Vector2(0, i * size));\r\n            let frame = 0;\r\n\r\n            if (i == 0)\r\n                frame = this.allowFall ? 3 : 0;\r\n            if (i > 0)\r\n                frame = 1;\r\n            if (i == this.length - 1) {\r\n                frame = 2;\r\n                if (this.length == 1 && this.allowFall)\r\n                    frame = 4;\r\n            }\r\n\r\n            const t = 1 - this.game.camera.position.y / 200;\r\n            const d = (this.game.camera.position.distance(pos) - 200);\r\n            const darkenFactor = (d > 96 ? 1 : d / 96) + (t > 0 ? t : 0);\r\n\r\n            if (darkenFactor < 1)\r\n                this.game.renderer.drawSprite({\r\n                    texture: asImage(this.game.getAssetByName(\"stalactite\")),\r\n                    frame: new Vector2(0, frame),\r\n                    position: pos,\r\n                    opacity: 1 - darkenFactor\r\n                })\r\n\r\n        }\r\n    }\r\n    darken() {}\r\n\r\n    growing() {\r\n        if (this.game.tick(Config.STALACTITE_GROW_TICK) && chance(Config.STALACTITE_GROW_CHANCE))\r\n            this.grow();\r\n    }\r\n    grow() {\r\n        if (this.length >= Config.MAX_STALACTITE_LENGTH) return;\r\n        this.length ++;\r\n        this.damage[0] = this.length + 4;\r\n        this.saveData();\r\n    }\r\n    \r\n    tryFall() {\r\n        if (!chance(40)) return;\r\n        \r\n        if (this.game.tick(60)) {\r\n\r\n            const entity = this.game.getChildrenByGroupName<Entity>(\"entity\").find(child=> {\r\n\r\n                const height = Config.SPRITE_SIZE * this.length + 5 * Config.SPRITE_SIZE;\r\n    \r\n                return this.game.physics.collideWithRect({\r\n                    id: this.id,\r\n                    position: this.position.add(new Vector2(0, height / 2)),\r\n                    width: Config.SPRITE_SIZE * .7,\r\n                    height: height\r\n                }, {\r\n                    id: child.id,\r\n                    position: child.position,\r\n                    width: child.collider.width,\r\n                    height: child.collider.height\r\n                }).any;\r\n    \r\n            });\r\n            if (!entity) return;\r\n\r\n            this.fall();\r\n\r\n        }\r\n\r\n    }\r\n    fallDestroy() {\r\n        super.fallDestroy();\r\n\r\n        this.length = 0;\r\n        this.saveData();\r\n    }\r\n    particles() {\r\n        if (this.game.tick(randomInt(100, 150)) && chance(60))\r\n            SpawnParticles(this.game, this.position.add(new Vector2(0, this.length * Config.SPRITE_SIZE - Config.SPRITE_SIZE * .8)), {\r\n                count: 1,\r\n                colors: [Color.BLUE],\r\n                gravity: .08,\r\n                velocity: ()=> new Vector2(0, 0),\r\n                size: [.6, .6]\r\n            })\r\n        \r\n    }\r\n\r\n    saveData() {\r\n        this.game.generator.modifyOre(this.inChunkId, { length: this.length });\r\n    }\r\n}","import { Config } from \"../../config\";\r\nimport { ISpriteProps } from \"../../engine\";\r\nimport { randomInt, Vector2 } from \"../../engine/utils/math\";\r\nimport { simplex2 } from \"../../engine/utils/noise\";\r\nimport { Player } from \"../entities/Player\";\r\nimport { Stalactite } from \"../environment/Stalactite\";\r\nimport { Ore, OreType } from \"./Ore\";\r\n\r\nexport class StalactiteOre extends Ore {\r\n    player!: Player\r\n    \r\n    stalactiteLength: number\r\n    allowGrow: boolean\r\n    \r\n    constructor(type: OreType, position: Vector2, data?: any, props?: ISpriteProps) {\r\n        super(type, position, props);\r\n\r\n        this.stalactiteLength = data ? data?.length || 0 : 0;\r\n        this.allowGrow = false;\r\n    }\r\n\r\n    init() {\r\n        super.init();\r\n\r\n        this.player = this.game.getChildById(\"player\")!;\r\n\r\n        if ((simplex2(this.position.x / 5, this.position.y / 5) + 1) / 2 > .4)\r\n            this.checkEmptySpace()\r\n        else\r\n            this.allowGrow = false;\r\n\r\n        if (!this.allowGrow) return;\r\n\r\n        const variants: number[] = [0, 1, 1, 2, 2, 2, 3, 3];\r\n        this.stalactiteLength = variants[randomInt(0, variants.length - 1)];\r\n\r\n        this.game.add(new Stalactite(this.stalactiteLength, this.inChunkId, this.position.add(new Vector2(0, Config.SPRITE_SIZE))));\r\n        this.game.initChildren();\r\n    }\r\n\r\n    checkEmptySpace() {\r\n\r\n        for (let i = 0; i < Config.MAX_STALACTITE_LENGTH; i ++) {\r\n            if (this.checkBlockIn(new Vector2(0, i + 1))) {\r\n                this.allowGrow = false;\r\n                break;\r\n            } else\r\n                this.allowGrow = true;\r\n        }\r\n\r\n    }\r\n}","import { Color } from \"../../config\";\r\nimport { Vector2 } from \"../../engine/utils/math\";\r\nimport { StalactiteOre } from \"./StalactiteOre\";\r\n\r\nexport class Basalt extends StalactiteOre {\r\n    constructor(position: Vector2, data: any) {\r\n        super(\"basalt\", position, data);\r\n\r\n        this.particlesColors = [Color.GREY];\r\n    }\r\n}","import { Color } from \"../../config\";\r\nimport { Vector2 } from \"../../engine/utils/math\";\r\nimport { Ore } from \"./Ore\";\r\n\r\nexport class BurntBasalt extends Ore {\r\n    constructor(position: Vector2) {\r\n        super(\"burnt-basalt\", position);\r\n\r\n        // this.needToolLevel = 4;\r\n        // this.hp = 80;\r\n        this.particlesColors = [Color.DARK_GREY];\r\n    }\r\n}","import { Color } from \"../../config\";\r\nimport { Game } from \"../../engine\";\r\nimport { noise } from \"../../engine/Generator\";\r\nimport { inRange, Vector2 } from \"../../engine/utils/math\";\r\nimport { RawCidium } from \"../raws/RawCidium\";\r\nimport { Ore } from \"./Ore\";\r\n\r\nexport class Cidium extends Ore {\r\n    constructor(position: Vector2) {\r\n        super(\"cidium\", position);\r\n\r\n        // this.hp = 20;\r\n        this.particlesColors = [Color.BLACK, Color.YELLOW];\r\n        this.allowDecorations = true;\r\n    }\r\n\r\n    static rules(x: number, y: number): boolean {\r\n        const res = noise(x / 5, y / 5, 4, 4);\r\n        const mask = noise(x, y + 4);\r\n        \r\n        return inRange(res - mask/4, .7, 1);\r\n    }\r\n\r\n    onBreak() {\r\n        super.onBreak();\r\n\r\n        this.dropItem(RawCidium);\r\n    }\r\n}","import { SpawnCrumbleParticles } from \"../../engine/components/Particles\";\r\nimport { Vector2 } from \"../../engine/utils/math\";\r\nimport { FallingOre } from \"./FallingORe\";\r\nimport { Ore } from \"./Ore\";\r\n\r\nexport class CrackedStone extends FallingOre {\r\n    constructor(position: Vector2) {\r\n        super(\"cracked-stone\", position);\r\n    }\r\n\r\n    init() {\r\n        super.init();\r\n\r\n        this.game.generator.onWorldChange(this.id, this.position, ()=> {\r\n\r\n            if (!this.checkBlockIn(new Vector2(0, 1), false)) {\r\n                this.animateScaleTo = .7;\r\n                this.fall();\r\n            }\r\n\r\n        });\r\n    }\r\n}","import { Color, Config } from \"../../config\";\r\nimport { ISpriteProps, Point } from \"../../engine\";\r\nimport { asImage, chance, clamp, lerp, randomInt, safeValue, Vector2 } from \"../../engine/utils/math\";\r\nimport { simplex2 } from \"../../engine/utils/noise\";\r\nimport { Entity } from \"../entities/Entity\";\r\nimport { Player } from \"../entities/Player\";\r\nimport { Ore, OreType } from \"./Ore\";\r\n\r\nexport class InfectedOre extends Ore {    \r\n    allowInfect: boolean\r\n    allowGrow: boolean\r\n    infectionStage: number\r\n\r\n    target: Point | Player | undefined\r\n    isEating: boolean\r\n    daturaPosition: Vector2\r\n    daturaRotation: number\r\n    tonguePosition: Vector2\r\n    tongueVelocity: Vector2\r\n    startTonguePosition: Vector2\r\n    \r\n    constructor(type: OreType, position: Vector2, data?: { infectionStage?: number }, props?: ISpriteProps) {\r\n        super(type, position, props);\r\n\r\n        this.allowInfect = false;\r\n        this.allowGrow = true;\r\n        this.infectionStage = data ? data.infectionStage || 0 : 0;\r\n\r\n        this.target = undefined;\r\n        this.isEating = false;\r\n        this.daturaPosition = Vector2.zero();\r\n        this.daturaRotation = 0;\r\n        this.tonguePosition = Vector2.zero();\r\n        this.tongueVelocity = Vector2.zero();\r\n        this.startTonguePosition = Vector2.zero();\r\n    }\r\n\r\n    init() {\r\n        super.init();\r\n\r\n        this.checkEmptySpace();\r\n\r\n        this.daturaPosition = this.position.add(new Vector2(0, Config.SPRITE_SIZE - 10));\r\n        this.tonguePosition.copy(this.daturaPosition.add(new Vector2(0, 20)));\r\n        this.startTonguePosition = this.position.add(new Vector2(0, Config.SPRITE_SIZE + 100));\r\n\r\n        this.infect();\r\n\r\n        // Height clamp\r\n        if (Math.floor(this.position.x / Config.SPRITE_SIZE) <= 10)\r\n            this.allowInfect = false;\r\n    }\r\n\r\n    update() {\r\n        super.update();\r\n\r\n        this.tonguePosition.x += this.tongueVelocity.x;\r\n        this.tonguePosition.y += this.tongueVelocity.y;\r\n        this.tongueVelocity.x *= .9;\r\n        this.tongueVelocity.y *= .9;\r\n\r\n        this.isEating = !!this.target && this.target.position.distance(this.daturaPosition) < 120;\r\n        \r\n        this.hitEntity();\r\n        this.growInfection();\r\n        this.sticking();\r\n    }\r\n\r\n    sticking() {\r\n        if (this.infectionStage < 3 || !this.allowInfect) return;\r\n\r\n        const body = (this.game.children as Entity[]).find(child=>\r\n            child.collider.type == \"dynamic\" &&\r\n            safeValue(child.interest, true) &&\r\n            (child.position.distance(this.daturaPosition) < 100 || child.position.distance(this.startTonguePosition) < 100)\r\n        )\r\n        this.target = body;\r\n        \r\n        if (!this.target) {\r\n            this.tongueTo(this.startTonguePosition.add(new Vector2(Math.sin(this.game.clock.elapsed / 40 + this.position.x / 10) * 5)))\r\n            this.tongueVelocity.copy(this.tongueVelocity.mul(.97))\r\n        }\r\n        else {\r\n            this.tongueVelocity.copy(this.tongueVelocity.mul(0));\r\n\r\n            // Tongue to target\r\n            if (this.tonguePosition.distance(this.target.position) < 20)\r\n                this.tonguePosition = this.target.position.expand();\r\n            else\r\n                this.tonguePosition.lerp(this.target.position, .4);\r\n            \r\n            // Move entity to datura\r\n            if (body)\r\n                if (body.position.distance(this.daturaPosition) > 10)\r\n                    body.velocity.copy(body.velocity.add(body.position.sub(this.daturaPosition).normalize().mul(-4)))\r\n\r\n        }\r\n\r\n    }\r\n    hitEntity() {\r\n        const tar = (this.target as any);\r\n        if (this.target) {\r\n            // If player - hit\r\n            if (tar.hit) {\r\n                if (this.game.tick(60) && this.isEating)\r\n                    tar.hit(clamp(randomInt(-1, 3), 1, 3));\r\n            } else {\r\n                // If item - eat :D\r\n                if (tar.position.distance(this.daturaPosition) < 80) {\r\n                    tar.picked =\r\n                    tar.allowPickup = false;\r\n                    tar.foldToPosition = this.daturaPosition;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    tongueTo(position: Vector2) {\r\n        const to = position.sub(this.tonguePosition).mul(.04);\r\n            \r\n        this.tongueVelocity.copy(this.tongueVelocity.add(to));\r\n    }\r\n\r\n    infect() {\r\n        if ((simplex2(this.position.x / 2, this.position.y / 2) + 1) / 2 > (this.allowGrow ? .7 : .9)) {\r\n            this.allowInfect = true;\r\n        }\r\n    }\r\n    growInfection() {\r\n        if (!this.allowInfect) return;\r\n        \r\n        if (this.game.tick(Config.INFECTION_GROW_TICK) && this.infectionStage < 3) {\r\n\r\n            this.checkEmptySpace();\r\n            if (this.allowGrow && chance(Config.INFECTION_GROW_CHANCE)) {\r\n                \r\n                const needStage = this.infectionStage + 1;\r\n                this.infectionStage = needStage;\r\n                this.saveData();\r\n\r\n            }\r\n        }\r\n\r\n    }\r\n    onBreak() {\r\n        if (this.infectionStage >= 2 && this.allowInfect)\r\n            this.particlesColors = [Color.ORANGE, Color.BLACK];\r\n            \r\n        super.onBreak();\r\n    }\r\n\r\n    render() {\r\n        super.render();\r\n        \r\n        if (!this.allowInfect) return;\r\n        \r\n        this.daturaRotation = lerp(\r\n            this.daturaRotation,\r\n            clamp(new Vector2().copy(this.position.sub(this.tonguePosition.add(new Vector2(-4)))).angle() - Math.PI * 1.5, -Math.PI / 5, Math.PI / 5),\r\n            .1\r\n        );\r\n        \r\n        // Render infection\r\n        // Infection roots\r\n        if (this.infectionStage >= 1 && this.visible)\r\n            this.game.renderer.drawSprite({\r\n                texture: asImage(this.game.getAssetByName(\"infection\")),\r\n                position: this.position,\r\n                flip: this.flip,\r\n                scale: this.scale,\r\n                opacity: this.opacity,\r\n                layer: \"plants\"\r\n            });\r\n\r\n        const frame = (this.target ? 1 + (this.isEating ? (Math.floor(this.game.clock.elapsed / 20) % 2) : 0) : 0);\r\n            \r\n        // Datura\r\n        if (this.infectionStage >= 2 && this.visible)\r\n            this.game.renderer.drawSprite({\r\n                texture: asImage(this.game.getAssetByName(\"datura\")),\r\n                frame: new Vector2(this.infectionStage - 2 + frame, 0),\r\n                width: 2,\r\n                height: 2,\r\n                position: this.daturaPosition.add(new Vector2(0, 30)),\r\n                opacity: this.opacity,\r\n                layer: \"plants\",\r\n                origin: new Vector2(4, -40),\r\n                // Rotate\r\n                rotation: this.daturaRotation\r\n            });\r\n\r\n        this.renderTongue();\r\n    }\r\n    renderTongue() {\r\n        if (this.infectionStage < 3) return;\r\n\r\n        const sin = this.isEating ? (Math.sin(this.game.clock.elapsed / 4) + 1) / 2 : 0;\r\n        \r\n        if (this.visible)\r\n            // Tongue line\r\n            this.game.renderer.drawLine({\r\n                color: \"#fbc67e\",\r\n                width: 4 + sin * 4,\r\n                points: [this.position.add(new Vector2(4, Config.SPRITE_SIZE - 22)), this.tonguePosition.add(new Vector2(4))],\r\n                opacity: this.opacity,\r\n                layer: \"plants\",\r\n            });\r\n        // Tongue point\r\n        this.game.renderer.drawSprite({\r\n            texture: asImage(this.game.getAssetByName(\"datura-tongue\")),\r\n            scale: Vector2.all(1 + sin / 4),\r\n            position: this.tonguePosition.add(new Vector2(6)),\r\n            layer: \"plants\",\r\n        })\r\n    }\r\n\r\n    checkEmptySpace() {\r\n        if (this.checkBlockIn(new Vector2(0, 1)))\r\n            this.allowGrow = false;\r\n    }\r\n    saveData() {\r\n        this.game.generator.modifyOre(this.inChunkId, { infectionStage: this.infectionStage });\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { InfectedOre } from \"./InfectedOre\";\r\n\r\nexport class DeepStone extends InfectedOre {\r\n    constructor(position: Vector2, data: any) {\r\n        super(\"deep-stone\", position, data);\r\n        this.randomRotate = false;\r\n        this.allowDecorations = true;\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { Ore } from \"./Ore\"\r\n\r\nexport class Destrony extends Ore {\r\n    constructor(position: Vector2) {\r\n        super(\"destrony\", position);\r\n        this.unbreakable = true;\r\n        this.randomRotate = false;\r\n    }\r\n}","import { Color, Config } from \"../../config\";\r\nimport { SpawnParticles } from \"../../engine/components/Particles\";\r\nimport { noise } from \"../../engine/Generator\";\r\nimport { asImage, chance, clamp, inRange, random, randomInt, Vector2 } from \"../../engine/utils/math\";\r\nimport { caveRules } from \"../../managers/generator\";\r\nimport { Player } from \"../entities/Player\";\r\nimport { HealingFetus } from \"../food/HealingFetus\";\r\nimport { Ore } from \"./Ore\";\r\n\r\nexport class FetusStone extends Ore {\r\n    player!: Player\r\n    \r\n    vineLength: number | null\r\n    maxVineLength: number\r\n    allowGrow: boolean\r\n    playerIsNear: boolean\r\n    grabbedCount: number | null\r\n    canGrab: boolean\r\n    cutOff: boolean\r\n    \r\n    constructor(position: Vector2, data?: any) {\r\n        super(\"fetus-stone\", position);\r\n    \r\n        this.randomRotate = false;\r\n\r\n        this.playerIsNear = false;\r\n        this.vineLength = data ? (data?.length || null) : null;\r\n        this.maxVineLength = data ? (data?.maxLength || 1) : 1;\r\n        this.allowGrow = true;\r\n        this.grabbedCount = data ? (data?.grabbedCount || null) : null;\r\n        this.canGrab = false;\r\n        // this.cutOff = false;\r\n        this.cutOff = data ? (data?.cutOff || false) : false;\r\n\r\n        this.breakAudioNames = [\"plant-break\"];\r\n        this.hitAudioName = \"plant-hit\";\r\n    }\r\n\r\n    static rules(x: number, y: number): boolean {\r\n        const res = noise(x / 8, y / 8);\r\n        const haveEmptySpace = caveRules(x, y, 0, 1);\r\n        \r\n        return inRange(res, 0, .8) && haveEmptySpace;\r\n    }\r\n\r\n    init() {\r\n        super.init();\r\n\r\n        this.player = this.game.getChildById(\"player\")!;\r\n\r\n        if (this.vineLength === null) {\r\n            this.maxVineLength = randomInt(Config.VINE_MIN_LENGTH, Config.VINE_MAX_LENGTH);\r\n            this.vineLength = clamp(randomInt(1, 4), 0, this.maxVineLength);\r\n            this.saveData();\r\n        }\r\n        if (this.grabbedCount == null) {\r\n            this.grabbedCount = clamp(randomInt(-2, 4), 0, 4);\r\n            this.saveData()\r\n        }\r\n\r\n        if (!this.cutOff)\r\n            for (let i = 0; i < this.vineLength; i ++) {\r\n                if (!caveRules(this.tilePosition.x, this.tilePosition.y, 0, i+1)) {\r\n                    this.vineLength = i;\r\n                    this.cutOff = true;\r\n                    this.saveData();\r\n                    break;\r\n                }\r\n            }\r\n        \r\n        // this.checkEmptySpace();\r\n        if (!this.allowGrow)\r\n            this.vineLength = 0;\r\n\r\n        // Trigger\r\n        this.game.gamepad.onKeyDown(this.id, \"enter\", ()=> {\r\n            if (!this.canGrab || (this.grabbedCount || 0) >= (this.vineLength || 0)) return;\r\n            \r\n            this.grab();\r\n        })\r\n    }\r\n    update() {\r\n        super.update();\r\n\r\n        this.tryGrab();\r\n\r\n        if (!this.allowGrow) return;\r\n        \r\n        // if ((this.vineLength || 0) < this.maxVineLength && this.allowGrow && this.game.tick(Config.VINE_GROW_TICK))\r\n        //     if (chance(Config.VINE_GROW_CHANCE))\r\n        //         this.grow();\r\n        if (this.game.tick(Config.VINE_GROW_TICK * 2))\r\n            if (chance(Config.VINE_GROW_CHANCE * .3) && this.grabbedCount != null) {\r\n                this.grabbedCount --;\r\n                this.grabbedCount = clamp(this.grabbedCount, 0, this.vineLength || 0)\r\n            }\r\n\r\n        // if (!this.cutOff && this.game.tick(100))\r\n        //     this.checkEmptySpaceToGrow();\r\n    }\r\n\r\n    render() {\r\n        super.render();\r\n        \r\n        this.renderVine();\r\n    }\r\n\r\n    tryGrab() {\r\n\r\n        const vineHeight = (this.vineLength || 0) * Config.SPRITE_SIZE;\r\n        const collides = (this.vineLength || 0) > 0 && (this.grabbedCount || 0) < (this.vineLength || 0) && this.game.physics.collideWithRect({\r\n            id: this.player.id,\r\n            position: this.player.position,\r\n            width: this.player.collider.width,\r\n            height: this.player.collider.height,\r\n        }, {\r\n            id: this.id,\r\n            position: this.position.add(new Vector2(0, vineHeight / 2)),\r\n            width: this.collider.width / 2,\r\n            height: this.collider.height + vineHeight,\r\n        }).any;\r\n        \r\n        this.canGrab = collides;\r\n        if (collides) {\r\n            this.player.expectedActionType = { name: \"grab\", priority: 2 };\r\n        }\r\n        \r\n    }\r\n    grab() {\r\n        if (this.grabbedCount == null || this.grabbedCount >= (this.vineLength || 0)) return;\r\n        \r\n        this.grabbedCount ++;\r\n        this.grabbedCount = clamp(this.grabbedCount, 0, this.vineLength || 0)\r\n\r\n        this.dropItem(HealingFetus, 100, new Vector2(0, Config.SPRITE_SIZE * this.grabbedCount));\r\n    }\r\n\r\n    onBreak() {\r\n        super.onBreak();\r\n        if (!this.vineLength) return;\r\n        const size = Config.SPRITE_SIZE;\r\n\r\n        SpawnParticles(this.game, this.position, {\r\n            count: 4,\r\n            colors: [Color.ORANGE],\r\n            velocity: ()=> new Vector2(random(1, 1.5)),\r\n            gravity: .01,\r\n            opacity: 0,\r\n            downOpacity: -.01,\r\n            downSize: .008,\r\n            rotationVelocity: ()=> random(-.01, .01),\r\n            box: ()=> new Vector2(random(-size*.4, size*.4), random(0, size * (this.vineLength || 1)))\r\n        });\r\n    }\r\n\r\n    renderVine() {\r\n        if (!this.vineLength || !this.allowGrow) return;\r\n        const size = Config.SPRITE_SIZE;\r\n        \r\n        for (let i = 0; i < this.vineLength; i ++) {\r\n            let frame = 0\r\n\r\n            if (i == 0)\r\n                frame = 0;\r\n            if (i > 0)\r\n                frame = 1;\r\n            if (i == this.vineLength - 1)\r\n                frame = 2;\r\n            \r\n            const pos = this.position.add(new Vector2(0, size + i * size));\r\n                \r\n            const t = 1 - this.game.camera.position.y / 200;\r\n            const d = (this.game.camera.position.distance(pos) - 200);\r\n            const darkenFactor = (d > 96 ? 1 : d / 96) + (t > 0 ? t : 0);\r\n            \r\n            if (darkenFactor < 1 || !Config.ALLOW_DARK)\r\n                this.game.renderer.drawSprite({\r\n                    texture: asImage(this.game.getAssetByName(`fetus-vine`)),\r\n                    position: pos.add(new Vector2(Math.sin(this.game.clock.elapsed / 40 + this.position.x / Config.SPRITE_SIZE) * i * 1.5)),\r\n                    frame: new Vector2(\r\n                        +(i < (this.grabbedCount || 0)),\r\n                        frame\r\n                    ),\r\n                    flip: { x: i % 2 == 0 || i % 3 == 0, y: false },\r\n                    opacity: Config.ALLOW_DARK ? 1 - darkenFactor : 1\r\n                });\r\n        }\r\n        \r\n        // Spawn particles\r\n        if (this.game.tick(40) || this.game.tick(120))\r\n            SpawnParticles(this.game, this.position, {\r\n                count: 1,\r\n                colors: [Color.ORANGE],\r\n                velocity: ()=> new Vector2(random(.2, .5)),\r\n                gravity: .01,\r\n                opacity: 0,\r\n                downOpacity: -.01,\r\n                downSize: .008,\r\n                rotationVelocity: ()=> random(-.01, .01),\r\n                box: ()=> new Vector2(random(-size*.4, size*.4), random(0, size * (this.vineLength || 1)))\r\n            });\r\n        \r\n    }\r\n    grow() {\r\n        if (this.vineLength === null || !this.allowGrow || this.vineLength >= this.maxVineLength) return;\r\n\r\n        let needLength = this.vineLength;\r\n        \r\n        if (needLength < this.maxVineLength)\r\n            needLength ++;\r\n\r\n        this.vineLength = needLength;\r\n        this.checkEmptySpaceToGrow();\r\n\r\n        this.saveData();\r\n    }\r\n    checkEmptySpaceToGrow() {\r\n        if (this.vineLength === null || !this.allowGrow) return;\r\n\r\n        let height = 0;\r\n\r\n        for (let i = 1; i < 8; i ++) {\r\n            if (this.checkBlockIn(new Vector2(0, i), false)) {\r\n                this.cutOff = true;\r\n                break;\r\n            } else\r\n                height ++;\r\n        }\r\n\r\n        this.vineLength = clamp(this.vineLength, 0, height);\r\n\r\n        this.saveData();\r\n    }\r\n\r\n    saveData() {\r\n        this.game.generator.modifyOre(this.inChunkId, {\r\n            length: this.vineLength,\r\n            grabbedCount: this.grabbedCount,\r\n            maxLength: this.maxVineLength,\r\n            cutOff: this.cutOff\r\n        });\r\n    }\r\n    checkEmptySpace() {\r\n        this.allowGrow = !this.checkBlockIn(new Vector2(0, 1), false);\r\n    }\r\n}","import { Game } from \"../../engine\";\r\nimport { Vector2 } from \"../../engine/utils/math\";\r\nimport { Player, ToolLevel } from \"../entities/Player\";\r\nimport { Ore, OreType } from \"./Ore\";\r\n\r\nexport class DangerOre extends Ore {\r\n    constructor(type: OreType, position: Vector2) {\r\n        super(type, position);\r\n    }\r\n\r\n    hit(damage: number, level: ToolLevel) {\r\n        super.hit(damage, level);\r\n\r\n        const player = this.game.getChildById<Player>(\"player\");\r\n        if (!player) return;\r\n\r\n        if (!player.hasBottle)\r\n            player.hit(1);\r\n    }\r\n}","import { noise } from \"../../engine/Generator\";\r\nimport { inRange, Vector2 } from \"../../engine/utils/math\";\r\nimport { RawManty } from \"../raws/RawManty\";\r\nimport { DangerOre } from \"./DangerOre\";\r\n\r\nexport class Manty extends DangerOre {\r\n    constructor(position: Vector2) {\r\n        super(\"manty\", position);\r\n\r\n        this.randomRotate = false;\r\n    }\r\n\r\n    static rules(x: number, y: number): boolean {\r\n        const res = noise(x / 2, y / 2, 2);\r\n        \r\n        return inRange(res, 0, .5);\r\n    }\r\n\r\n    onBreak() {\r\n        super.onBreak();\r\n\r\n        this.dropItem(RawManty);\r\n    }\r\n}","import { Color, Config } from \"../../config\";\r\nimport { SpawnDisputesParticles, SpawnParticles } from \"../../engine/components/Particles\";\r\nimport { noise } from \"../../engine/Generator\";\r\nimport { asImage, clamp, inRange, random, randomInt, Vector2 } from \"../../engine/utils/math\";\r\nimport { caveRules } from \"../../managers/generator\";\r\nimport { Player, ToolLevel } from \"../entities/Player\";\r\nimport { Ore } from \"./Ore\";\r\n\r\nexport class MushroomStone extends Ore {\r\n    allowGrow: boolean\r\n    growed: boolean\r\n    currentFrame: number\r\n    \r\n    constructor(position: Vector2) {\r\n        super(\"mushroom-stone\", position);\r\n\r\n        this.allowGrow = true;\r\n        this.growed = true;\r\n        this.randomRotate = false;\r\n        this.particlesColors = [Color.GREY, Color.RED];\r\n        this.currentFrame = randomInt(0, 4);\r\n    }\r\n\r\n    static rules(x: number, y: number): boolean {\r\n        const res = noise(x / 8, y / 8);\r\n        const haveEmptySpace = caveRules(x, y, 0, -1);\r\n        \r\n        return inRange(res, 0, .5) && haveEmptySpace;\r\n    }\r\n\r\n    init() {\r\n        super.init();\r\n\r\n        if (this.checkBlockIn(new Vector2(0, -1)))\r\n            this.allowGrow = false;\r\n    }\r\n\r\n    render() {\r\n        super.render();\r\n\r\n        if (this.allowGrow)\r\n            this.renderMushroom();\r\n    }\r\n    hit(damage: number, toolLevel: ToolLevel) {\r\n        super.hit(damage, toolLevel);\r\n\r\n        SpawnDisputesParticles(this.game, this.position.add(new Vector2(0, -Config.SPRITE_SIZE / 2-10)), .4);\r\n    }\r\n    onBreak() {\r\n        super.onBreak();\r\n        \r\n        SpawnDisputesParticles(this.game, this.position, 1);\r\n\r\n        const player = this.game.getChildById<Player>(\"player\");\r\n        if (player && this.position.distance(player.position) < 200 && player.position.y < this.position.y + Config.SPRITE_SIZE/2)\r\n            player.hit(randomInt(4, 6));\r\n    }\r\n\r\n    renderMushroom() {\r\n        if (!this.growed || !this.visible) return;\r\n\r\n        const offset = ((Math.sin(this.game.clock.elapsed / 60 + this.position.x) + 1) / 2) * .1;\r\n\r\n        this.game.renderer.drawSprite({\r\n            texture: asImage(this.game.getAssetByName(\"mushroom\")),\r\n            frame: new Vector2(this.currentFrame),\r\n            scale: new Vector2(1, 1 - offset),\r\n            position: this.position.add(new Vector2(0, -Config.SPRITE_SIZE + (offset * Config.SPRITE_SIZE) / 2)),\r\n            opacity: this.opacity\r\n        })\r\n    }\r\n}","import { Color } from \"../../config\";\r\nimport { Game } from \"../../engine\";\r\nimport { noise } from \"../../engine/Generator\";\r\nimport { inRange, Vector2 } from \"../../engine/utils/math\";\r\nimport { RawGradeCidium } from \"../raws/RawGradeCidium\";\r\nimport { RawNerius } from \"../raws/RawNerius\";\r\nimport { RawOsmy } from \"../raws/RawOsmy\";\r\nimport { Ore } from \"./Ore\";\r\n\r\nexport class Nerius extends Ore {\r\n    constructor(position: Vector2) {\r\n        super(\"nerius\", position);\r\n\r\n        this.randomRotate = false;\r\n        this.particlesColors = [Color.BLACK, \"#fff\"];\r\n    }\r\n\r\n    static rules(x: number, y: number): boolean {\r\n        const res = noise(x / 6, y / 6, 5, 4);\r\n        const mask = noise(x + 5, y + 3);\r\n        \r\n        return inRange(res - mask/4, .7, 1);\r\n    }\r\n\r\n    onBreak() {\r\n        super.onBreak();\r\n\r\n        this.dropItem(RawNerius);\r\n    }\r\n}","import { Color } from \"../../config\";\r\nimport { noise } from \"../../engine/Generator\";\r\nimport { inRange, Vector2 } from \"../../engine/utils/math\";\r\nimport { RawGradeCidium } from \"../raws/RawGradeCidium\";\r\nimport { RawOsmy } from \"../raws/RawOsmy\";\r\nimport { Ore } from \"./Ore\";\r\n\r\nexport class Osmy extends Ore {\r\n    constructor(position: Vector2) {\r\n        super(\"osmy\", position);\r\n\r\n        this.randomRotate = false;\r\n        this.particlesColors = [Color.BLACK, Color.BLUE];\r\n        this.allowDecorations = true;\r\n    }\r\n\r\n    static rules(x: number, y: number): boolean {\r\n        const res = noise(x / 3, y / 3, 5, 4);\r\n        const mask = noise(x / 2, y / 5 + 4);\r\n\r\n        return inRange(res - mask/3, .65, 1);\r\n    }\r\n\r\n    onBreak() {\r\n        super.onBreak();\r\n\r\n        this.dropItem(RawOsmy);\r\n        this.dropItem(RawGradeCidium, 35);\r\n    }\r\n}","import { Color } from \"../../config\";\r\nimport { noise } from \"../../engine/Generator\";\r\nimport { inRange, Vector2 } from \"../../engine/utils/math\";\r\nimport { RawRady } from \"../raws/RawRady\";\r\nimport { DangerOre } from \"./DangerOre\";\r\n\r\nexport class Rady extends DangerOre {\r\n    constructor(position: Vector2) {\r\n        super(\"rady\", position);\r\n\r\n        this.particlesColors = [Color.GREY, Color.GREEN];\r\n    }\r\n\r\n    static rules(x: number, y: number): boolean {\r\n        const res = noise(x / 2, y / 2, 5, 3);\r\n        const mask = noise(x / 6 - 5, y / 6 + 10);\r\n\r\n        return inRange(res - mask/4, .85, 1);\r\n    }\r\n\r\n    onBreak() {\r\n        super.onBreak();\r\n\r\n        this.dropItem(RawRady);\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { InfectedOre } from \"./InfectedOre\";\r\n\r\nexport class Stone extends InfectedOre {\r\n    constructor(position: Vector2, data: any) {\r\n        super(\"stone\", position, data);\r\n        \r\n        this.allowDecorations = true;\r\n    }\r\n}","import { Vector2 } from \"../../engine/utils/math\";\r\nimport { Ore } from \"./Ore\";\r\n\r\nexport class StonyGround extends Ore {\r\n    constructor(position: Vector2) {\r\n        super(\"stony-ground\", position);\r\n        \r\n        this.allowDecorations = true;\r\n    }\r\n}","import { GeneratorConfig, Config } from \"../config\";\r\nimport { Game } from \"../engine\";\r\nimport { noise } from \"../engine/Generator\";\r\nimport { inRange } from \"../engine/utils/math\";\r\nimport { Antin } from \"../objects/ores/Antin\";\r\nimport { Basalt } from \"../objects/ores/Basalt\";\r\nimport { BurntBasalt } from \"../objects/ores/BurntBasalt\";\r\nimport { Cidium } from \"../objects/ores/Cidium\";\r\nimport { CrackedStone } from \"../objects/ores/CrackedStone\";\r\nimport { DeepStone } from \"../objects/ores/DeepStone\";\r\nimport { Destrony } from \"../objects/ores/Destrony\";\r\nimport { FetusStone } from \"../objects/ores/FetusStone\";\r\nimport { Manty } from \"../objects/ores/Manty\";\r\nimport { MushroomStone } from \"../objects/ores/MushroomStone\";\r\nimport { Nerius } from \"../objects/ores/Nerius\";\r\nimport { Osmy } from \"../objects/ores/Osmy\";\r\nimport { Rady } from \"../objects/ores/Rady\";\r\nimport { Stone } from \"../objects/ores/Stone\";\r\nimport { StonyGround } from \"../objects/ores/StonyGround\";\r\n\r\nexport function caveRules(x: number, y: number, offsetX?: number, offsetY?: number): boolean {\r\n    const ox = offsetX || 0;\r\n    const oy = offsetY || 0;\r\n    \r\n    const res = noise((x + ox) / 30, (y + oy) / 12, 4, 3);\r\n    const mask = noise((x + ox) / 16, (y + oy) / 16);\r\n\r\n    return inRange(res + mask/5, 0, .6);\r\n}\r\n\r\nexport function initGenerator(game: Game) {\r\n\r\n    game.generator.settings = [\r\n        // > Stones\r\n        {\r\n            value: [0, 1],\r\n            height: [0, 43],\r\n            block: Stone,\r\n        },\r\n        {\r\n            value: [.5, .6],\r\n            height: [5, 90],\r\n            divider: 5,\r\n            block: CrackedStone\r\n        },\r\n        {\r\n            value: [.5, .6],\r\n            height: [0, 14],\r\n            divider: 5,\r\n            block: StonyGround\r\n        },\r\n\r\n        // > Deepest stones\r\n        // Deep stone blend layer\r\n        {\r\n            value: [.8, 1],\r\n            height: [30, 43],\r\n            divider: 2,\r\n            block: DeepStone\r\n        },\r\n        // Deep stone layer\r\n        {\r\n            value: [0, 1],\r\n            height: [42, GeneratorConfig.BASALT_LAYER_HEIGHT],\r\n            block: DeepStone\r\n        },\r\n\r\n        // Basalt blend layer\r\n        {\r\n            value: [.7, 1],\r\n            height: [GeneratorConfig.BASALT_LAYER_HEIGHT - GeneratorConfig.LAYERS_BLEND_HEIGHT, GeneratorConfig.BASALT_LAYER_HEIGHT],\r\n            divider: 3,\r\n            block: Basalt\r\n        },\r\n        // Basalt layer\r\n        {\r\n            value: [0, 1],\r\n            height: [GeneratorConfig.BASALT_LAYER_HEIGHT, GeneratorConfig.BURNT_BASALT_LAYER_HEIGHT],\r\n            block: Basalt\r\n        },\r\n\r\n        // Burnt basalt blend layer\r\n        {\r\n            value: [.8, 1],\r\n            height: [GeneratorConfig.BURNT_BASALT_LAYER_HEIGHT - GeneratorConfig.LAYERS_BLEND_HEIGHT, GeneratorConfig.BURNT_BASALT_LAYER_HEIGHT],\r\n            divider: 3,\r\n            block: BurntBasalt\r\n        },\r\n        // Burnt basalt layer\r\n        {\r\n            value: [0, 1],\r\n            height: [GeneratorConfig.BURNT_BASALT_LAYER_HEIGHT, Config.WORLD_HEIGHT],\r\n            block: BurntBasalt\r\n        },\r\n        // > Destrony layer\r\n        {\r\n            value: [0, 1],\r\n            height: [Config.WORLD_HEIGHT, Config.WORLD_HEIGHT],\r\n            block: Destrony\r\n        },\r\n\r\n        // > Other\r\n        // // Fetus stone\r\n        {\r\n            height: [30, GeneratorConfig.BASALT_LAYER_HEIGHT-20],\r\n            block: FetusStone,\r\n            rules: FetusStone.rules\r\n            // rules(noiseX, noiseY, getValue) {\r\n            //     return (\r\n            //         inRange(getValue(noiseX, noiseY+1, 10), 0, .5) &&\r\n            //         inRange(getValue(noiseX, noiseY, 8), 0, .8) \r\n            //         // inRange(getValue(noiseX, noiseY, 2), 0, .3)\r\n            //     );\r\n            // }\r\n        },\r\n        // Mushroom stone\r\n        {\r\n            height: [GeneratorConfig.BASALT_LAYER_HEIGHT, GeneratorConfig.BURNT_BASALT_LAYER_HEIGHT-15],\r\n            block: MushroomStone,\r\n            rules: MushroomStone.rules\r\n        },\r\n        \r\n        // > Ores\r\n        // Cidium\r\n        {\r\n            height: [12, GeneratorConfig.BASALT_LAYER_HEIGHT/2],\r\n            block: Cidium,\r\n            rules: Cidium.rules\r\n        },\r\n\r\n        // Osmy - deep stone layer\r\n        {\r\n            height: [50, GeneratorConfig.BASALT_LAYER_HEIGHT - GeneratorConfig.LAYERS_BLEND_HEIGHT],\r\n            block: Osmy,\r\n            rules: Osmy.rules\r\n        },\r\n        {\r\n            height: [100, GeneratorConfig.BASALT_LAYER_HEIGHT - GeneratorConfig.LAYERS_BLEND_HEIGHT],\r\n            block: Nerius,\r\n            rules: Nerius.rules\r\n        },\r\n        \r\n        // Antin - basalt layer\r\n        {\r\n            height: [GeneratorConfig.BASALT_LAYER_HEIGHT + 10, Config.WORLD_HEIGHT - 22],\r\n            block: Antin,\r\n            rules: Antin.rules\r\n        },\r\n        // Rady - basalt layer\r\n        {\r\n            height: [200, Config.WORLD_HEIGHT - 5],\r\n            block: Rady,\r\n            rules: Rady.rules\r\n        },\r\n        // > Manty layer\r\n        {\r\n            height: [Config.WORLD_HEIGHT - 5, Config.WORLD_HEIGHT - 1],\r\n            block: Manty,\r\n            rules: Manty.rules\r\n        },\r\n        {\r\n            value: [0, .5],\r\n            height: [Config.WORLD_HEIGHT - 1, Config.WORLD_HEIGHT - 1],\r\n            divider: 2,\r\n            block: Manty\r\n        },\r\n\r\n        // > Caves\r\n        {\r\n            height: [5, GeneratorConfig.BURNT_BASALT_LAYER_HEIGHT],\r\n            block: null,\r\n            rules: caveRules\r\n        },\r\n    ];\r\n    \r\n}","import { Config } from \"../config\";\r\nimport { Game } from \"../engine\";\r\nimport { UI } from \"../engine/components/UI\";\r\nimport { Renderer } from \"../engine/Renderer\";\r\nimport { asImage, Vector2 } from \"../engine/utils/math\";\r\nimport { Player } from \"../objects/entities/Player\";\r\n\r\ntype IButton = {\r\n    text: string\r\n}\r\n\r\nexport function initMenu(game: Game, player: Player) {\r\n\r\n    const menuUI = new UI();\r\n    const buttons: IButton[] = [\r\n        { text: \"Иследовать\" },\r\n        { text: \"Заново\" },\r\n        { text: \"Об игре\" }\r\n    ];\r\n    menuUI.updateTemplate(buttons.map(()=> 1));\r\n    \r\n    function init() {\r\n        menuUI.init(game);\r\n        \r\n        // UI actions\r\n        game.gamepad.onKeyDown(\"menu-ui\", \"enter\", ()=> {\r\n\r\n            if (menuUI.focused.row == 0)\r\n                game.paused = false;\r\n            else if (menuUI.focused.row == 1) {\r\n                game.clearAllKeys();\r\n                location.reload();\r\n            }\r\n\r\n        });\r\n    }\r\n    function update() {\r\n        menuUI.enabled = game.paused && !player.dead;\r\n    }\r\n    function render(renderer: Renderer) {\r\n        if (menuUI.enabled) {\r\n            const size = Config.SPRITE_SIZE;\r\n            const windowCenter = new Vector2(innerWidth / 2, innerHeight / 2);\r\n        \r\n            renderer.drawRect({\r\n                position: windowCenter,\r\n                width: innerWidth / size,\r\n                height: innerHeight / size,\r\n                color: \"rgba(0, 0, 0, .5)\",\r\n                layer: \"ui\"\r\n            })\r\n            renderer.drawSprite({\r\n                texture: asImage(game.getAssetByName(\"logo\")),\r\n                width: 6,\r\n                height: 2,\r\n                position: new Vector2(windowCenter.x, 160),\r\n                layer: \"ui\"\r\n            })\r\n            \r\n            // About text\r\n            if (menuUI.isFocused(buttons.length - 1, 0)) {\r\n                renderer.drawText({\r\n                    text: [\r\n                        `> Идея: Bogdanov`,\r\n                        `> Худоник: Bogdanov`,\r\n                        `> Программист: Bogdanov`,\r\n                        `> Саунд-дизайнер: Bogdanov`,\r\n                        `> Оператор: Bogdanov`,\r\n                        `> Бариста: Bogdanov`,\r\n                        `> Псих-поддержка: Bogdanov`,\r\n                    ].join(\"\\n\"),\r\n                    font: \"22px Pixel\",\r\n                    position: new Vector2(innerWidth - innerWidth / 4 + 140, innerHeight / 2 - 50),\r\n                    layer: \"ui\",\r\n                    align: \"right\"\r\n                });\r\n                renderer.drawText({\r\n                    text: `\r\n                        Deep strange planet - игра в жанре\\n\r\n                        приключения, где вы выступайте в роли\\n\r\n                        добровольца, который хочет исследовать новую\\n\r\n                        и опасную для человечества планету ради науки.\\n\r\n                        Предположительно, на ней есть жизнь в виде\\n\r\n                        бактерий. Исследуй планету, пробираясь всё\\n\r\n                        ниже, вплоть до самого ядра, собирая ценные\\n\r\n                        для науки ресурсы, но будьте внимательней,\\n\r\n                        следите за своим запасом кислорода,\\n\r\n                        уворачивайтесь от обвалов и сталакитов.\\n\r\n                        Кто знает, что там ещё может быть`,\r\n                    font: \"18px Pixel\",\r\n                    lineHeight: 10,\r\n                    position: new Vector2(innerWidth / 4 - 480, innerHeight / 2 - 50),\r\n                    layer: \"ui\",\r\n                    align: \"left\"\r\n                });\r\n            }\r\n            \r\n            // Play button\r\n            const buttonsPos = new Vector2().add(windowCenter);\r\n\r\n            for (let i = 0; i < buttons.length; i++) {\r\n                const pos = new Vector2(0, i * size).add(buttonsPos);\r\n                menuUI.renderFocusable(pos, i, 0, ()=> {\r\n        \r\n                    renderer.drawText({\r\n                        text: buttons[i].text,\r\n                        font: `${ i == 0 ? 26 : 22 }px Pixel`,\r\n                        position: pos,\r\n                        layer: \"ui\"\r\n                    })\r\n                    \r\n                }, 2.5, .8);\r\n            }\r\n            \r\n        }\r\n    }\r\n    \r\n    return { init, update, render };\r\n\r\n}","import { initAssets } from \"./managers/assets\";\r\nimport { Game, Text } from \"./engine\";\r\nimport { Player } from \"./objects/entities/Player\";\r\nimport { initLevel } from \"./managers/level\";\r\nimport { Color, Config } from \"./config\";\r\nimport { initDome } from \"./managers/dome\";\r\nimport { asImage, Vector2 } from \"./engine/utils/math\";\r\nimport { initGenerator } from \"./managers/generator\";\r\nimport { Renderer } from \"./engine/Renderer\";\r\nimport { UI } from \"./engine/components/UI\";\r\nimport { initMenu } from \"./stages/menu\";\r\n\r\nconst game = new Game();\r\n\r\nconst player = game.add<Player>(new Player());\r\nconst level = initLevel(game);\r\nconst menu = initMenu(game, player);\r\n\r\ngame.addInit(()=> {\r\n    \r\n    initAssets(game);\r\n    initDome(game);\r\n    initGenerator(game);\r\n    menu.init();\r\n    \r\n    game.camera.follow(player.position);\r\n});\r\ngame.addUpdate(()=> {\r\n    if (!game.paused)\r\n        game.camera.follow(player.position, .1);\r\n    else\r\n        game.camera.follow(new Vector2(-300, -50).add(player.position), 1);\r\n    game.generator.generateChunksAt(game.camera.position);\r\n\r\n    menu.update();\r\n});\r\ngame.addRender(renderer=> {\r\n\r\n    level.render();\r\n    menu.render(renderer);\r\n    \r\n    renderer.drawText({\r\n        text: `${ game.clock.fps } fps`,\r\n        font: \"18px Pixel\",\r\n        position: new Vector2(15, 30),\r\n        align: \"left\",\r\n        layer: \"ui\"\r\n    });\r\n    if (Config.IS_DEV)\r\n        renderDebug(renderer);\r\n\r\n});\r\n\r\nfunction renderDebug(renderer: Renderer) {\r\n    renderer.drawText({\r\n        text: `Height: ${ Math.floor(player.position.y / Config.SPRITE_SIZE + 1) }`,\r\n        font: \"20px Pixel\",\r\n        position: new Vector2(30, 80),\r\n        align: \"left\",\r\n        layer: \"ui\"\r\n    });\r\n    renderer.drawText({\r\n        text: `Pos: ${ Math.floor(player.position.x / Config.SPRITE_SIZE) }, ${ Math.floor(player.position.y / Config.SPRITE_SIZE + 1) }`,\r\n        font: \"20px Pixel\",\r\n        position: new Vector2(30, 120),\r\n        align: \"left\",\r\n        layer: \"ui\"\r\n    });\r\n    \r\n    renderChunks(renderer);\r\n}\r\nfunction renderChunks(renderer: Renderer) {\r\n    for (let y = 0; y < Config.WORLD_HEIGHT / Config.CHUNK_SIZE; y ++)\r\n        for (let x = 0; x < Config.WORLD_WIDTH / Config.CHUNK_SIZE; x ++)\r\n            renderer.drawRect({\r\n                position: new Vector2(x*Config.CHUNK_SIZE*Config.SPRITE_SIZE, y*Config.CHUNK_SIZE*Config.SPRITE_SIZE).add(Vector2.all(Config.SPRITE_SIZE*1.5)),\r\n                width: Config.CHUNK_SIZE,\r\n                height: Config.CHUNK_SIZE,\r\n                color: \"rgba(0, 0, 0, 0)\",\r\n                stroke: { width: 2, color: Color.RED }\r\n            });\r\n}\r\n\r\ngame.init();\r\n\r\n// ! Debug\r\nif (Config.IS_DEV)\r\n    window.addEventListener(\"keydown\", e=> {\r\n        \r\n        if (e.code == \"KeyG\")\r\n            console.log(game);\r\n        if (e.code == \"KeyP\")\r\n            console.log(player);\r\n        if (e.code == \"KeyI\")\r\n            console.log(player.inventory);\r\n\r\n    });\r\n"]}